Ûr
FD:\BootcampProject\src\04.Application\Validators\CategoryValidators.cs
	namespace 	
MyApp
 
. 
Application 
. 

Validators &
{ 
public		 

class		 &
CreateCategoryDtoValidator		 +
:		, -
AbstractValidator		. ?
<		? @$
CreateCategoryRequestDto		@ X
>		X Y
{

 
public &
CreateCategoryDtoValidator )
() *
)* +
{ 	
RuleFor 
( 
x 
=> 
x 
. 
Name 
)  
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( C
)C D
. 
Length 
( 
$num 
, 
$num 
) 
. 
WithMessage *
(* +
$str+ ^
)^ _
;_ `
RuleFor 
( 
x 
=> 
x 
. 
Description &
)& '
. 
MaximumLength 
( 
$num #
)# $
.$ %
WithMessage% 0
(0 1
$str1 \
)\ ]
;] ^
RuleFor 
( 
x 
=> 
x 
. 
ImageUrl #
)# $
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( D
)D E
;E F
} 	
} 
public   

class   &
UpdateCategoryDtoValidator   +
:  , -
AbstractValidator  . ?
<  ? @$
UpdateCategoryRequestDto  @ X
>  X Y
{!! 
public%% &
UpdateCategoryDtoValidator%% )
(%%) *
)%%* +
{&& 	
RuleFor'' 
('' 
x'' 
=>'' 
x'' 
.'' 
Name'' 
)''  
.(( 
NotEmpty(( 
((( 
)(( 
.(( 
WithMessage(( '
(((' (
$str((( C
)((C D
.)) 
Length)) 
()) 
$num)) 
,)) 
$num)) 
))) 
.)) 
WithMessage)) *
())* +
$str))+ _
)))_ `
;))` a
RuleFor++ 
(++ 
x++ 
=>++ 
x++ 
.++ 
Description++ &
)++& '
.,, 
MaximumLength,, 
(,, 
$num,, #
),,# $
.,,$ %
WithMessage,,% 0
(,,0 1
$str,,1 \
),,\ ]
;,,] ^
RuleFor.. 
(.. 
x.. 
=>.. 
x.. 
... 
ImageUrl.. #
)..# $
.// 
NotEmpty// 
(// 
)// 
.// 
WithMessage// '
(//' (
$str//( D
)//D E
;//E F
}00 	
}11 
public66 

class66 $
CreateCourseDtoValidator66 )
:66* +
AbstractValidator66, =
<66= >"
CreateCourseRequestDto66> T
>66T U
{77 
public;; $
CreateCourseDtoValidator;; '
(;;' (
);;( )
{<< 	
RuleFor== 
(== 
x== 
=>== 
x== 
.== 
Name== 
)==  
.>> 
NotEmpty>> 
(>> 
)>> 
.>> 
WithMessage>> '
(>>' (
$str>>( A
)>>A B
.?? 
Length?? 
(?? 
$num?? 
,?? 
$num?? 
)?? 
.??  
WithMessage??  +
(??+ ,
$str??, ^
)??^ _
;??_ `
RuleForAA 
(AA 
xAA 
=>AA 
xAA 
.AA 
DescriptionAA &
)AA& '
.BB 
NotEmptyBB 
(BB 
)BB 
.BB 
WithMessageBB '
(BB' (
$strBB( A
)BBA B
.CC 
MaximumLengthCC 
(CC 
$numCC #
)CC# $
.CC$ %
WithMessageCC% 0
(CC0 1
$strCC1 \
)CC\ ]
;CC] ^
RuleForEE 
(EE 
xEE 
=>EE 
xEE 
.EE 
PriceEE  
)EE  !
.FF 
GreaterThanFF 
(FF 
$numFF 
)FF 
.FF  
WithMessageFF  +
(FF+ ,
$strFF, N
)FFN O
.GG 
LessThanOrEqualToGG "
(GG" #
$numGG# ,
)GG, -
.GG- .
WithMessageGG. 9
(GG9 :
$strGG: _
)GG_ `
;GG` a
RuleForII 
(II 
xII 
=>II 
xII 
.II 
CategoryRefIdII (
)II( )
.JJ 
NotEmptyJJ 
(JJ 
)JJ 
.JJ 
WithMessageJJ '
(JJ' (
$strJJ( D
)JJD E
;JJE F
RuleForLL 
(LL 
xLL 
=>LL 
xLL 
.LL 
ImageUrlLL #
)LL# $
.MM 
NotEmptyMM 
(MM 
)MM 
.MM 
WithMessageMM '
(MM' (
$strMM( B
)MMB C
;MMC D
}NN 	
}OO 
publicTT 

classTT $
UpdateCourseDtoValidatorTT )
:TT* +
AbstractValidatorTT, =
<TT= >"
UpdateCourseRequestDtoTT> T
>TTT U
{UU 
publicYY $
UpdateCourseDtoValidatorYY '
(YY' (
)YY( )
{ZZ 	
RuleFor[[ 
([[ 
x[[ 
=>[[ 
x[[ 
.[[ 
Name[[ 
)[[  
.\\ 
NotEmpty\\ 
(\\ 
)\\ 
.\\ 
WithMessage\\ '
(\\' (
$str\\( A
)\\A B
.]] 
Length]] 
(]] 
$num]] 
,]] 
$num]] 
)]] 
.]]  
WithMessage]]  +
(]]+ ,
$str]], ^
)]]^ _
;]]_ `
RuleFor__ 
(__ 
x__ 
=>__ 
x__ 
.__ 
Description__ &
)__& '
.`` 
NotEmpty`` 
(`` 
)`` 
.`` 
WithMessage`` '
(``' (
$str``( A
)``A B
.aa 
MaximumLengthaa 
(aa 
$numaa #
)aa# $
.aa$ %
WithMessageaa% 0
(aa0 1
$straa1 \
)aa\ ]
;aa] ^
RuleForcc 
(cc 
xcc 
=>cc 
xcc 
.cc 
Pricecc  
)cc  !
.dd 
GreaterThandd 
(dd 
$numdd 
)dd 
.dd  
WithMessagedd  +
(dd+ ,
$strdd, N
)ddN O
.ee 
LessThanOrEqualToee "
(ee" #
$numee# ,
)ee, -
.ee- .
WithMessageee. 9
(ee9 :
$stree: _
)ee_ `
;ee` a
RuleForgg 
(gg 
xgg 
=>gg 
xgg 
.gg 
CategoryRefIdgg (
)gg( )
.hh 
NotEmptyhh 
(hh 
)hh 
.hh 
WithMessagehh '
(hh' (
$strhh( D
)hhD E
;hhE F
RuleForjj 
(jj 
xjj 
=>jj 
xjj 
.jj 
ImageUrljj #
)jj# $
.kk 
NotEmptykk 
(kk 
)kk 
.kk 
WithMessagekk '
(kk' (
$strkk( B
)kkB C
;kkC D
}ll 	
}mm 
publicpp 

classpp %
CreatePaymentDtoValidatorpp *
:pp+ ,
AbstractValidatorpp- >
<pp> ?)
CreatePaymentMethodRequestDtopp? \
>pp\ ]
{qq 
publicuu %
CreatePaymentDtoValidatoruu (
(uu( )
)uu) *
{vv 	
RuleForww 
(ww 
xww 
=>ww 
xww 
.ww 
Nameww 
)ww  
.xx 
NotEmptyxx 
(xx 
)xx 
.xx 
WithMessagexx '
(xx' (
$strxx( B
)xxB C
.yy 
Lengthyy 
(yy 
$numyy 
,yy 
$numyy 
)yy 
.yy 
WithMessageyy *
(yy* +
$stryy+ ]
)yy] ^
;yy^ _
RuleFor{{ 
({{ 
x{{ 
=>{{ 
x{{ 
.{{ 
LogoUrl{{ "
){{" #
.|| 
NotEmpty|| 
(|| 
)|| 
.|| 
WithMessage|| '
(||' (
$str||( B
)||B C
;||C D
}}} 	
}~~ 
public
ÉÉ 

class
ÉÉ '
UpdatePaymentDtoValidator
ÉÉ *
:
ÉÉ+ ,
AbstractValidator
ÉÉ- >
<
ÉÉ> ?+
UpdatePaymentMethodRequestDto
ÉÉ? \
>
ÉÉ\ ]
{
ÑÑ 
public
àà '
UpdatePaymentDtoValidator
àà (
(
àà( )
)
àà) *
{
ââ 	
RuleFor
ää 
(
ää 
x
ää 
=>
ää 
x
ää 
.
ää 
Name
ää 
)
ää  
.
ãã 
NotEmpty
ãã 
(
ãã 
)
ãã 
.
ãã 
WithMessage
ãã '
(
ãã' (
$str
ãã( B
)
ããB C
.
åå 
Length
åå 
(
åå 
$num
åå 
,
åå 
$num
åå 
)
åå 
.
åå 
WithMessage
åå *
(
åå* +
$str
åå+ ]
)
åå] ^
;
åå^ _
RuleFor
éé 
(
éé 
x
éé 
=>
éé 
x
éé 
.
éé 
LogoUrl
éé "
)
éé" #
.
èè 
NotEmpty
èè 
(
èè 
)
èè 
.
èè 
WithMessage
èè '
(
èè' (
$str
èè( B
)
èèB C
;
èèC D
}
êê 	
}
ëë 
public
îî 

class
îî '
CreateMyClassDtoValidator
îî *
:
îî+ ,
AbstractValidator
îî- >
<
îî> ?%
CreateMyClassRequestDto
îî? V
>
îîV W
{
ïï 
public
ôô '
CreateMyClassDtoValidator
ôô (
(
ôô( )
)
ôô) *
{
öö 	
RuleFor
õõ 
(
õõ 
x
õõ 
=>
õõ 
x
õõ 
.
õõ 
UserId
õõ !
)
õõ! "
.
úú 
NotEmpty
úú 
(
úú 
)
úú 
.
úú 
WithMessage
úú '
(
úú' (
$str
úú( <
)
úú< =
;
úú= >
RuleFor
ûû 
(
ûû 
x
ûû 
=>
ûû 
x
ûû 
.
ûû 

ScheduleId
ûû %
)
ûû% &
.
üü 
NotEmpty
üü 
(
üü 
)
üü 
.
üü 
WithMessage
üü '
(
üü' (
$str
üü( @
)
üü@ A
;
üüA B
}
†† 	
}
°° 
public
¶¶ 

class
¶¶ '
UpdateMyClassDtoValidator
¶¶ *
:
¶¶+ ,
AbstractValidator
¶¶- >
<
¶¶> ?%
UpdateMyClassRequestDto
¶¶? V
>
¶¶V W
{
ßß 
public
´´ '
UpdateMyClassDtoValidator
´´ (
(
´´( )
)
´´) *
{
¨¨ 	
RuleFor
≠≠ 
(
≠≠ 
x
≠≠ 
=>
≠≠ 
x
≠≠ 
.
≠≠ 
UserId
≠≠ !
)
≠≠! "
.
ÆÆ 
NotEmpty
ÆÆ 
(
ÆÆ 
)
ÆÆ 
.
ÆÆ 
WithMessage
ÆÆ '
(
ÆÆ' (
$str
ÆÆ( <
)
ÆÆ< =
;
ÆÆ= >
RuleFor
∞∞ 
(
∞∞ 
x
∞∞ 
=>
∞∞ 
x
∞∞ 
.
∞∞ 

ScheduleId
∞∞ %
)
∞∞% &
.
±± 
NotEmpty
±± 
(
±± 
)
±± 
.
±± 
WithMessage
±± '
(
±±' (
$str
±±( @
)
±±@ A
;
±±A B
}
≤≤ 	
}
≥≥ 
public
∂∂ 

class
∂∂ (
CreateScheduleDtoValidator
∂∂ +
:
∂∂, -
AbstractValidator
∂∂. ?
<
∂∂? @&
CreateScheduleRequestDto
∂∂@ X
>
∂∂X Y
{
∑∑ 
public
ªª (
CreateScheduleDtoValidator
ªª )
(
ªª) *
)
ªª* +
{
ºº 	
RuleFor
ΩΩ 
(
ΩΩ 
x
ΩΩ 
=>
ΩΩ 
x
ΩΩ 
.
ΩΩ 
Date
ΩΩ 
)
ΩΩ  
.
ææ 
NotEmpty
ææ 
(
ææ 
)
ææ 
.
ææ 
WithMessage
ææ '
(
ææ' (
$str
ææ( :
)
ææ: ;
;
ææ; <
RuleFor
¿¿ 
(
¿¿ 
x
¿¿ 
=>
¿¿ 
x
¿¿ 
.
¿¿ 
CourseId
¿¿ #
)
¿¿# $
.
¡¡ 
NotEmpty
¡¡ 
(
¡¡ 
)
¡¡ 
.
¡¡ 
WithMessage
¡¡ '
(
¡¡' (
$str
¡¡( >
)
¡¡> ?
;
¡¡? @
}
¬¬ 	
}
√√ 
public
»» 

class
»» (
UpdateScheduleDtoValidator
»» +
:
»», -
AbstractValidator
»». ?
<
»»? @&
UpdateScheduleRequestDto
»»@ X
>
»»X Y
{
…… 
public
ÕÕ (
UpdateScheduleDtoValidator
ÕÕ )
(
ÕÕ) *
)
ÕÕ* +
{
ŒŒ 	
RuleFor
œœ 
(
œœ 
x
œœ 
=>
œœ 
x
œœ 
.
œœ 
Date
œœ 
)
œœ  
.
–– 
NotEmpty
–– 
(
–– 
)
–– 
.
–– 
WithMessage
–– '
(
––' (
$str
––( :
)
––: ;
;
––; <
RuleFor
““ 
(
““ 
x
““ 
=>
““ 
x
““ 
.
““ 
CourseId
““ #
)
““# $
.
”” 
NotEmpty
”” 
(
”” 
)
”” 
.
”” 
WithMessage
”” '
(
””' (
$str
””( >
)
””> ?
;
””? @
}
‘‘ 	
}
’’ 
}◊◊ ˛g
BD:\BootcampProject\src\04.Application\Validators\AuthValidators.cs
	namespace 	
MyApp
 
. 
Application 
. 

Validators &
{ 
public 

class $
RegisterRequestValidator )
:* +
AbstractValidator, =
<= >
RegisterRequestDto> P
>P Q
{ 
public $
RegisterRequestValidator '
(' (
)( )
{		 	
RuleFor

 
(

 
x

 
=>

 
x

 
.

 
Name

 
)

  
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( :
): ;
. 
MinimumLength 
( 
$num  
)  !
.! "
WithMessage" -
(- .
$str. W
)W X
. 
MaximumLength 
( 
$num !
)! "
." #
WithMessage# .
(. /
$str/ V
)V W
;W X
RuleFor 
( 
x 
=> 
x 
. 
Email  
)  !
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( ;
); <
. 
EmailAddress 
( 
) 
.  
WithMessage  +
(+ ,
$str, B
)B C
. 
MaximumLength 
( 
$num "
)" #
.# $
WithMessage$ /
(/ 0
$str0 Y
)Y Z
;Z [
RuleFor 
( 
x 
=> 
x 
. 
NewPassword &
)& '
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( B
)B C
. 
MinimumLength 
( 
$num  
)  !
.! "
WithMessage" -
(- .
$str. _
)_ `
. 
MaximumLength 
( 
$num !
)! "
." #
WithMessage# .
(. /
$str/ ^
)^ _
. 
Matches 
( 
$str !
)! "
." #
WithMessage# .
(. /
$str/ h
)h i
. 
Matches 
( 
$str !
)! "
." #
WithMessage# .
(. /
$str/ h
)h i
. 
Matches 
( 
$str 
) 
.  
WithMessage  +
(+ ,
$str, a
)a b
. 
Matches 
( 
$str *
)* +
.+ ,
WithMessage, 7
(7 8
$str8 r
)r s
;s t
RuleFor 
( 
x 
=> 
x 
. 
ConfirmNewPassword -
)- .
. 
NotEmpty 
( 
) 
. 
WithMessage '
(' (
$str( J
)J K
. 
Equal 
( 
x 
=> 
x 
. 
NewPassword )
)) *
.* +
WithMessage+ 6
(6 7
$str7 O
)O P
;P Q
}   	
}!! 
public## 

class## (
ConfirmEmailRequestValidator## -
:##. /
AbstractValidator##0 A
<##A B"
ConfirmEmailRequestDto##B X
>##X Y
{$$ 
public%% (
ConfirmEmailRequestValidator%% +
(%%+ ,
)%%, -
{&& 	
RuleFor'' 
('' 
x'' 
=>'' 
x'' 
.'' 
Email''  
)''  !
.(( 
NotEmpty(( 
((( 
)(( 
.(( 
WithMessage(( '
(((' (
$str((( ;
)((; <
.)) 
EmailAddress)) 
()) 
))) 
.))  
WithMessage))  +
())+ ,
$str)), B
)))B C
;))C D
RuleFor** 
(** 
x** 
=>** 
x** 
.** "
EmailConfirmationToken** 1
)**1 2
.++ 
NotEmpty++ 
(++ 
)++ 
.++ 
WithMessage++ '
(++' (
$str++( N
)++N O
;++O P
},, 	
}-- 
public// 

class// !
LoginRequestValidator// &
://' (
AbstractValidator//) :
<//: ;
LoginRequestDto//; J
>//J K
{00 
public11 !
LoginRequestValidator11 $
(11$ %
)11% &
{22 	
RuleFor33 
(33 
x33 
=>33 
x33 
.33 
Email33  
)33  !
.44 
NotEmpty44 
(44 
)44 
.44 
WithMessage44 '
(44' (
$str44( ;
)44; <
.55 
EmailAddress55 
(55 
)55 
.55  
WithMessage55  +
(55+ ,
$str55, B
)55B C
;55C D
RuleFor66 
(66 
x66 
=>66 
x66 
.66 
Password66 #
)66# $
.77 
NotEmpty77 
(77 
)77 
.77 
WithMessage77 '
(77' (
$str77( >
)77> ?
;77? @
}88 	
}99 
public;; 

class;; (
RefreshTokenRequestValidator;; -
:;;. /
AbstractValidator;;0 A
<;;A B"
RefreshTokenRequestDto;;B X
>;;X Y
{<< 
public== (
RefreshTokenRequestValidator== +
(==+ ,
)==, -
{>> 	
RuleFor?? 
(?? 
x?? 
=>?? 
x?? 
.?? 
AccessToken?? &
)??& '
.@@ 
NotEmpty@@ 
(@@ 
)@@ 
.@@ 
WithMessage@@ '
(@@' (
$str@@( B
)@@B C
;@@C D
RuleForAA 
(AA 
xAA 
=>AA 
xAA 
.AA 
RefreshTokenAA '
)AA' (
.BB 
NotEmptyBB 
(BB 
)BB 
.BB 
WithMessageBB '
(BB' (
$strBB( C
)BBC D
;BBD E
}CC 	
}DD 
publicFF 

classFF *
ChangePasswordRequestValidatorFF /
:FF0 1
AbstractValidatorFF2 C
<FFC D$
ChangePasswordRequestDtoFFD \
>FF\ ]
{GG 
publicHH *
ChangePasswordRequestValidatorHH -
(HH- .
)HH. /
{II 	
RuleForJJ 
(JJ 
xJJ 
=>JJ 
xJJ 
.JJ 
PasswordJJ #
)JJ# $
.KK 
NotEmptyKK 
(KK 
)KK 
.KK 
WithMessageKK '
(KK' (
$strKK( >
)KK> ?
;KK? @
RuleForLL 
(LL 
xLL 
=>LL 
xLL 
.LL 
NewPasswordLL &
)LL& '
.MM 
NotEmptyMM 
(MM 
)MM 
.MM 
WithMessageMM '
(MM' (
$strMM( B
)MMB C
.NN 
MinimumLengthNN 
(NN 
$numNN  
)NN  !
.NN! "
WithMessageNN" -
(NN- .
$strNN. _
)NN_ `
.PP 
MaximumLengthPP 
(PP 
$numPP !
)PP! "
.PP" #
WithMessagePP# .
(PP. /
$strPP/ ^
)PP^ _
.QQ 
MatchesQQ 
(QQ 
$strQQ !
)QQ! "
.QQ" #
WithMessageQQ# .
(QQ. /
$strQQ/ h
)QQh i
.RR 
MatchesRR 
(RR 
$strRR !
)RR! "
.RR" #
WithMessageRR# .
(RR. /
$strRR/ h
)RRh i
.SS 
MatchesSS 
(SS 
$strSS 
)SS 
.SS  
WithMessageSS  +
(SS+ ,
$strSS, a
)SSa b
.VV 
MatchesVV 
(VV 
$strVV *
)VV* +
.VV+ ,
WithMessageVV, 7
(VV7 8
$strVV8 r
)VVr s
;VVs t
RuleForWW 
(WW 
xWW 
=>WW 
xWW 
.WW 
ConfirmNewPasswordWW -
)WW- .
.XX 
NotEmptyXX 
(XX 
)XX 
.XX 
WithMessageXX '
(XX' (
$strXX( J
)XXJ K
.YY 
EqualYY 
(YY 
xYY 
=>YY 
xYY 
.YY 
NewPasswordYY )
)YY) *
.YY* +
WithMessageYY+ 6
(YY6 7
$strYY7 O
)YYO P
;YYP Q
}ZZ 	
}[[ 
public]] 

class]] *
ForgotPasswordRequestValidator]] /
:]]0 1
AbstractValidator]]2 C
<]]C D$
ForgotPasswordRequestDto]]D \
>]]\ ]
{^^ 
public__ *
ForgotPasswordRequestValidator__ -
(__- .
)__. /
{`` 	
RuleForaa 
(aa 
xaa 
=>aa 
xaa 
.aa 
Emailaa  
)aa  !
.bb 
NotEmptybb 
(bb 
)bb 
.bb 
WithMessagebb '
(bb' (
$strbb( ;
)bb; <
.cc 
EmailAddresscc 
(cc 
)cc 
.cc  
WithMessagecc  +
(cc+ ,
$strcc, B
)ccB C
;ccC D
}dd 	
}ee 
publicgg 

classgg )
ResetPasswordRequestValidatorgg .
:gg/ 0
AbstractValidatorgg1 B
<ggB C#
ResetPasswordRequestDtoggC Z
>ggZ [
{hh 
publicii )
ResetPasswordRequestValidatorii ,
(ii, -
)ii- .
{jj 	
RuleForkk 
(kk 
xkk 
=>kk 
xkk 
.kk 
Emailkk  
)kk  !
.ll 
NotEmptyll 
(ll 
)ll 
.ll 
WithMessagell '
(ll' (
$strll( ;
)ll; <
.mm 
EmailAddressmm 
(mm 
)mm 
.mm  
WithMessagemm  +
(mm+ ,
$strmm, B
)mmB C
;mmC D
RuleFornn 
(nn 
xnn 
=>nn 
xnn 
.nn 
PasswordResetTokennn -
)nn- .
.oo 
NotEmptyoo 
(oo 
)oo 
.oo 
WithMessageoo '
(oo' (
$stroo( ;
)oo; <
;oo< =
RuleForpp 
(pp 
xpp 
=>pp 
xpp 
.pp 
NewPasswordpp &
)pp& '
.qq 
NotEmptyqq 
(qq 
)qq 
.qq 
WithMessageqq '
(qq' (
$strqq( B
)qqB C
.rr 
MinimumLengthrr 
(rr 
$numrr  
)rr  !
.rr! "
WithMessagerr" -
(rr- .
$strrr. _
)rr_ `
.tt 
MaximumLengthtt 
(tt 
$numtt !
)tt! "
.tt" #
WithMessagett# .
(tt. /
$strtt/ ^
)tt^ _
.uu 
Matchesuu 
(uu 
$struu !
)uu! "
.uu" #
WithMessageuu# .
(uu. /
$struu/ h
)uuh i
.vv 
Matchesvv 
(vv 
$strvv !
)vv! "
.vv" #
WithMessagevv# .
(vv. /
$strvv/ h
)vvh i
.ww 
Matchesww 
(ww 
$strww 
)ww 
.ww  
WithMessageww  +
(ww+ ,
$strww, a
)wwa b
.zz 
Matcheszz 
(zz 
$strzz *
)zz* +
.zz+ ,
WithMessagezz, 7
(zz7 8
$strzz8 r
)zzr s
;zzs t
RuleFor{{ 
({{ 
x{{ 
=>{{ 
x{{ 
.{{ 
ConfirmNewPassword{{ -
){{- .
.|| 
NotEmpty|| 
(|| 
)|| 
.|| 
WithMessage|| '
(||' (
$str||( J
)||J K
.}} 
Equal}} 
(}} 
x}} 
=>}} 
x}} 
.}} 
NewPassword}} )
)}}) *
.}}* +
WithMessage}}+ 6
(}}6 7
$str}}7 O
)}}O P
;}}P Q
}~~ 	
} 
}ÄÄ ıs
>D:\BootcampProject\src\04.Application\Services\TokenService.cs
	namespace 	
MyApp
 
. 
Application 
. 
Services $
;$ %
public 
class 
TokenService 
: 
ITokenService )
{ 
private 
readonly 
JwtSettings  
_jwtSettings! -
;- .
private 
readonly 
ILogger 
< 
TokenService )
>) *
_logger+ 2
;2 3
public   

TokenService   
(   
JwtSettings   #
jwtSettings  $ /
,  / 0
ILogger  1 8
<  8 9
TokenService  9 E
>  E F
logger  G M
)  M N
{!! 
_jwtSettings"" 
="" 
jwtSettings"" "
;""" #
_logger## 
=## 
logger## 
;## 
}$$ 
public** 

string** 
GenerateAccessToken** %
(**% &
User**& *
user**+ /
)**/ 0
{++ 
var,, 
tokenHandler,, 
=,, 
new,, #
JwtSecurityTokenHandler,, 6
(,,6 7
),,7 8
;,,8 9
if-- 

(-- 
string-- 
.-- 
IsNullOrEmpty--  
(--  !
_jwtSettings--! -
.--- .
	SecretKey--. 7
)--7 8
)--8 9
{.. 	
throw// 
new// %
InvalidOperationException// /
(/// 0
$str//0 O
)//O P
;//P Q
}00 	
var11 
key11 
=11 
Encoding11 
.11 
UTF811 
.11  
GetBytes11  (
(11( )
_jwtSettings11) 5
.115 6
	SecretKey116 ?
)11? @
;11@ A
var55 
claims55 
=55 
BuildClaims55  
(55  !
user55! %
)55% &
;55& '
var77 
tokenDescriptor77 
=77 
new77 !#
SecurityTokenDescriptor77" 9
{88 	
Subject99 
=99 
new99 
ClaimsIdentity99 (
(99( )
claims99) /
)99/ 0
,990 1
Expires:: 
=:: 
DateTime:: 
.:: 
UtcNow:: %
.::% &

AddMinutes::& 0
(::0 1
_jwtSettings::1 =
.::= >(
AccessTokenExpirationMinutes::> Z
)::Z [
,::[ \
Issuer;; 
=;; 
_jwtSettings;; !
.;;! "
Issuer;;" (
,;;( )
Audience<< 
=<< 
_jwtSettings<< #
.<<# $
Audience<<$ ,
,<<, -
SigningCredentials== 
===  
new==! $
SigningCredentials==% 7
(==7 8
new>>  
SymmetricSecurityKey>> (
(>>( )
key>>) ,
)>>, -
,>>- .
SecurityAlgorithms?? "
.??" #
HmacSha256Signature??# 6
)??6 7
}@@ 	
;@@	 

varBB 
tokenBB 
=BB 
tokenHandlerBB  
.BB  !
CreateTokenBB! ,
(BB, -
tokenDescriptorBB- <
)BB< =
;BB= >
returnCC 
tokenHandlerCC 
.CC 

WriteTokenCC &
(CC& '
tokenCC' ,
)CC, -
;CC- .
}DD 
publicJJ 

ClaimsPrincipalJJ 
?JJ (
GetPrincipalFromExpiredTokenJJ 8
(JJ8 9
stringJJ9 ?
tokenJJ@ E
)JJE F
{KK 
varLL %
tokenValidationParametersLL %
=LL& '
newLL( +%
TokenValidationParametersLL, E
{MM 	
ValidateAudienceNN 
=NN 
_jwtSettingsNN +
.NN+ ,
ValidateAudienceNN, <
,NN< =
ValidateIssuerOO 
=OO 
_jwtSettingsOO )
.OO) *
ValidateIssuerOO* 8
,OO8 9$
ValidateIssuerSigningKeyPP $
=PP% &
_jwtSettingsPP' 3
.PP3 4$
ValidateIssuerSigningKeyPP4 L
,PPL M
IssuerSigningKeyQQ 
=QQ 
newQQ " 
SymmetricSecurityKeyQQ# 7
(QQ7 8
EncodingQQ8 @
.QQ@ A
UTF8QQA E
.QQE F
GetBytesQQF N
(QQN O
_jwtSettingsQQO [
.QQ[ \
	SecretKeyQQ\ e
)QQe f
)QQf g
,QQg h
ValidateLifetimeRR 
=RR 
falseRR $
,RR$ %
ValidIssuerSS 
=SS 
_jwtSettingsSS &
.SS& '
IssuerSS' -
,SS- .
ValidAudienceTT 
=TT 
_jwtSettingsTT (
.TT( )
AudienceTT) 1
}UU 	
;UU	 

varWW 
tokenHandlerWW 
=WW 
newWW #
JwtSecurityTokenHandlerWW 6
(WW6 7
)WW7 8
;WW8 9
tryYY 
{ZZ 	
var[[ 
	principal[[ 
=[[ 
tokenHandler[[ (
.[[( )
ValidateToken[[) 6
([[6 7
token[[7 <
,[[< =%
tokenValidationParameters[[> W
,[[W X
out[[Y \
SecurityToken[[] j
securityToken[[k x
)[[x y
;[[y z
if]] 
(]] 
securityToken]] 
is]]  
not]]! $
JwtSecurityToken]]% 5
jwtSecurityToken]]6 F
||]]G I
!^^ 
jwtSecurityToken^^ !
.^^! "
Header^^" (
.^^( )
Alg^^) ,
.^^, -
Equals^^- 3
(^^3 4
SecurityAlgorithms^^4 F
.^^F G

HmacSha256^^G Q
,^^Q R
StringComparison^^S c
.^^c d&
InvariantCultureIgnoreCase^^d ~
)^^~ 
)	^^ Ä
{__ 
throw`` 
new`` "
SecurityTokenException`` 0
(``0 1
$str``1 @
)``@ A
;``A B
}aa 
returncc 
	principalcc 
;cc 
}dd 	
catchee 
(ee 
	Exceptionee 
exee 
)ee 
{ff 	
_loggergg 
.gg 

LogWarninggg 
(gg 
exgg !
,gg! "
$strgg# O
)ggO P
;ggP Q
returnhh 
nullhh 
;hh 
}ii 	
}jj 
publicpp 

asyncpp 
Taskpp 
<pp 
boolpp 
>pp 
IsTokenValidAsyncpp -
(pp- .
stringpp. 4
tokenpp5 :
)pp: ;
{qq 
tryrr 
{ss 	
vartt 
tokenHandlertt 
=tt 
newtt "#
JwtSecurityTokenHandlertt# :
(tt: ;
)tt; <
;tt< =
varuu 
keyuu 
=uu 
Encodinguu 
.uu 
UTF8uu #
.uu# $
GetBytesuu$ ,
(uu, -
_jwtSettingsuu- 9
.uu9 :
	SecretKeyuu: C
)uuC D
;uuD E
varww %
tokenValidationParametersww )
=ww* +
newww, /%
TokenValidationParametersww0 I
{xx $
ValidateIssuerSigningKeyyy (
=yy) *
trueyy+ /
,yy/ 0
IssuerSigningKeyzz  
=zz! "
newzz# & 
SymmetricSecurityKeyzz' ;
(zz; <
keyzz< ?
)zz? @
,zz@ A
ValidateIssuer{{ 
={{  
_jwtSettings{{! -
.{{- .
ValidateIssuer{{. <
,{{< =
ValidIssuer|| 
=|| 
_jwtSettings|| *
.||* +
Issuer||+ 1
,||1 2
ValidateAudience}}  
=}}! "
_jwtSettings}}# /
.}}/ 0
ValidateAudience}}0 @
,}}@ A
ValidAudience~~ 
=~~ 
_jwtSettings~~  ,
.~~, -
Audience~~- 5
,~~5 6
ValidateLifetime  
=! "
true# '
,' (
	ClockSkew
ÄÄ 
=
ÄÄ 
TimeSpan
ÄÄ $
.
ÄÄ$ %
FromMinutes
ÄÄ% 0
(
ÄÄ0 1
_jwtSettings
ÄÄ1 =
.
ÄÄ= >
	ClockSkew
ÄÄ> G
)
ÄÄG H
}
ÅÅ 
;
ÅÅ 
tokenHandler
ÉÉ 
.
ÉÉ 
ValidateToken
ÉÉ &
(
ÉÉ& '
token
ÉÉ' ,
,
ÉÉ, -'
tokenValidationParameters
ÉÉ. G
,
ÉÉG H
out
ÉÉI L
SecurityToken
ÉÉM Z
validatedToken
ÉÉ[ i
)
ÉÉi j
;
ÉÉj k
return
ÑÑ 
await
ÑÑ 
Task
ÑÑ 
.
ÑÑ 

FromResult
ÑÑ (
(
ÑÑ( )
true
ÑÑ) -
)
ÑÑ- .
;
ÑÑ. /
}
ÖÖ 	
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ 
{
áá 	
_logger
àà 
.
àà 

LogWarning
àà 
(
àà 
ex
àà !
,
àà! "
$str
àà# <
)
àà< =
;
àà= >
return
ââ 
await
ââ 
Task
ââ 
.
ââ 

FromResult
ââ (
(
ââ( )
false
ââ) .
)
ââ. /
;
ââ/ 0
}
ää 	
}
ãã 
private
ëë 
List
ëë 
<
ëë 
Claim
ëë 
>
ëë 
BuildClaims
ëë #
(
ëë# $
User
ëë$ (
user
ëë) -
)
ëë- .
{
íí 
var
ìì 
claims
ìì 
=
ìì 
new
ìì 
List
ìì 
<
ìì 
Claim
ìì #
>
ìì# $
{
îî 	
new
óó 
(
óó %
JwtRegisteredClaimNames
óó '
.
óó' (
Sub
óó( +
,
óó+ ,
user
óó- 1
.
óó1 2
RefId
óó2 7
.
óó7 8
ToString
óó8 @
(
óó@ A
)
óóA B
)
óóB C
,
óóC D
new
òò 
(
òò %
JwtRegisteredClaimNames
òò '
.
òò' (
Email
òò( -
,
òò- .
user
òò/ 3
.
òò3 4
Email
òò4 9
??
òò: <
string
òò= C
.
òòC D
Empty
òòD I
)
òòI J
,
òòJ K
new
ôô 
(
ôô %
JwtRegisteredClaimNames
ôô '
.
ôô' (
Name
ôô( ,
,
ôô, -
user
ôô. 2
.
ôô2 3
Name
ôô3 7
??
ôô8 :
string
ôô; A
.
ôôA B
Empty
ôôB G
)
ôôG H
,
ôôH I
new
öö 
(
öö %
JwtRegisteredClaimNames
öö '
.
öö' (
Jti
öö( +
,
öö+ ,
Guid
öö- 1
.
öö1 2
NewGuid
öö2 9
(
öö9 :
)
öö: ;
.
öö; <
ToString
öö< D
(
ööD E
)
ööE F
)
ööF G
,
ööG H
new
õõ 
(
õõ %
JwtRegisteredClaimNames
õõ '
.
õõ' (
Iat
õõ( +
,
õõ+ ,
DateTimeOffset
õõ- ;
.
õõ; <
UtcNow
õõ< B
.
õõB C
ToUnixTimeSeconds
õõC T
(
õõT U
)
õõU V
.
õõV W
ToString
õõW _
(
õõ_ `
)
õõ` a
,
õõa b
ClaimValueTypes
õõc r
.
õõr s
	Integer64
õõs |
)
õõ| }
}
úú 	
;
úú	 

var
üü 
roles
üü 
=
üü 
user
üü 
.
üü 
	UserRoles
üü "
.
üü" #
Select
üü# )
(
üü) *
e
üü* +
=>
üü, .
e
üü/ 0
.
üü0 1
Role
üü1 5
)
üü5 6
.
üü6 7
Select
üü7 =
(
üü= >
e
üü> ?
=>
üü@ B
e
üüC D
.
üüD E
Name
üüE I
)
üüI J
.
üüJ K
ToList
üüK Q
(
üüQ R
)
üüR S
;
üüS T
claims
†† 
.
†† 
AddRange
†† 
(
†† 
roles
†† 
.
†† 
Select
†† $
(
††$ %
role
††% )
=>
††* ,
new
††- 0
Claim
††1 6
(
††6 7

ClaimTypes
††7 A
.
††A B
Role
††B F
,
††F G
role
††H L
)
††L M
)
††M N
)
††N O
;
††O P
var
££ 

userClaims
££ 
=
££ 
user
££ 
.
££ 

UserClaims
££ (
.
££( )
Select
££) /
(
££/ 0
a
££0 1
=>
££2 4
new
££5 8
Claim
££9 >
(
££> ?
a
££? @
.
££@ A
	ClaimType
££A J
,
££J K
a
££L M
.
££M N

ClaimValue
££N X
)
££X Y
)
££Y Z
.
££Z [
ToList
££[ a
(
££a b
)
££b c
;
££c d
claims
§§ 
.
§§ 
AddRange
§§ 
(
§§ 

userClaims
§§ "
)
§§" #
;
§§# $
return
¶¶ 
claims
¶¶ 
;
¶¶ 
}
ßß 
public
≠≠ 

string
≠≠ "
GenerateRefreshToken
≠≠ &
(
≠≠& '
)
≠≠' (
{
ÆÆ 
return
ØØ 
Base64UrlEncoder
ØØ 
.
ØØ  
Encode
ØØ  &
(
ØØ& '#
RandomNumberGenerator
ØØ' <
.
ØØ< =
GetBytes
ØØ= E
(
ØØE F
$num
ØØF H
)
ØØH I
)
ØØI J
;
ØØJ K
}
∞∞ 
public
±± 

Task
±± 
<
±± 
string
±± 
>
±± 1
#GenerateEmailConfirmationTokenAsync
±± ;
(
±±; <
)
±±< =
{
≤≤ 
return
≥≥ 
Task
≥≥ 
.
≥≥ 

FromResult
≥≥ 
(
≥≥ 
Base64UrlEncoder
≥≥ /
.
≥≥/ 0
Encode
≥≥0 6
(
≥≥6 7#
RandomNumberGenerator
≥≥7 L
.
≥≥L M
GetBytes
≥≥M U
(
≥≥U V
$num
≥≥V X
)
≥≥X Y
)
≥≥Y Z
)
≥≥Z [
;
≥≥[ \
}
¥¥ 
public
∂∂ 

Task
∂∂ 
<
∂∂ 
string
∂∂ 
>
∂∂ -
GeneratePasswordResetTokenAsync
∂∂ 7
(
∂∂7 8
)
∂∂8 9
{
∑∑ 
return
∏∏ 
Task
∏∏ 
.
∏∏ 

FromResult
∏∏ 
(
∏∏ 
Base64UrlEncoder
∏∏ /
.
∏∏/ 0
Encode
∏∏0 6
(
∏∏6 7#
RandomNumberGenerator
∏∏7 L
.
∏∏L M
GetBytes
∏∏M U
(
∏∏U V
$num
∏∏V X
)
∏∏X Y
)
∏∏Y Z
)
∏∏Z [
;
∏∏[ \
}
ππ 
}∫∫ ë
AD:\BootcampProject\src\04.Application\Services\PasswordService.cs
	namespace 	
MyApp
 
. 
Application 
. 
Services $
;$ %
public 
class 
PasswordService 
: 
IPasswordService /
{ 
public 

string 
HashPassword 
( 
string %
password& .
). /
{		 
return

 
BCrypt

 
.

 
Net

 
.

 
BCrypt

  
.

  !
HashPassword

! -
(

- .
password

. 6
)

6 7
;

7 8
} 
public 

bool 
VerifyPassword 
( 
string %
password& .
,. /
string0 6
?6 7
hashedPassword8 F
)F G
{ 
if 

( 
hashedPassword 
== 
null "
)" #
return$ *
false+ 0
;0 1
try 
{ 	
return 
BCrypt 
. 
Net 
. 
BCrypt $
.$ %
Verify% +
(+ ,
password, 4
,4 5
hashedPassword6 D
)D E
;E F
} 	
catch 
{ 	
return 
false 
; 
} 	
} 
public 

bool 
IsPasswordStrong  
(  !
string! '
?' (
password) 1
)1 2
{ 
if 

( 
password 
== 
null 
) 
return $
false% *
;* +
if!! 

(!! 
password!! 
.!! 
Length!! 
<!! 
$num!! 
)!!  
return!!! '
false!!( -
;!!- .
if## 

(## 
!## 
Regex## 
.## 
IsMatch## 
(## 
password## #
,### $
$str##% -
,##- .
RegexOptions##/ ;
.##; <
NonBacktracking##< K
)##K L
)##L M
return##N T
false##U Z
;##Z [
if$$ 

($$ 
!$$ 
Regex$$ 
.$$ 
IsMatch$$ 
($$ 
password$$ #
,$$# $
$str$$% -
,$$- .
RegexOptions$$/ ;
.$$; <
NonBacktracking$$< K
)$$K L
)$$L M
return$$N T
false$$U Z
;$$Z [
if%% 

(%% 
!%% 
Regex%% 
.%% 
IsMatch%% 
(%% 
password%% #
,%%# $
$str%%% *
,%%* +
RegexOptions%%, 8
.%%8 9
NonBacktracking%%9 H
)%%H I
)%%I J
return%%K Q
false%%R W
;%%W X
if&& 

(&& 
!&& 
Regex&& 
.&& 
IsMatch&& 
(&& 
password&& #
,&&# $
$str&&% 6
,&&6 7
RegexOptions&&8 D
.&&D E
NonBacktracking&&E T
)&&T U
)&&U V
return&&W ]
false&&^ c
;&&c d
return(( 
true(( 
;(( 
})) 
}** µ	
ID:\BootcampProject\src\04.Application\Services\Interface\ITokenService.cs
	namespace 	
MyApp
 
. 
Application 
. 
Services $
;$ %
public

 
	interface

 
ITokenService

 
{ 
string 

GenerateAccessToken 
( 
User #
user$ (
)( )
;) *
ClaimsPrincipal 
? (
GetPrincipalFromExpiredToken 1
(1 2
string2 8
token9 >
)> ?
;? @
Task 
< 	
bool	 
> 
IsTokenValidAsync  
(  !
string! '
token( -
)- .
;. /
string 
 
GenerateRefreshToken 
(  
)  !
;! "
Task 
< 	
string	 
> /
#GenerateEmailConfirmationTokenAsync 4
(4 5
)5 6
;6 7
Task 
< 	
string	 
> +
GeneratePasswordResetTokenAsync 0
(0 1
)1 2
;2 3
} °
LD:\BootcampProject\src\04.Application\Services\Interface\IPasswordService.cs
	namespace 	
MyApp
 
. 
Application 
. 
Services $
;$ %
public 
	interface 
IPasswordService !
{ 
string 

HashPassword 
( 
string 
password '
)' (
;( )
bool 
VerifyPassword	 
( 
string 
password '
,' (
string) /
?/ 0
hashedPassword1 ?
)? @
;@ A
bool 
IsPasswordStrong	 
( 
string  
?  !
password" *
)* +
;+ ,
} ˜
ID:\BootcampProject\src\04.Application\Services\Interface\IEmailService.cs
	namespace 	
MyApp
 
. 
Application 
. 
Services $
;$ %
public 
	interface 
IEmailService 
{ 
Task &
SendEmailConfirmationAsync	 #
(# $
string$ *
email+ 0
,0 1
string2 8
name9 =
,= >
string? E
confirmationLinkF V
)V W
;W X
Task "
SendPasswordResetAsync	 
(  
string  &
email' ,
,, -
string. 4
name5 9
,9 :
string; A
	resetLinkB K
)K L
;L M
Task 0
$SendPasswordChangedNotificationAsync	 -
(- .
string. 4
email5 :
,: ;
string< B
nameC G
)G H
;H I
} ¸K
>D:\BootcampProject\src\04.Application\Services\EmailService.cs
	namespace 	
MyApp
 
. 
Application 
. 
Services $
;$ %
public

 
class

 
EmailService

 
:

 
IEmailService

 )
{ 
private 
readonly 
ILogger 
< 
EmailService )
>) *
_logger+ 2
;2 3
private 
readonly 
IConfiguration #
_configuration$ 2
;2 3
private 
readonly 
string 
	_smtpHost %
;% &
private 
readonly 
int 
	_smtpPort "
;" #
private 
readonly 
string 
	_smtpUser %
;% &
private 
readonly 
string 
_smtpPassword )
;) *
private 
readonly 
string 

_fromEmail &
;& '
private 
readonly 
string 
	_fromName %
;% &
private 
readonly 
bool 

_enableSsl $
;$ %
public 

EmailService 
( 
ILogger 
<  
EmailService  ,
>, -
logger. 4
,4 5
IConfiguration6 D
configurationE R
)R S
{ 
_logger 
= 
logger 
; 
_configuration 
= 
configuration &
;& '
	_smtpHost 
= 
_configuration "
[" #
$str# ;
]; <
??= ?
$str@ K
;K L
	_smtpPort 
= 
int 
. 
Parse 
( 
_configuration ,
[, -
$str- E
]E F
??G I
$strJ O
)O P
;P Q
	_smtpUser 
= 
_configuration "
[" #
$str# ;
]; <
??= ?
string@ F
.F G
EmptyG L
;L M
_smtpPassword 
= 
_configuration &
[& '
$str' C
]C D
??E G
stringH N
.N O
EmptyO T
;T U

_fromEmail   
=   
_configuration   #
[  # $
$str  $ =
]  = >
??  ? A
	_smtpUser  B K
;  K L
	_fromName!! 
=!! 
_configuration!! "
[!!" #
$str!!# ;
]!!; <
??!!= ?
string!!@ F
.!!F G
Empty!!G L
;!!L M

_enableSsl"" 
="" 
bool"" 
."" 
Parse"" 
(""  
_configuration""  .
["". /
$str""/ H
]""H I
??""J L
$str""M T
)""T U
;""U V
}## 
private%% 
async%% 
Task%% 
SendEmailAsync%% %
(%%% &
string%%& ,
toEmail%%- 4
,%%4 5
string%%6 <
toName%%= C
,%%C D
string%%E K
subject%%L S
,%%S T
string%%U [
htmlBody%%\ d
)%%d e
{&& 
try'' 
{(( 	
if** 
(** 
string** 
.** 
IsNullOrEmpty** $
(**$ %
	_smtpUser**% .
)**. /
||**0 2
string**3 9
.**9 :
IsNullOrEmpty**: G
(**G H
_smtpPassword**H U
)**U V
)**V W
{++ 
_logger,, 
.,, 

LogWarning,, "
(,," #
$str,,# Y
,,,Y Z
toEmail,,[ b
),,b c
;,,c d
_logger-- 
.-- 
LogInformation-- &
(--& '
$str--' ;
,--; <
subject--= D
)--D E
;--E F
_logger.. 
... 
LogInformation.. &
(..& '
$str..' 5
,..5 6
htmlBody..7 ?
)..? @
;..@ A
return// 
;// 
}00 
var22 
message22 
=22 
new22 
MimeMessage22 )
(22) *
)22* +
;22+ ,
message33 
.33 
From33 
.33 
Add33 
(33 
new33  
MailboxAddress33! /
(33/ 0
	_fromName330 9
,339 :

_fromEmail33; E
)33E F
)33F G
;33G H
message44 
.44 
To44 
.44 
Add44 
(44 
new44 
MailboxAddress44 -
(44- .
toName44. 4
,444 5
toEmail446 =
)44= >
)44> ?
;44? @
message55 
.55 
Subject55 
=55 
subject55 %
;55% &
var77 
bodyBuilder77 
=77 
new77 !
BodyBuilder77" -
{88 
HtmlBody99 
=99 
htmlBody99 #
}:: 
;:: 
message;; 
.;; 
Body;; 
=;; 
bodyBuilder;; &
.;;& '
ToMessageBody;;' 4
(;;4 5
);;5 6
;;;6 7
using== 
var== 
client== 
=== 
new== "

SmtpClient==# -
(==- .
)==. /
;==/ 0
await@@ 
client@@ 
.@@ 
ConnectAsync@@ %
(@@% &
	_smtpHost@@& /
,@@/ 0
	_smtpPort@@1 :
,@@: ;

_enableSsl@@< F
?@@G H
SecureSocketOptions@@I \
.@@\ ]
SslOnConnect@@] i
:@@j k
SecureSocketOptions@@l 
.	@@ Ä
None
@@Ä Ñ
)
@@Ñ Ö
;
@@Ö Ü
awaitCC 
clientCC 
.CC 
AuthenticateAsyncCC *
(CC* +
	_smtpUserCC+ 4
,CC4 5
_smtpPasswordCC6 C
)CCC D
;CCD E
awaitFF 
clientFF 
.FF 
	SendAsyncFF "
(FF" #
messageFF# *
)FF* +
;FF+ ,
awaitII 
clientII 
.II 
DisconnectAsyncII (
(II( )
trueII) -
)II- .
;II. /
_loggerKK 
.KK 
LogInformationKK "
(KK" #
$strKK# H
,KKH I
toEmailKKJ Q
)KKQ R
;KKR S
}LL 	
catchMM 
(MM 
	ExceptionMM 
exMM 
)MM 
{NN 	
_loggerOO 
.OO 
LogErrorOO 
(OO 
exOO 
,OO  
$strOO! C
,OOC D
toEmailOOE L
)OOL M
;OOM N
throwPP 
;PP 
}QQ 	
}RR 
publicTT 

asyncTT 
TaskTT &
SendEmailConfirmationAsyncTT 0
(TT0 1
stringTT1 7
emailTT8 =
,TT= >
stringTT? E
nameTTF J
,TTJ K
stringTTL R
confirmationLinkTTS c
)TTc d
{UU 
varVV 
subjectVV 
=VV 
$strVV 7
;VV7 8
varWW 
htmlBodyWW 
=WW 
$@"WW 
$strW_ 7
{__7 8
name__8 <
}__< =
$str_c= )
{cc) *
confirmationLinkcc* :
}cc: ;
$strcn; 
"nn 
;nn 
awaitpp 
SendEmailAsyncpp 
(pp 
emailpp "
,pp" #
namepp$ (
,pp( )
subjectpp* 1
,pp1 2
htmlBodypp3 ;
)pp; <
;pp< =
}qq 
publicss 

asyncss 
Taskss "
SendPasswordResetAsyncss ,
(ss, -
stringss- 3
emailss4 9
,ss9 :
stringss; A
namessB F
,ssF G
stringssH N
	resetLinkssO X
)ssX Y
{tt 
varuu 
subjectuu 
=uu 
$struu 8
;uu8 9
varvv 
htmlBodyvv 
=vv 
$@"vv 
$strv~ 7
{~~7 8
name~~8 <
}~~< =
$str	~Ç= )
{
ÇÇ) *
	resetLink
ÇÇ* 3
}
ÇÇ3 4
$str
Çé4 
"
éé 
;
éé 
await
êê 
SendEmailAsync
êê 
(
êê 
email
êê "
,
êê" #
name
êê$ (
,
êê( )
subject
êê* 1
,
êê1 2
htmlBody
êê3 ;
)
êê; <
;
êê< =
}
ëë 
public
ìì 

async
ìì 
Task
ìì 2
$SendPasswordChangedNotificationAsync
ìì :
(
ìì: ;
string
ìì; A
email
ììB G
,
ììG H
string
ììI O
name
ììP T
)
ììT U
{
îî 
var
ïï 
subject
ïï 
=
ïï 
$str
ïï B
;
ïïB C
var
ññ 
htmlBody
ññ 
=
ññ 
$@"
ññ 
$str
ñû 7
{
ûû7 8
name
ûû8 <
}
ûû< =
$str
û≠= 
"
≠≠ 
;
≠≠ 
await
ÆÆ 
SendEmailAsync
ÆÆ 
(
ÆÆ 
email
ÆÆ "
,
ÆÆ" #
name
ÆÆ$ (
,
ÆÆ( )
subject
ÆÆ* 1
,
ÆÆ1 2
htmlBody
ÆÆ3 ;
)
ÆÆ; <
;
ÆÆ< =
}
ØØ 
}∞∞ éb
@D:\BootcampProject\src\04.Application\Mappings\MappingProfile.cs
	namespace 	
MyApp
 
. 
Application 
. 
Mappings $
{ 
public

 

class

 
MappingProfile

 
:

  !
Profile

" )
{ 
public 
MappingProfile 
( 
) 
{ 	
	CreateMap 
< 
Category 
, 
CategoryDto  +
>+ ,
(, -
)- .
;. /
	CreateMap 
< $
CreateCategoryRequestDto .
,. /
Category0 8
>8 9
(9 :
): ;
;; <
	CreateMap 
< $
UpdateCategoryRequestDto .
,. /
Category0 8
>8 9
(9 :
): ;
;; <
	CreateMap 
< 
Course 
, 
	CourseDto '
>' (
(( )
)) *
. 
	ForMember 
( 
dest 
=>  "
dest# '
.' (
CategoryRefId( 5
,5 6
opt 
=> 
opt 
. 
MapFrom &
(& '
src' *
=>+ -
src. 1
.1 2
Category2 :
.: ;
RefId; @
)@ A
)A B
. 
	ForMember 
( 
dest 
=>  "
dest# '
.' (
CategoryName( 4
,4 5
opt 
=> 
opt 
. 
MapFrom &
(& '
src' *
=>+ -
src. 1
.1 2
Category2 :
.: ;
Name; ?
)? @
)@ A
. 
	ForMember 
( 
dest 
=>  "
dest# '
.' (
ScheduleDates( 5
,5 6
opt 
=> 
opt 
. 
MapFrom &
(& '
src' *
=>+ -
src. 1
.1 2
	Schedules2 ;
.; <
Select< B
(B C
sC D
=>E G
sH I
.I J
DateJ N
)N O
.O P
ToListP V
(V W
)W X
)X Y
)Y Z
;Z [
	CreateMap 
< "
CreateCourseRequestDto ,
,, -
Course. 4
>4 5
(5 6
)6 7
;7 8
	CreateMap   
<   "
UpdateCourseRequestDto   ,
,  , -
Course  . 4
>  4 5
(  5 6
)  6 7
;  7 8
	CreateMap## 
<## 
PaymentMethod## #
,### $
PaymentMethodDto##% 5
>##5 6
(##6 7
)##7 8
;##8 9
	CreateMap$$ 
<$$ )
CreatePaymentMethodRequestDto$$ 3
,$$3 4
PaymentMethod$$5 B
>$$B C
($$C D
)$$D E
;$$E F
	CreateMap%% 
<%% )
UpdatePaymentMethodRequestDto%% 3
,%%3 4
PaymentMethod%%5 B
>%%B C
(%%C D
)%%D E
;%%E F
	CreateMap(( 
<(( 
User(( 
,(( 
UserDto(( #
>((# $
((($ %
)((% &
.)) 
	ForMember)) 
()) 
dest)) 
=>))  "
dest))# '
.))' (
Roles))( -
,))- .
opt** 
=>** !
opt**" %
.**% &
MapFrom**& -
(**- .
src**. 1
=>**2 4
src**5 8
.**8 9
	UserRoles**9 B
.**B C
Select**C I
(**I J
s**J K
=>**L N
s**O P
.**P Q
Role**Q U
.**U V
Name**V Z
)**Z [
.**[ \
ToList**\ b
(**b c
)**c d
)**d e
)**e f
.++ 
	ForMember++ 
(++ 
dest++ 
=>++  "
dest++# '
.++' (
Claims++( .
,++. /
opt,, 
=>,, !
opt,," %
.,,% &
MapFrom,,& -
(,,- .
src,,. 1
=>,,2 4
src,,5 8
.,,8 9

UserClaims,,9 C
.,,C D
Select,,D J
(,,J K
s,,K L
=>,,M O
new,,P S
ClaimDto,,T \
{,,] ^
Type,,_ c
=,,d e
s,,f g
.,,g h
	ClaimType,,h q
,,,q r
Value,,s x
=,,y z
s,,{ |
.,,| }

ClaimValue	,,} á
}
,,à â
)
,,â ä
.
,,ä ã
ToList
,,ã ë
(
,,ë í
)
,,í ì
)
,,ì î
)
,,î ï
;
,,ï ñ
	CreateMap-- 
<-- 
Role-- 
,-- 
RoleDto-- #
>--# $
(--$ %
)--% &
;--& '
	CreateMap00 
<00 
CartItem00 
,00 
CartItemResponseDto00  3
>003 4
(004 5
)005 6
.11 
	ForMember11 
(11 
dest11 
=>11  "
dest11# '
.11' (

CourseName11( 2
,112 3
opt22 
=>22 !
opt22" %
.22% &
MapFrom22& -
(22- .
src22. 1
=>222 4
src225 8
.228 9
Schedule229 A
.22A B
Course22B H
.22H I
Name22I M
)22M N
)22N O
.33 
	ForMember33 
(33 
dest33 
=>33  "
dest33# '
.33' (
Date33( ,
,33, -
opt44 
=>44 !
opt44" %
.44% &
MapFrom44& -
(44- .
src44. 1
=>442 4
src445 8
.448 9
Schedule449 A
.44A B
Date44B F
)44F G
)44G H
.55 
	ForMember55 
(55 
dest55 
=>55  "
dest55# '
.55' (
CategoryName55( 4
,554 5
opt556 9
=>55: <
opt55= @
.55@ A
MapFrom55A H
(55H I
src55I L
=>55M O
src55P S
.55S T
Schedule55T \
.55\ ]
Course55] c
.55c d
Category55d l
.55l m
Name55m q
)55q r
)55r s
.66 
	ForMember66 
(66 
dest66 
=>66  "
dest66# '
.66' (
Price66( -
,66- .
opt66/ 2
=>663 5
opt666 9
.669 :
MapFrom66: A
(66A B
src66B E
=>66F H
src66I L
.66L M
Schedule66M U
.66U V
Course66V \
.66\ ]
Price66] b
)66b c
)66c d
.77 
	ForMember77 
(77 
dest77 
=>77  "
dest77# '
.77' (
ImageUrl77( 0
,770 1
opt772 5
=>776 8
opt779 <
.77< =
MapFrom77= D
(77D E
src77E H
=>77I K
src77L O
.77O P
Schedule77P X
.77X Y
Course77Y _
.77_ `
ImageUrl77` h
)77h i
)77i j
;77j k
	CreateMap:: 
<:: 
Invoice:: 
,:: 

InvoiceDto:: )
>::) *
(::* +
)::+ ,
.;; 
	ForMember;; 
(;; 
dest;; 
=>;;  "
dest;;# '
.;;' (
Email;;( -
,;;- .
opt;;/ 2
=>;;3 5
opt;;6 9
.;;9 :
MapFrom;;: A
(;;A B
src;;B E
=>;;F H
src;;I L
.;;L M
User;;M Q
==;;R T
null;;U Y
?;;Z [
string;;\ b
.;;b c
Empty;;c h
:;;i j
src;;k n
.;;n o
User;;o s
.;;s t
Email;;t y
);;y z
);;z {
.<< 
	ForMember<< 
(<< 
dest<< 
=><<  "
dest<<# '
.<<' (

TotalPrice<<( 2
,<<2 3
opt<<4 7
=><<8 :
opt<<; >
.<<> ?
MapFrom<<? F
(<<F G
src<<G J
=><<K M
src<<N Q
.<<Q R
InvoiceDetails<<R `
.<<` a
Sum<<a d
(<<d e
s<<e f
=><<g i
s<<j k
.<<k l
Price<<l q
)<<q r
)<<r s
)<<s t
.== 
	ForMember== 
(== 
dest== 
=>==  "
dest==# '
.==' (
TotalCourse==( 3
,==3 4
opt==5 8
=>==9 ;
opt==< ?
.==? @
MapFrom==@ G
(==G H
src==H K
=>==L N
src==O R
.==R S
InvoiceDetails==S a
.==a b
Count==b g
)==g h
)==h i
;==i j
	CreateMap@@ 
<@@ 
InvoiceDetail@@ #
,@@# $
InvoiceDetailDto@@% 5
>@@5 6
(@@6 7
)@@7 8
;@@8 9
	CreateMapCC 
<CC 
MyClassCC 
,CC 

MyClassDtoCC )
>CC) *
(CC* +
)CC+ ,
.DD 
	ForMemberDD 
(DD 
destDD 
=>DD  "
destDD# '
.DD' (
CategoryNameDD( 4
,DD4 5
optDD6 9
=>DD: <
optDD= @
.DD@ A
MapFromDDA H
(DDH I
srcDDI L
=>DDM O
srcDDP S
.DDS T
ScheduleDDT \
.DD\ ]
CourseDD] c
.DDc d
CategoryDDd l
.DDl m
NameDDm q
)DDq r
)DDr s
.EE 
	ForMemberEE 
(EE 
destEE 
=>EE  "
destEE# '
.EE' (

CourseNameEE( 2
,EE2 3
optEE4 7
=>EE8 :
optEE; >
.EE> ?
MapFromEE? F
(EEF G
srcEEG J
=>EEK M
srcEEN Q
.EEQ R
ScheduleEER Z
.EEZ [
CourseEE[ a
.EEa b
NameEEb f
)EEf g
)EEg h
.FF 
	ForMemberFF 
(FF 
destFF 
=>FF  "
destFF# '
.FF' (
ImageUrlFF( 0
,FF0 1
optFF2 5
=>FF6 8
optFF9 <
.FF< =
MapFromFF= D
(FFD E
srcFFE H
=>FFI K
srcFFL O
.FFO P
ScheduleFFP X
.FFX Y
CourseFFY _
.FF_ `
ImageUrlFF` h
)FFh i
)FFi j
.GG 
	ForMemberGG 
(GG 
destGG 
=>GG  "
destGG# '
.GG' (
DateGG( ,
,GG, -
optGG. 1
=>GG2 4
optGG5 8
.GG8 9
MapFromGG9 @
(GG@ A
srcGGA D
=>GGE G
srcGGH K
.GGK L
ScheduleGGL T
.GGT U
DateGGU Y
)GGY Z
)GGZ [
;GG[ \
	CreateMapII 
<II #
CreateMyClassRequestDtoII -
,II- .
MyClassII/ 6
>II6 7
(II7 8
)II8 9
;II9 :
	CreateMapJJ 
<JJ #
UpdateMyClassRequestDtoJJ -
,JJ- .
MyClassJJ/ 6
>JJ6 7
(JJ7 8
)JJ8 9
;JJ9 :
	CreateMapMM 
<MM 
ScheduleMM 
,MM 
ScheduleDtoMM  +
>MM+ ,
(MM, -
)MM- .
.NN 
	ForMemberNN 
(NN 
destNN 
=>NN  "
destNN# '
.NN' (

CourseNameNN( 2
,NN2 3
optNN4 7
=>NN8 :
optNN; >
.NN> ?
MapFromNN? F
(NNF G
srcNNG J
=>NNK M
srcNNN Q
.NNQ R
CourseNNR X
.NNX Y
NameNNY ]
)NN] ^
)NN^ _
;NN_ `
	CreateMapPP 
<PP $
CreateScheduleRequestDtoPP .
,PP. /
SchedulePP0 8
>PP8 9
(PP9 :
)PP: ;
;PP; <
	CreateMapQQ 
<QQ $
UpdateScheduleRequestDtoQQ .
,QQ. /
ScheduleQQ0 8
>QQ8 9
(QQ9 :
)QQ: ;
;QQ; <
}RR 	
}SS 
}TT ©
[D:\BootcampProject\src\04.Application\Feature\UserManagement\Queries\GetUserByRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Queries3 :
;: ;
public		 
class		 
GetUserByRefIdQuery		  
:		! "
IRequest		# +
<		+ ,
ApiResponse		, 7
<		7 8
UserDto		8 ?
>		? @
>		@ A
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class &
GetUserByRefIdQueryHandler '
:( )
IRequestHandler* 9
<9 :
GetUserByRefIdQuery: M
,M N
ApiResponseO Z
<Z [
UserDto[ b
>b c
>c d
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
&
GetUserByRefIdQueryHandler %
(% &
IUnitOfWork& 1

unitOfWork2 <
,< =
IMapper> E
mapperF L
)L M
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
UserDto" )
>) *
>* +
Handle, 2
(2 3
GetUserByRefIdQuery3 F
requestG N
,N O
CancellationTokenP a
cancellationTokenb s
)s t
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
RefIdM R
)R S
;S T
if 

( 
user 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 8
,8 9
request: A
.A B
RefIdB G
)G H
;H I
} 	
var 
userDto 
= 
_mapper 
. 
Map !
<! "
UserDto" )
>) *
(* +
user+ /
)/ 0
;0 1
return   
ApiResponse   
<   
UserDto   "
>  " #
.  # $
SuccessResult  $ 1
(  1 2
userDto  2 9
)  9 :
;  : ;
}!! 
}"" ˙
XD:\BootcampProject\src\04.Application\Feature\UserManagement\Queries\GetAllUsersQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Queries3 :
;: ;
public 
class 
GetAllUsersQuery 
: 
IRequest  (
<( )
ApiResponse) 4
<4 5
List5 9
<9 :
UserDto: A
>A B
>B C
>C D
{		 
}

 
public 
class #
GetAllUsersQueryHandler $
:% &
IRequestHandler' 6
<6 7
GetAllUsersQuery7 G
,G H
ApiResponseI T
<T U
ListU Y
<Y Z
UserDtoZ a
>a b
>b c
>c d
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
#
GetAllUsersQueryHandler "
(" #
IUnitOfWork# .

unitOfWork/ 9
,9 :
IMapper; B
mapperC I
)I J
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
UserDto' .
>. /
>/ 0
>0 1
Handle2 8
(8 9
GetAllUsersQuery9 I
requestJ Q
,Q R
CancellationTokenS d
cancellationTokene v
)v w
{ 
var 
users 
= 
await 
_unitOfWork %
.% &
UserManager& 1
.1 2
GetAllUsersAsync2 B
(B C
)C D
;D E
var 
SchedulesDto 
= 
_mapper "
." #
Map# &
<& '
List' +
<+ ,
UserDto, 3
>3 4
>4 5
(5 6
users6 ;
); <
;< =
return 
ApiResponse 
< 
List 
<  
UserDto  '
>' (
>( )
.) *
SuccessResult* 7
(7 8
SchedulesDto8 D
)D E
;E F
} 
} Ú
XD:\BootcampProject\src\04.Application\Feature\UserManagement\Queries\GetAllRolesQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Queries3 :
;: ;
public 
class 
GetAllRolesQuery 
: 
IRequest  (
<( )
ApiResponse) 4
<4 5
List5 9
<9 :
RoleDto: A
>A B
>B C
>C D
{		 
}

 
public 
class #
GetAllRolesQueryHandler $
:% &
IRequestHandler' 6
<6 7
GetAllRolesQuery7 G
,G H
ApiResponseI T
<T U
ListU Y
<Y Z
RoleDtoZ a
>a b
>b c
>c d
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
#
GetAllRolesQueryHandler "
(" #
IUnitOfWork# .

unitOfWork/ 9
,9 :
IMapper; B
mapperC I
)I J
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
RoleDto' .
>. /
>/ 0
>0 1
Handle2 8
(8 9
GetAllRolesQuery9 I
requestJ Q
,Q R
CancellationTokenS d
cancellationTokene v
)v w
{ 
var 
roles 
= 
await 
_unitOfWork %
.% &
UserManager& 1
.1 2
GetAllRolesAsync2 B
(B C
)C D
;D E
var 
rolesDto 
= 
_mapper 
. 
Map "
<" #
List# '
<' (
RoleDto( /
>/ 0
>0 1
(1 2
roles2 7
)7 8
;8 9
return 
ApiResponse 
< 
List 
<  
RoleDto  '
>' (
>( )
.) *
SuccessResult* 7
(7 8
rolesDto8 @
)@ A
;A B
} 
} ø 
_D:\BootcampProject\src\04.Application\Feature\UserManagement\Commands\SetClaimForUserCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Commands3 ;
;; <
public

 
class

 "
SetClaimForUserCommand

 #
:

$ %
IRequest

& .
<

. /
ApiResponse

/ :
<

: ;
object

; A
>

A B
>

B C
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

required 
string 
	ClaimType $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 

required 
string 

ClaimValue %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 
class )
SetClaimForUserCommandHandler *
:+ ,
IRequestHandler- <
<< ="
SetClaimForUserCommand= S
,S T
ApiResponseU `
<` a
objecta g
>g h
>h i
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< )
SetClaimForUserCommandHandler :
>: ;
_logger< C
;C D
public 
)
SetClaimForUserCommandHandler (
(( )
IUnitOfWork) 4

unitOfWork5 ?
,? @
ILoggerA H
<H I)
SetClaimForUserCommandHandlerI f
>f g
loggerh n
)n o
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2"
SetClaimForUserCommand2 H
requestI P
,P Q
CancellationTokenR c
cancellationTokend u
)u v
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
RefIdM R
)R S
;S T
if 

( 
user 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
RefId> C
)C D
;D E
} 	
var   
	userClaim   
=   
await   
_unitOfWork   )
.  ) *
UserManager  * 5
.  5 6 
SetClaimForUserAsync  6 J
(  J K
user  K O
,  O P
request  Q X
.  X Y
	ClaimType  Y b
,  b c
request  d k
.  k l

ClaimValue  l v
)  v w
;  w x
await!! 
_unitOfWork!! 
.!! 
SaveChangesAsync!! *
(!!* +
)!!+ ,
;!!, -
_logger## 
.## 
LogInformation## 
(## 
$str## [
,##[ \
	userClaim##] f
.##f g
	ClaimType##g p
,##p q
	userClaim##r {
.##{ |

ClaimValue	##| Ü
,
##Ü á
user
##à å
.
##å ç
RefId
##ç í
)
##í ì
;
##ì î
return%% 
ApiResponse%% 
<%% 
object%% !
>%%! "
.%%" #
SuccessResult%%# 0
(%%0 1
)%%1 2
;%%2 3
}&& 
}'' Ä
`D:\BootcampProject\src\04.Application\Feature\UserManagement\Commands\SetActiveForUserCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Commands3 ;
;; <
public

 
class

 #
SetActiveForUserCommand

 $
:

% &
IRequest

' /
<

/ 0
ApiResponse

0 ;
<

; <
object

< B
>

B C
>

C D
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

bool 
isActive 
{ 
get 
; 
set  #
;# $
}% &
} 
public 
class *
SetActiveForUserCommandHandler +
:, -
IRequestHandler. =
<= >#
SetActiveForUserCommand> U
,U V
ApiResponseW b
<b c
objectc i
>i j
>j k
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< *
SetActiveForUserCommandHandler ;
>; <
_logger= D
;D E
public 
*
SetActiveForUserCommandHandler )
() *
IUnitOfWork* 5

unitOfWork6 @
,@ A
ILoggerB I
<I J*
SetActiveForUserCommandHandlerJ h
>h i
loggerj p
)p q
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2#
SetActiveForUserCommand2 I
requestJ Q
,Q R
CancellationTokenS d
cancellationTokene v
)v w
{ 
var 
changed 
= 
await 
_unitOfWork '
.' (
UserManager( 3
.3 4!
SetActiveForUserAsync4 I
(I J
requestJ Q
.Q R
RefIdR W
,W X
requestY `
.` a
isActivea i
)i j
;j k
await 
_unitOfWork 
. 
SaveChangesAsync *
(* +
)+ ,
;, -
if 

( 
! 
changed 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
RefId> C
)C D
;D E
} 	
if   

(   
request   
.   
isActive   
)   
{!! 	
_logger"" 
."" 
LogInformation"" "
(""" #
$str""# ?
,""? @
request""A H
.""H I
RefId""I N
)""N O
;""O P
}## 	
else$$ 
{%% 	
_logger&& 
.&& 
LogInformation&& "
(&&" #
$str&&# A
,&&A B
request&&C J
.&&J K
RefId&&K P
)&&P Q
;&&Q R
}'' 	
return(( 
ApiResponse(( 
<(( 
object(( !
>((! "
.((" #
SuccessResult((# 0
(((0 1
)((1 2
;((2 3
})) 
}** Ô(
bD:\BootcampProject\src\04.Application\Feature\UserManagement\Commands\RemoveRoleFromUserCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Commands3 ;
;; <
public

 
class

 %
RemoveRoleFromUserCommand

 &
:

' (
IRequest

) 1
<

1 2
ApiResponse

2 =
<

= >
object

> D
>

D E
>

E F
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

required 
RoleRequestDto "
RoleDto# *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
public 
class ,
 RemoveRoleFromUserCommandHandler -
:. /
IRequestHandler0 ?
<? @%
RemoveRoleFromUserCommand@ Y
,Y Z
ApiResponse[ f
<f g
objectg m
>m n
>n o
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< ,
 RemoveRoleFromUserCommandHandler =
>= >
_logger? F
;F G
public 
,
 RemoveRoleFromUserCommandHandler +
(+ ,
IUnitOfWork, 7

unitOfWork8 B
,B C
ILoggerD K
<K L,
 RemoveRoleFromUserCommandHandlerL l
>l m
loggern t
)t u
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2%
RemoveRoleFromUserCommand2 K
requestL S
,S T
CancellationTokenU f
cancellationTokeng x
)x y
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
RefIdM R
)R S
;S T
if 

( 
user 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
RefId> C
)C D
;D E
} 	
var 
role 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetRoleByNameAsync1 C
(C D
requestD K
.K L
RoleDtoL S
.S T
RoleNameT \
)\ ]
;] ^
if   

(   
role   
==   
null   
)   
{!! 	
_logger"" 
."" 

LogWarning"" 
("" 
$str"" U
,""U V
request""W ^
.""^ _
RoleDto""_ f
.""f g
RoleName""g o
,""o p
request""q x
.""x y
RefId""y ~
)""~ 
;	"" Ä
throw## 
new## 
ValidationException## )
(##) *
$"##* ,
$str##, 9
{##9 :
request##: A
.##A B
RoleDto##B I
.##I J
RoleName##J R
}##R S
"##S T
)##T U
;##U V
}$$ 	
var&& 
deleted&& 
=&& 
await&& 
_unitOfWork&& '
.&&' (
UserManager&&( 3
.&&3 4#
RemoveRoleFromUserAsync&&4 K
(&&K L
user&&L P
,&&P Q
role&&R V
)&&V W
;&&W X
await'' 
_unitOfWork'' 
.'' 
SaveChangesAsync'' *
(''* +
)''+ ,
;'', -
if(( 

((( 
!(( 
deleted(( 
)(( 
{)) 	
throw** 
new** 
ValidationException** )
(**) *
$"*** ,
$str**, C
{**C D
request**D K
.**K L
RoleDto**L S
.**S T
RoleName**T \
}**\ ]
"**] ^
)**^ _
;**_ `
}++ 	
_logger-- 
.-- 
LogInformation-- 
(-- 
$str-- K
,--K L
role--M Q
.--Q R
Name--R V
,--V W
user--X \
.--\ ]
RefId--] b
)--b c
;--c d
return// 
ApiResponse// 
<// 
object// !
>//! "
.//" #
SuccessResult//# 0
(//0 1
)//1 2
;//2 3
}00 
}11 Ú 
cD:\BootcampProject\src\04.Application\Feature\UserManagement\Commands\RemoveClaimFromUserCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Commands3 ;
;; <
public

 
class

 &
RemoveClaimFromUserCommand

 '
:

( )
IRequest

* 2
<

2 3
ApiResponse

3 >
<

> ?
object

? E
>

E F
>

F G
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

required 
string 
	ClaimType $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
public 
class -
!RemoveClaimFromUserCommandHandler .
:/ 0
IRequestHandler1 @
<@ A&
RemoveClaimFromUserCommandA [
,[ \
ApiResponse] h
<h i
objecti o
>o p
>p q
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< -
!RemoveClaimFromUserCommandHandler >
>> ?
_logger@ G
;G H
public 
-
!RemoveClaimFromUserCommandHandler ,
(, -
IUnitOfWork- 8

unitOfWork9 C
,C D
ILoggerE L
<L M-
!RemoveClaimFromUserCommandHandlerM n
>n o
loggerp v
)v w
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2&
RemoveClaimFromUserCommand2 L
requestM T
,T U
CancellationTokenV g
cancellationTokenh y
)y z
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
RefIdM R
)R S
;S T
if 

( 
user 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
RefId> C
)C D
;D E
} 	
var 
deleted 
= 
await 
_unitOfWork '
.' (
UserManager( 3
.3 4$
RemoveClaimFromUserAsync4 L
(L M
userM Q
,Q R
requestS Z
.Z [
	ClaimType[ d
)d e
;e f
await   
_unitOfWork   
.   
SaveChangesAsync   *
(  * +
)  + ,
;  , -
if!! 

(!! 
!!! 
deleted!! 
)!! 
{"" 	
throw## 
new## 
ValidationException## )
(##) *
$"##* ,
$str##, D
{##D E
request##E L
.##L M
	ClaimType##M V
}##V W
"##W X
)##X Y
;##Y Z
}$$ 	
_logger&& 
.&& 
LogInformation&& 
(&& 
$str&& P
,&&P Q
request&&R Y
.&&Y Z
	ClaimType&&Z c
,&&c d
user&&e i
.&&i j
RefId&&j o
)&&o p
;&&p q
return(( 
ApiResponse(( 
<(( 
object(( !
>((! "
.((" #
SuccessResult((# 0
(((0 1
)((1 2
;((2 3
})) 
}** æ(
]D:\BootcampProject\src\04.Application\Feature\UserManagement\Commands\AddRoleToUserCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
UserManagement$ 2
.2 3
Commands3 ;
;; <
public

 
class

  
AddRoleToUserCommand

 !
:

" #
IRequest

$ ,
<

, -
ApiResponse

- 8
<

8 9
object

9 ?
>

? @
>

@ A
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

required 
RoleRequestDto "
RoleDto# *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
public 
class '
AddRoleToUserCommandHandler (
:) *
IRequestHandler+ :
<: ; 
AddRoleToUserCommand; O
,O P
ApiResponseQ \
<\ ]
object] c
>c d
>d e
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< '
AddRoleToUserCommandHandler 8
>8 9
_logger: A
;A B
public 
'
AddRoleToUserCommandHandler &
(& '
IUnitOfWork' 2

unitOfWork3 =
,= >
ILogger? F
<F G'
AddRoleToUserCommandHandlerG b
>b c
loggerd j
)j k
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2 
AddRoleToUserCommand2 F
requestG N
,N O
CancellationTokenP a
cancellationTokenb s
)s t
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
RefIdM R
)R S
;S T
if 

( 
user 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
RefId> C
)C D
;D E
} 	
var 
role 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetRoleByNameAsync1 C
(C D
requestD K
.K L
RoleDtoL S
.S T
RoleNameT \
)\ ]
;] ^
if   

(   
role   
==   
null   
)   
{!! 	
_logger"" 
."" 

LogWarning"" 
("" 
$str"" U
,""U V
request""W ^
.""^ _
RoleDto""_ f
.""f g
RoleName""g o
,""o p
request""q x
.""x y
RefId""y ~
)""~ 
;	"" Ä
throw## 
new## 
ValidationException## )
(##) *
$"##* ,
$str##, 9
{##9 :
request##: A
.##A B
RoleDto##B I
.##I J
RoleName##J R
}##R S
"##S T
)##T U
;##U V
}$$ 	
var&& 
added&& 
=&& 
await&& 
_unitOfWork&& %
.&&% &
UserManager&&& 1
.&&1 2
AddRoleToUserAsync&&2 D
(&&D E
user&&E I
,&&I J
role&&K O
)&&O P
;&&P Q
await'' 
_unitOfWork'' 
.'' 
SaveChangesAsync'' *
(''* +
)''+ ,
;'', -
if(( 

((( 
!(( 
added(( 
)(( 
{)) 	
throw** 
new** 
ValidationException** )
(**) *
$"*** ,
$str**, B
{**B C
request**C J
.**J K
RoleDto**K R
.**R S
RoleName**S [
}**[ \
"**\ ]
)**] ^
;**^ _
}++ 	
_logger-- 
.-- 
LogInformation-- 
(-- 
$str-- G
,--G H
role--I M
.--M N
Name--N R
,--R S
user--T X
.--X Y
RefId--Y ^
)--^ _
;--_ `
return// 
ApiResponse// 
<// 
object// !
>//! "
.//" #
SuccessResult//# 0
(//0 1
)//1 2
;//2 3
}00 
}11 Ÿ
ZD:\BootcampProject\src\04.Application\Feature\Schedules\Queries\GetScheduleByRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	Schedules$ -
.- .
Queries. 5
;5 6
public		 
class		 #
GetScheduleByRefIdQuery		 $
:		% &
IRequest		' /
<		/ 0
ApiResponse		0 ;
<		; <
ScheduleDto		< G
>		G H
>		H I
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class *
GetScheduleByRefIdQueryHandler +
:, -
IRequestHandler. =
<= >#
GetScheduleByRefIdQuery> U
,U V
ApiResponseW b
<b c
ScheduleDtoc n
>n o
>o p
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
*
GetScheduleByRefIdQueryHandler )
() *
IUnitOfWork* 5

unitOfWork6 @
,@ A
IMapperB I
mapperJ P
)P Q
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
ScheduleDto" -
>- .
>. /
Handle0 6
(6 7#
GetScheduleByRefIdQuery7 N
requestO V
,V W
CancellationTokenX i
cancellationTokenj {
){ |
{ 
var 
schedule 
= 
await 
_unitOfWork (
.( )
	Schedules) 2
.2 3
GetByRefIdAsync3 B
(B C
requestC J
.J K
RefIdK P
)P Q
;Q R
if 

( 
schedule 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 8
,8 9
request: A
.A B
RefIdB G
)G H
;H I
} 	
var 
scheduleDto 
= 
_mapper !
.! "
Map" %
<% &
ScheduleDto& 1
>1 2
(2 3
schedule3 ;
); <
;< =
return   
ApiResponse   
<   
ScheduleDto   &
>  & '
.  ' (
SuccessResult  ( 5
(  5 6
scheduleDto  6 A
)  A B
;  B C
}!! 
}"" ù
WD:\BootcampProject\src\04.Application\Feature\Schedules\Queries\GetAllSchedulesQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	Schedules$ -
.- .
Queries. 5
;5 6
public 
class  
GetAllSchedulesQuery !
:" #
IRequest$ ,
<, -
ApiResponse- 8
<8 9
List9 =
<= >
ScheduleDto> I
>I J
>J K
>K L
{		 
}

 
public 
class '
GetAllSchedulesQueryHandler (
:) *
IRequestHandler+ :
<: ; 
GetAllSchedulesQuery; O
,O P
ApiResponseQ \
<\ ]
List] a
<a b
ScheduleDtob m
>m n
>n o
>o p
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
'
GetAllSchedulesQueryHandler &
(& '
IUnitOfWork' 2

unitOfWork3 =
,= >
IMapper? F
mapperG M
)M N
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
ScheduleDto' 2
>2 3
>3 4
>4 5
Handle6 <
(< = 
GetAllSchedulesQuery= Q
requestR Y
,Y Z
CancellationToken[ l
cancellationTokenm ~
)~ 
{ 
var 
	Schedules 
= 
await 
_unitOfWork )
.) *
	Schedules* 3
.3 4
GetAllAsync4 ?
(? @
)@ A
;A B
var 
SchedulesDto 
= 
_mapper "
." #
Map# &
<& '
List' +
<+ ,
ScheduleDto, 7
>7 8
>8 9
(9 :
	Schedules: C
)C D
;D E
return 
ApiResponse 
< 
List 
<  
ScheduleDto  +
>+ ,
>, -
.- .
SuccessResult. ;
(; <
SchedulesDto< H
)H I
;I J
} 
} Û
YD:\BootcampProject\src\04.Application\Feature\Schedules\Commands\DeleteScheduleCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	Schedules$ -
.- .
Commands. 6
;6 7
public

 
class

 !
DeleteScheduleCommand

 "
:

# $
IRequest

% -
<

- .
ApiResponse

. 9
<

9 :
object

: @
>

@ A
>

A B
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class (
DeleteScheduleCommandHandler )
:* +
IRequestHandler, ;
<; <!
DeleteScheduleCommand< Q
,Q R
ApiResponseS ^
<^ _
object_ e
>e f
>f g
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< (
DeleteScheduleCommandHandler 9
>9 :
_logger; B
;B C
public 
(
DeleteScheduleCommandHandler '
(' (
IUnitOfWork( 3

unitOfWork4 >
,> ?
ILogger@ G
<G H(
DeleteScheduleCommandHandlerH d
>d e
loggerf l
)l m
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2!
DeleteScheduleCommand2 G
requestH O
,O P
CancellationTokenQ b
cancellationTokenc t
)t u
{ 
var 
schedule 
= 
await 
_unitOfWork (
.( )
	Schedules) 2
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
schedule 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 8
,8 9
request: A
.A B
RefIdB G
)G H
;H I
} 	
await   
_unitOfWork   
.   
	Schedules   #
.  # $
DeleteAsync  $ /
(  / 0
request  0 7
.  7 8
RefId  8 =
)  = >
;  > ?
await!! 
_unitOfWork!! 
.!! 
SaveChangesAsync!! *
(!!* +
)!!+ ,
;!!, -
_logger## 
.## 
LogInformation## 
(## 
$str## B
,##B C
request##D K
.##K L
RefId##L Q
)##Q R
;##R S
return%% 
ApiResponse%% 
<%% 
object%% !
>%%! "
.%%" #
SuccessResult%%# 0
(%%0 1
)%%1 2
;%%2 3
}&& 
}'' ¨
YD:\BootcampProject\src\04.Application\Feature\Schedules\Commands\CreateScheduleCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	Schedules$ -
.- .
Commands. 6
;6 7
public

 
class

 !
CreateScheduleCommand

 "
:

# $
IRequest

% -
<

- .
ApiResponse

. 9
<

9 :
ScheduleDto

: E
>

E F
>

F G
{ 
public 

required $
CreateScheduleRequestDto ,
createScheduleDto- >
{? @
getA D
;D E
setF I
;I J
}K L
} 
public 
class (
CreateScheduleCommandHandler )
:* +
IRequestHandler, ;
<; <!
CreateScheduleCommand< Q
,Q R
ApiResponseS ^
<^ _
ScheduleDto_ j
>j k
>k l
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< (
CreateScheduleCommandHandler 9
>9 :
_logger; B
;B C
public 
(
CreateScheduleCommandHandler '
(' (
IUnitOfWork( 3

unitOfWork4 >
,> ?
IMapper@ G
mapperH N
,N O
ILoggerP W
<W X(
CreateScheduleCommandHandlerX t
>t u
loggerv |
)| }
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
ScheduleDto" -
>- .
>. /
Handle0 6
(6 7!
CreateScheduleCommand7 L
requestM T
,T U
CancellationTokenV g
cancellationTokenh y
)y z
{ 
var 
schedule 
= 
_mapper 
. 
Map "
<" #
Schedule# +
>+ ,
(, -
request- 4
.4 5
createScheduleDto5 F
)F G
;G H
await 
_unitOfWork 
. 
	Schedules #
.# $
CreateAsync$ /
(/ 0
schedule0 8
)8 9
;9 :
await 
_unitOfWork 
. 
SaveChangesAsync *
(* +
)+ ,
;, -
_logger   
.   
LogInformation   
(   
$str   M
,  M N
schedule  O W
.  W X
RefId  X ]
)  ] ^
;  ^ _
var"" 
ScheduleDto"" 
="" 
_mapper"" !
.""! "
Map""" %
<""% &
ScheduleDto""& 1
>""1 2
(""2 3
schedule""3 ;
)""; <
;""< =
return$$ 
ApiResponse$$ 
<$$ 
ScheduleDto$$ &
>$$& '
.$$' (
SuccessResult$$( 5
($$5 6
ScheduleDto$$6 A
)$$A B
;$$B C
}%% 
}&& ª
dD:\BootcampProject\src\04.Application\Feature\PaymentMethods\Queries\GetPaymentMethodByRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
PaymentMethods$ 2
.2 3
Queries3 :
;: ;
public		 
class		 (
GetPaymentMethodByRefIdQuery		 )
:		* +
IRequest		, 4
<		4 5
ApiResponse		5 @
<		@ A
PaymentMethodDto		A Q
>		Q R
>		R S
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class /
#GetPaymentMethodByRefIdQueryHandler 0
:1 2
IRequestHandler3 B
<B C(
GetPaymentMethodByRefIdQueryC _
,_ `
ApiResponsea l
<l m
PaymentMethodDtom }
>} ~
>~ 
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
/
#GetPaymentMethodByRefIdQueryHandler .
(. /
IUnitOfWork/ :

unitOfWork; E
,E F
IMapperG N
mapperO U
)U V
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
PaymentMethodDto" 2
>2 3
>3 4
Handle5 ;
(; <(
GetPaymentMethodByRefIdQuery< X
requestY `
,` a
CancellationTokenb s
cancellationToken	t Ö
)
Ö Ü
{ 
var 
paymentMethod 
= 
await !
_unitOfWork" -
.- .
PaymentMethods. <
.< =
GetByRefIdAsync= L
(L M
requestM T
.T U
RefIdU Z
)Z [
;[ \
if 

( 
paymentMethod 
== 
null !
)! "
{ 	
throw 
new 
NotFoundException '
(' (
$str( =
,= >
request? F
.F G
RefIdG L
)L M
;M N
} 	
var 
paymentMethodDto 
= 
_mapper &
.& '
Map' *
<* +
PaymentMethodDto+ ;
>; <
(< =
paymentMethod= J
)J K
;K L
return   
ApiResponse   
<   
PaymentMethodDto   +
>  + ,
.  , -
SuccessResult  - :
(  : ;
paymentMethodDto  ; K
)  K L
;  L M
}!! 
}"" ˙
aD:\BootcampProject\src\04.Application\Feature\PaymentMethods\Queries\GetAllPaymentMethodsQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
PaymentMethods$ 2
.2 3
Queries3 :
;: ;
public 
class %
GetAllPaymentMethodsQuery &
:' (
IRequest) 1
<1 2
ApiResponse2 =
<= >
List> B
<B C
PaymentMethodDtoC S
>S T
>T U
>U V
{		 
}

 
public 
class ,
 GetAllPaymentMethodsQueryHandler -
:. /
IRequestHandler0 ?
<? @%
GetAllPaymentMethodsQuery@ Y
,Y Z
ApiResponse[ f
<f g
Listg k
<k l
PaymentMethodDtol |
>| }
>} ~
>~ 
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
,
 GetAllPaymentMethodsQueryHandler +
(+ ,
IUnitOfWork, 7

unitOfWork8 B
,B C
IMapperD K
mapperL R
)R S
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
PaymentMethodDto' 7
>7 8
>8 9
>9 :
Handle; A
(A B%
GetAllPaymentMethodsQueryB [
request\ c
,c d
CancellationTokene v
cancellationToken	w à
)
à â
{ 
var 
paymentMethods 
= 
await "
_unitOfWork# .
.. /
PaymentMethods/ =
.= >
GetAllAsync> I
(I J
)J K
;K L
var 
paymentMethodsDto 
= 
_mapper  '
.' (
Map( +
<+ ,
List, 0
<0 1
PaymentMethodDto1 A
>A B
>B C
(C D
paymentMethodsD R
)R S
;S T
return 
ApiResponse 
< 
List 
<  
PaymentMethodDto  0
>0 1
>1 2
.2 3
SuccessResult3 @
(@ A
paymentMethodsDtoA R
)R S
;S T
} 
} ∏#
cD:\BootcampProject\src\04.Application\Feature\PaymentMethods\Commands\UpdatePaymentMethodCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
PaymentMethods$ 2
.2 3
Commands3 ;
;; <
public

 
class

 &
UpdatePaymentMethodCommand

 '
:

( )
IRequest

* 2
<

2 3
ApiResponse

3 >
<

> ?
PaymentMethodDto

? O
>

O P
>

P Q
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

required )
UpdatePaymentMethodRequestDto 1"
updatePaymentMethodDto2 H
{I J
getK N
;N O
setP S
;S T
}U V
} 
public 
class -
!UpdatePaymentMethodCommandHandler .
:/ 0
IRequestHandler1 @
<@ A&
UpdatePaymentMethodCommandA [
,[ \
ApiResponse] h
<h i
PaymentMethodDtoi y
>y z
>z {
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< -
!UpdatePaymentMethodCommandHandler >
>> ?
_logger@ G
;G H
public 
-
!UpdatePaymentMethodCommandHandler ,
(, -
IUnitOfWork- 8

unitOfWork9 C
,C D
IMapperE L
mapperM S
,S T
ILoggerU \
<\ ]-
!UpdatePaymentMethodCommandHandler] ~
>~ 
logger
Ä Ü
)
Ü á
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
PaymentMethodDto" 2
>2 3
>3 4
Handle5 ;
(; <&
UpdatePaymentMethodCommand< V
requestW ^
,^ _
CancellationToken` q
cancellationToken	r É
)
É Ñ
{ 
var 
paymentMethod 
= 
await !
_unitOfWork" -
.- .
PaymentMethods. <
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
paymentMethod 
== 
null !
)! "
{ 	
throw   
new   
NotFoundException   '
(  ' (
$str  ( =
,  = >
request  ? F
.  F G
RefId  G L
)  L M
;  M N
}!! 	
_mapper## 
.## 
Map## 
(## 
request## 
.## "
updatePaymentMethodDto## 2
,##2 3
paymentMethod##4 A
)##A B
;##B C
var$$  
updatedPaymentMethod$$  
=$$! "
await$$# (
_unitOfWork$$) 4
.$$4 5
PaymentMethods$$5 C
.$$C D
UpdateAsync$$D O
($$O P
paymentMethod$$P ]
)$$] ^
;$$^ _
await%% 
_unitOfWork%% 
.%% 
SaveChangesAsync%% *
(%%* +
)%%+ ,
;%%, -
_logger'' 
.'' 
LogInformation'' 
('' 
$str'' L
,''L M
request''N U
.''U V
RefId''V [
)''[ \
;''\ ]
var)) 
paymentMethodDto)) 
=)) 
_mapper)) &
.))& '
Map))' *
<))* +
PaymentMethodDto))+ ;
>)); <
())< = 
updatedPaymentMethod))= Q
)))Q R
;))R S
return++ 
ApiResponse++ 
<++ 
PaymentMethodDto++ +
>+++ ,
.++, -
SuccessResult++- :
(++: ;
paymentMethodDto++; K
)++K L
;++L M
},, 
}-- π
cD:\BootcampProject\src\04.Application\Feature\PaymentMethods\Commands\DeletePaymentMethodCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
PaymentMethods$ 2
.2 3
Commands3 ;
;; <
public

 
class

 &
DeletePaymentMethodCommand

 '
:

( )
IRequest

* 2
<

2 3
ApiResponse

3 >
<

> ?
object

? E
>

E F
>

F G
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class -
!DeletePaymentMethodCommandHandler .
:/ 0
IRequestHandler1 @
<@ A&
DeletePaymentMethodCommandA [
,[ \
ApiResponse] h
<h i
objecti o
>o p
>p q
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< -
!DeletePaymentMethodCommandHandler >
>> ?
_logger@ G
;G H
public 
-
!DeletePaymentMethodCommandHandler ,
(, -
IUnitOfWork- 8

unitOfWork9 C
,C D
ILoggerE L
<L M-
!DeletePaymentMethodCommandHandlerM n
>n o
loggerp v
)v w
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2&
DeletePaymentMethodCommand2 L
requestM T
,T U
CancellationTokenV g
cancellationTokenh y
)y z
{ 
var 
paymentMethod 
= 
await !
_unitOfWork" -
.- .
PaymentMethods. <
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
paymentMethod 
== 
null !
)! "
{ 	
throw 
new 
NotFoundException '
(' (
$str( =
,= >
request? F
.F G
RefIdG L
)L M
;M N
} 	
await   
_unitOfWork   
.   
PaymentMethods   (
.  ( )
DeleteAsync  ) 4
(  4 5
request  5 <
.  < =
RefId  = B
)  B C
;  C D
await!! 
_unitOfWork!! 
.!! 
SaveChangesAsync!! *
(!!* +
)!!+ ,
;!!, -
_logger## 
.## 
LogInformation## 
(## 
$str## L
,##L M
request##N U
.##U V
RefId##V [
)##[ \
;##\ ]
return%% 
ApiResponse%% 
<%% 
object%% !
>%%! "
.%%" #
SuccessResult%%# 0
(%%0 1
)%%1 2
;%%2 3
}&& 
}'' ù1
cD:\BootcampProject\src\04.Application\Feature\PaymentMethods\Commands\CreatePaymentMethodCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
PaymentMethods$ 2
.2 3
Commands3 ;
;; <
public

 
class

 &
CreatePaymentMethodCommand

 '
:

( )
IRequest

* 2
<

2 3
ApiResponse

3 >
<

> ?
PaymentMethodDto

? O
>

O P
>

P Q
{ 
public 

required )
CreatePaymentMethodRequestDto 1"
createPaymentMethodDto2 H
{I J
getK N
;N O
setP S
;S T
}U V
} 
public 
class -
!CreatePaymentMethodCommandHandler .
:/ 0
IRequestHandler1 @
<@ A&
CreatePaymentMethodCommandA [
,[ \
ApiResponse] h
<h i
PaymentMethodDtoi y
>y z
>z {
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< -
!CreatePaymentMethodCommandHandler >
>> ?
_logger@ G
;G H
public 
-
!CreatePaymentMethodCommandHandler ,
(, -
IUnitOfWork- 8

unitOfWork9 C
,C D
IMapperE L
mapperM S
,S T
ILoggerU \
<\ ]-
!CreatePaymentMethodCommandHandler] ~
>~ 
logger
Ä Ü
)
Ü á
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
PaymentMethodDto" 2
>2 3
>3 4
Handle5 ;
(; <&
CreatePaymentMethodCommand< V
requestW ^
,^ _
CancellationToken` q
cancellationToken	r É
)
É Ñ
{ 
var 
paymentMethod 
= 
_mapper #
.# $
Map$ '
<' (
PaymentMethod( 5
>5 6
(6 7
request7 >
.> ?"
createPaymentMethodDto? U
)U V
;V W
var 
logourl 
= 
request 
. "
createPaymentMethodDto 4
.4 5
LogoUrl5 <
;< =
if 

( 
! 
string 
. 
IsNullOrWhiteSpace &
(& '
logourl' .
). /
&&0 2
logourl 
. 

StartsWith 
( 
$str +
)+ ,
), -
{   	
var"" 

base64Data"" 
="" 
logourl"" $
.""$ %
	Substring""% .
("". /
logourl""/ 6
.""6 7
IndexOf""7 >
(""> ?
$str""? B
)""B C
+""D E
$num""F G
)""G H
;""H I
var## 
bytes## 
=## 
Convert## 
.##  
FromBase64String##  0
(##0 1

base64Data##1 ;
)##; <
;##< =
var%% 
uploadsFolder%% 
=%% 
Path%%  $
.%%$ %
Combine%%% ,
(%%, -
	Directory%%- 6
.%%6 7
GetCurrentDirectory%%7 J
(%%J K
)%%K L
,%%L M
$str%%N W
,%%W X
$str%%Y ^
)%%^ _
;%%_ `
if&& 
(&& 
!&& 
	Directory&& 
.&& 
Exists&& !
(&&! "
uploadsFolder&&" /
)&&/ 0
)&&0 1
	Directory'' 
.'' 
CreateDirectory'' )
('') *
uploadsFolder''* 7
)''7 8
;''8 9
var)) 
fileName)) 
=)) 
$")) 
{)) 
Guid)) "
.))" #
NewGuid))# *
())* +
)))+ ,
})), -
$str))- 1
"))1 2
;))2 3
var** 
filePath** 
=** 
Path** 
.**  
Combine**  '
(**' (
uploadsFolder**( 5
,**5 6
fileName**7 ?
)**? @
;**@ A
await++ 
File++ 
.++ 
WriteAllBytesAsync++ )
(++) *
filePath++* 2
,++2 3
bytes++4 9
)++9 :
;++: ;
paymentMethod.. 
... 
LogoUrl.. !
=.." #
$"..$ &
$str..& +
{..+ ,
fileName.., 4
}..4 5
"..5 6
;..6 7
}// 	
await11 
_unitOfWork11 
.11 
PaymentMethods11 (
.11( )
CreateAsync11) 4
(114 5
paymentMethod115 B
)11B C
;11C D
await22 
_unitOfWork22 
.22 
SaveChangesAsync22 *
(22* +
)22+ ,
;22, -
_logger44 
.44 
LogInformation44 
(44 
$str44 l
,44l m
paymentMethod55 
.55 
Name55 
,55 
paymentMethod55  -
.55- .
RefId55. 3
)553 4
;554 5
var77 
paymentMethodDto77 
=77 
_mapper77 &
.77& '
Map77' *
<77* +
PaymentMethodDto77+ ;
>77; <
(77< =
paymentMethod77= J
)77J K
;77K L
return99 
ApiResponse99 
<99 
PaymentMethodDto99 +
>99+ ,
.99, -
SuccessResult99- :
(99: ;
paymentMethodDto99; K
)99K L
;99L M
}:: 
};; …
YD:\BootcampProject\src\04.Application\Feature\MyClasses\Queries\GetMyClassByRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	MyClasses$ -
.- .
Queries. 5
;5 6
public		 
class		 "
GetMyClassByRefIdQuery		 #
:		$ %
IRequest		& .
<		. /
ApiResponse		/ :
<		: ;

MyClassDto		; E
>		E F
>		F G
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class )
GetMyClassByRefIdQueryHandler *
:+ ,
IRequestHandler- <
<< ="
GetMyClassByRefIdQuery= S
,S T
ApiResponseU `
<` a

MyClassDtoa k
>k l
>l m
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
)
GetMyClassByRefIdQueryHandler (
(( )
IUnitOfWork) 4

unitOfWork5 ?
,? @
IMapperA H
mapperI O
)O P
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "

MyClassDto" ,
>, -
>- .
Handle/ 5
(5 6"
GetMyClassByRefIdQuery6 L
requestM T
,T U
CancellationTokenV g
cancellationTokenh y
)y z
{ 
var 
myClass 
= 
await 
_unitOfWork '
.' (
	MyClasses( 1
.1 2
GetByRefIdAsync2 A
(A B
requestB I
.I J
RefIdJ O
)O P
;P Q
if 

( 
myClass 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 6
,6 7
request8 ?
.? @
RefId@ E
)E F
;F G
} 	
var 

myClassDto 
= 
_mapper  
.  !
Map! $
<$ %

MyClassDto% /
>/ 0
(0 1
myClass1 8
)8 9
;9 :
return!! 
ApiResponse!! 
<!! 

MyClassDto!! %
>!!% &
.!!& '
SuccessResult!!' 4
(!!4 5

myClassDto!!5 ?
)!!? @
;!!@ A
}"" 
}## ò
WD:\BootcampProject\src\04.Application\Feature\MyClasses\Queries\GetAllMyClassesQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	MyClasses$ -
.- .
Queries. 5
;5 6
public 
class  
GetAllMyClassesQuery !
:" #
IRequest$ ,
<, -
ApiResponse- 8
<8 9
List9 =
<= >

MyClassDto> H
>H I
>I J
>J K
{		 
}

 
public 
class '
GetAllMyClassesQueryHandler (
:) *
IRequestHandler+ :
<: ; 
GetAllMyClassesQuery; O
,O P
ApiResponseQ \
<\ ]
List] a
<a b

MyClassDtob l
>l m
>m n
>n o
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
'
GetAllMyClassesQueryHandler &
(& '
IUnitOfWork' 2

unitOfWork3 =
,= >
IMapper? F
mapperG M
)M N
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '

MyClassDto' 1
>1 2
>2 3
>3 4
Handle5 ;
(; < 
GetAllMyClassesQuery< P
requestQ X
,X Y
CancellationTokenZ k
cancellationTokenl }
)} ~
{ 
var 
	myClasses 
= 
await 
_unitOfWork )
.) *
	MyClasses* 3
.3 4
GetAllAsync4 ?
(? @
)@ A
;A B
var 
myClassesDto 
= 
_mapper "
." #
Map# &
<& '
List' +
<+ ,

MyClassDto, 6
>6 7
>7 8
(8 9
	myClasses9 B
)B C
;C D
return 
ApiResponse 
< 
List 
<  

MyClassDto  *
>* +
>+ ,
., -
SuccessResult- :
(: ;
myClassesDto; G
)G H
;H I
} 
} ñ
bD:\BootcampProject\src\04.Application\Feature\MyClasses\Queries\GetAllMyClassesByUserRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	MyClasses$ -
.- .
Queries. 5
;5 6
public		 
class		 +
GetAllMyClassesByUserRefIdQuery		 ,
:		- .
IRequest		/ 7
<		7 8
ApiResponse		8 C
<		C D
List		D H
<		H I

MyClassDto		I S
>		S T
>		T U
>		U V
{

 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 2
&GetAllMyClassesByUserRefIdQueryHandler 3
:4 5
IRequestHandler6 E
<E F+
GetAllMyClassesByUserRefIdQueryF e
,e f
ApiResponseg r
<r s
Lists w
<w x

MyClassDto	x Ç
>
Ç É
>
É Ñ
>
Ñ Ö
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
2
&GetAllMyClassesByUserRefIdQueryHandler 1
(1 2
IUnitOfWork2 =

unitOfWork> H
,H I
IMapperJ Q
mapperR X
)X Y
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '

MyClassDto' 1
>1 2
>2 3
>3 4
Handle5 ;
(; <+
GetAllMyClassesByUserRefIdQuery< [
request\ c
,c d
CancellationTokene v
cancellationToken	w à
)
à â
{ 
var 
	myClasses 
= 
await 
_unitOfWork )
.) *
	MyClasses* 3
.3 4"
GetAllByUserRefIdAsync4 J
(J K
requestK R
.R S
	UserRefIdS \
)\ ]
;] ^
if 

( 
	myClasses 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
	UserRefId> G
)G H
;H I
} 	
var 
myClassesDto 
= 
_mapper "
." #
Map# &
<& '
List' +
<+ ,

MyClassDto, 6
>6 7
>7 8
(8 9
	myClasses9 B
)B C
;C D
return   
ApiResponse   
<   
List   
<    

MyClassDto    *
>  * +
>  + ,
.  , -
SuccessResult  - :
(  : ;
myClassesDto  ; G
)  G H
;  H I
}!! 
}"" È
XD:\BootcampProject\src\04.Application\Feature\MyClasses\Commands\DeleteMyClassCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	MyClasses$ -
.- .
Commands. 6
;6 7
public

 
class

  
DeleteMyClassCommand

 !
:

" #
IRequest

$ ,
<

, -
ApiResponse

- 8
<

8 9
object

9 ?
>

? @
>

@ A
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class '
DeleteMyClassCommandHandler (
:) *
IRequestHandler+ :
<: ; 
DeleteMyClassCommand; O
,O P
ApiResponseQ \
<\ ]
object] c
>c d
>d e
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< '
DeleteMyClassCommandHandler 8
>8 9
_logger: A
;A B
public 
'
DeleteMyClassCommandHandler &
(& '
IUnitOfWork' 2

unitOfWork3 =
,= >
ILogger? F
<F G'
DeleteMyClassCommandHandlerG b
>b c
loggerd j
)j k
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2 
DeleteMyClassCommand2 F
requestG N
,N O
CancellationTokenP a
cancellationTokenb s
)s t
{ 
var 
myClass 
= 
await 
_unitOfWork '
.' (
	MyClasses( 1
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
myClass 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 7
,7 8
request9 @
.@ A
RefIdA F
)F G
;G H
} 	
await   
_unitOfWork   
.   
	MyClasses   #
.  # $
DeleteAsync  $ /
(  / 0
request  0 7
.  7 8
RefId  8 =
)  = >
;  > ?
await!! 
_unitOfWork!! 
.!! 
SaveChangesAsync!! *
(!!* +
)!!+ ,
;!!, -
_logger## 
.## 
LogInformation## 
(## 
$str## @
,##@ A
request##B I
.##I J
RefId##J O
)##O P
;##P Q
return%% 
ApiResponse%% 
<%% 
object%% !
>%%! "
.%%" #
SuccessResult%%# 0
(%%0 1
)%%1 2
;%%2 3
}&& 
}'' ï
XD:\BootcampProject\src\04.Application\Feature\MyClasses\Commands\CreateMyClassCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	MyClasses$ -
.- .
Commands. 6
;6 7
public

 
class

  
CreateMyClassCommand

 !
:

" #
IRequest

$ ,
<

, -
ApiResponse

- 8
<

8 9

MyClassDto

9 C
>

C D
>

D E
{ 
public 

required #
CreateMyClassRequestDto +
createMyClassDto, <
{= >
get? B
;B C
setD G
;G H
}I J
} 
public 
class '
CreateMyClassCommandHandler (
:) *
IRequestHandler+ :
<: ; 
CreateMyClassCommand; O
,O P
ApiResponseQ \
<\ ]

MyClassDto] g
>g h
>h i
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< '
CreateMyClassCommandHandler 8
>8 9
_logger: A
;A B
public 
'
CreateMyClassCommandHandler &
(& '
IUnitOfWork' 2

unitOfWork3 =
,= >
IMapper? F
mapperG M
,M N
ILoggerO V
<V W'
CreateMyClassCommandHandlerW r
>r s
loggert z
)z {
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "

MyClassDto" ,
>, -
>- .
Handle/ 5
(5 6 
CreateMyClassCommand6 J
requestK R
,R S
CancellationTokenT e
cancellationTokenf w
)w x
{ 
var 
myClass 
= 
_mapper 
. 
Map !
<! "
MyClass" )
>) *
(* +
request+ 2
.2 3
createMyClassDto3 C
)C D
;D E
await 
_unitOfWork 
. 
	MyClasses #
.# $
CreateAsync$ /
(/ 0
myClass0 7
)7 8
;8 9
await 
_unitOfWork 
. 
SaveChangesAsync *
(* +
)+ ,
;, -
_logger   
.   
LogInformation   
(   
$str   K
,  K L
myClass  M T
.  T U
RefId  U Z
)  Z [
;  [ \
var"" 

myClassDto"" 
="" 
_mapper""  
.""  !
Map""! $
<""$ %

MyClassDto""% /
>""/ 0
(""0 1
myClass""1 8
)""8 9
;""9 :
return$$ 
ApiResponse$$ 
<$$ 

MyClassDto$$ %
>$$% &
.$$& '
SuccessResult$$' 4
($$4 5

myClassDto$$5 ?
)$$? @
;$$@ A
}%% 
}&& ¬$
lD:\BootcampProject\src\04.Application\Feature\Invoices\Queries\GetInvoiceDetailsByInvoiceIdProtectedQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Invoices$ ,
., -
Queries- 4
;4 5
public		 
class		 6
*GetInvoiceDetailsByInvoiceIdProtectedQuery		 7
:		8 9
IRequest		: B
<		B C
ApiResponse		C N
<		N O
IEnumerable		O Z
<		Z [
InvoiceDetailDto		[ k
>		k l
>		l m
>		m n
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

bool 
IsPrivileged 
{ 
get "
;" #
set$ '
;' (
}) *
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class =
1GetInvoiceDetailsByInvoiceIdProtectedQueryHandler >
:? @
IRequestHandlerA P
<P Q6
*GetInvoiceDetailsByInvoiceIdProtectedQueryQ {
,{ |
ApiResponse	} à
<
à â
IEnumerable
â î
<
î ï
InvoiceDetailDto
ï •
>
• ¶
>
¶ ß
>
ß ®
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
=
1GetInvoiceDetailsByInvoiceIdProtectedQueryHandler <
(< =
IUnitOfWork= H

unitOfWorkI S
,S T
IMapperU \
mapper] c
)c d
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
IEnumerable" -
<- .
InvoiceDetailDto. >
>> ?
>? @
>@ A
HandleB H
(H I6
*GetInvoiceDetailsByInvoiceIdProtectedQueryI s
requestt {
,{ |
CancellationToken	} é
cancellationToken
è †
)
† °
{ 
var 
invoice 
= 
await 
_unitOfWork '
.' (
InvoiceManager( 6
.6 7
GetByRefIdAsync7 F
(F G
requestG N
.N O
RefIdO T
)T U
;U V
if 

( 
invoice 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 7
,7 8
request9 @
.@ A
RefIdA F
)F G
;G H
} 	
if   

(   
!   
request   
.   
IsPrivileged   !
&&  " $
(  % &
invoice  & -
.  - .
User  . 2
?  2 3
.  3 4
RefId  4 9
!=  : <
request  = D
.  D E
	UserRefId  E N
)  N O
)  O P
{!! 	
throw## 
new## 
NotFoundException## '
(##' (
$str##( 7
,##7 8
request##9 @
.##@ A
RefId##A F
)##F G
;##G H
}$$ 	
var%% 
invoiceDetails%% 
=%% 
await%% "
_unitOfWork%%# .
.%%. /
InvoiceManager%%/ =
.%%= >"
GetDetailsByRefIdAsync%%> T
(%%T U
request%%U \
.%%\ ]
RefId%%] b
)%%b c
;%%c d
var&& 
invoiceDetailsDto&& 
=&& 
_mapper&&  '
.&&' (
Map&&( +
<&&+ ,
IEnumerable&&, 7
<&&7 8
InvoiceDetailDto&&8 H
>&&H I
>&&I J
(&&J K
invoiceDetails&&K Y
)&&Y Z
;&&Z [
return'' 
ApiResponse'' 
<'' 
IEnumerable'' &
<''& '
InvoiceDetailDto''' 7
>''7 8
>''8 9
.''9 :
SuccessResult'': G
(''G H
invoiceDetailsDto''H Y
)''Y Z
;''Z [
}(( 
})) ¢
fD:\BootcampProject\src\04.Application\Feature\Invoices\Queries\GetInvoiceByRefIdAsyncProtectedQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Invoices$ ,
., -
Queries- 4
;4 5
public		 
class		 0
$GetInvoiceByRefIdAsyncProtectedQuery		 1
:		2 3
IRequest		4 <
<		< =
ApiResponse		= H
<		H I

InvoiceDto		I S
>		S T
>		T U
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

bool 
IsPrivileged 
{ 
get "
;" #
set$ '
;' (
}) *
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 7
+GetInvoiceByRefIdAsyncProtectedQueryHandler 8
:9 :
IRequestHandler; J
<J K0
$GetInvoiceByRefIdAsyncProtectedQueryK o
,o p
ApiResponseq |
<| }

InvoiceDto	} á
>
á à
>
à â
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
7
+GetInvoiceByRefIdAsyncProtectedQueryHandler 6
(6 7
IUnitOfWork7 B

unitOfWorkC M
,M N
IMapperO V
mapperW ]
)] ^
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "

InvoiceDto" ,
>, -
>- .
Handle/ 5
(5 60
$GetInvoiceByRefIdAsyncProtectedQuery6 Z
request[ b
,b c
CancellationTokend u
cancellationToken	v á
)
á à
{ 
var 
invoice 
= 
await 
_unitOfWork '
.' (
InvoiceManager( 6
.6 7
GetByRefIdAsync7 F
(F G
requestG N
.N O
RefIdO T
)T U
;U V
if 

( 
invoice 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 7
,7 8
request9 @
.@ A
RefIdA F
)F G
;G H
} 	
if   

(   
!   
request   
.   
IsPrivileged   !
&&  " $
(  % &
invoice  & -
.  - .
User  . 2
?  2 3
.  3 4
RefId  4 9
!=  : <
request  = D
.  D E
	UserRefId  E N
)  N O
)  O P
{!! 	
throw## 
new## 
NotFoundException## '
(##' (
$str##( 7
,##7 8
request##9 @
.##@ A
RefId##A F
)##F G
;##G H
}$$ 	
var%% 

invoiceDto%% 
=%% 
_mapper%%  
.%%  !
Map%%! $
<%%$ %

InvoiceDto%%% /
>%%/ 0
(%%0 1
invoice%%1 8
)%%8 9
;%%9 :
return&& 
ApiResponse&& 
<&& 

InvoiceDto&& %
>&&% &
.&&& '
SuccessResult&&' 4
(&&4 5

invoiceDto&&5 ?
)&&? @
;&&@ A
}'' 
}(( ë
UD:\BootcampProject\src\04.Application\Feature\Invoices\Queries\GetAllInvoicesQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Invoices$ ,
., -
Queries- 4
;4 5
public 
class 
GetAllInvoicesQuery  
:! "
IRequest# +
<+ ,
ApiResponse, 7
<7 8
List8 <
<< =

InvoiceDto= G
>G H
>H I
>I J
{		 
}

 
public 
class &
GetAllInvoicesQueryHandler '
:( )
IRequestHandler* 9
<9 :
GetAllInvoicesQuery: M
,M N
ApiResponseO Z
<Z [
List[ _
<_ `

InvoiceDto` j
>j k
>k l
>l m
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
&
GetAllInvoicesQueryHandler %
(% &
IUnitOfWork& 1

unitOfWork2 <
,< =
IMapper> E
mapperF L
)L M
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '

InvoiceDto' 1
>1 2
>2 3
>3 4
Handle5 ;
(; <
GetAllInvoicesQuery< O
requestP W
,W X
CancellationTokenY j
cancellationTokenk |
)| }
{ 
var 
invoices 
= 
await 
_unitOfWork (
.( )
InvoiceManager) 7
.7 8
GetAllAsync8 C
(C D
)D E
;E F
var 
invoicesDto 
= 
_mapper !
.! "
Map" %
<% &
List& *
<* +

InvoiceDto+ 5
>5 6
>6 7
(7 8
invoices8 @
)@ A
;A B
return 
ApiResponse 
< 
List 
<  

InvoiceDto  *
>* +
>+ ,
., -
SuccessResult- :
(: ;
invoicesDto; F
)F G
;G H
} 
} é
`D:\BootcampProject\src\04.Application\Feature\Invoices\Queries\GetAllInvoicesByUserRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Invoices$ ,
., -
Queries- 4
;4 5
public		 
class		 *
GetAllInvoicesByUserRefIdQuery		 +
:		, -
IRequest		. 6
<		6 7
ApiResponse		7 B
<		B C
List		C G
<		G H

InvoiceDto		H R
>		R S
>		S T
>		T U
{

 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 1
%GetAllInvoicesByUserRefIdQueryHandler 2
:3 4
IRequestHandler5 D
<D E*
GetAllInvoicesByUserRefIdQueryE c
,c d
ApiResponsee p
<p q
Listq u
<u v

InvoiceDto	v Ä
>
Ä Å
>
Å Ç
>
Ç É
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
1
%GetAllInvoicesByUserRefIdQueryHandler 0
(0 1
IUnitOfWork1 <

unitOfWork= G
,G H
IMapperI P
mapperQ W
)W X
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '

InvoiceDto' 1
>1 2
>2 3
>3 4
Handle5 ;
(; <*
GetAllInvoicesByUserRefIdQuery< Z
request[ b
,b c
CancellationTokend u
cancellationToken	v á
)
á à
{ 
var 
invoices 
= 
await 
_unitOfWork (
.( )
InvoiceManager) 7
.7 8"
GetAllByUserRefIdAsync8 N
(N O
requestO V
.V W
	UserRefIdW `
)` a
;a b
if 

( 
invoices 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
	UserRefId> G
)G H
;H I
} 	
var 
invoicesDto 
= 
_mapper !
.! "
Map" %
<% &
List& *
<* +

InvoiceDto+ 5
>5 6
>6 7
(7 8
invoices8 @
)@ A
;A B
return!! 
ApiResponse!! 
<!! 
List!! 
<!!  

InvoiceDto!!  *
>!!* +
>!!+ ,
.!!, -
SuccessResult!!- :
(!!: ;
invoicesDto!!; F
)!!F G
;!!G H
}"" 
}## ≥
VD:\BootcampProject\src\04.Application\Feature\Courses\Queries\GetCourseByRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Courses$ +
.+ ,
Queries, 3
;3 4
public		 
class		 !
GetCourseByRefIdQuery		 "
:		# $
IRequest		% -
<		- .
ApiResponse		. 9
<		9 :
	CourseDto		: C
>		C D
>		D E
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class (
GetCourseByRefIdQueryHandler )
:* +
IRequestHandler, ;
<; <!
GetCourseByRefIdQuery< Q
,Q R
ApiResponseS ^
<^ _
	CourseDto_ h
>h i
>i j
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
(
GetCourseByRefIdQueryHandler '
(' (
IUnitOfWork( 3

unitOfWork4 >
,> ?
IMapper@ G
mapperH N
)N O
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
	CourseDto" +
>+ ,
>, -
Handle. 4
(4 5!
GetCourseByRefIdQuery5 J
requestK R
,R S
CancellationTokenT e
cancellationTokenf w
)w x
{ 
var 
course 
= 
await 
_unitOfWork &
.& '
Courses' .
.. /
GetByRefIdAsync/ >
(> ?
request? F
.F G
RefIdG L
)L M
;M N
if 

( 
course 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 6
,6 7
request8 ?
.? @
RefId@ E
)E F
;F G
} 	
var 
	courseDto 
= 
_mapper 
.  
Map  #
<# $
	CourseDto$ -
>- .
(. /
course/ 5
)5 6
;6 7
return   
ApiResponse   
<   
	CourseDto   $
>  $ %
.  % &
SuccessResult  & 3
(  3 4
	courseDto  4 =
)  = >
;  > ?
}!! 
}"" ˘
SD:\BootcampProject\src\04.Application\Feature\Courses\Queries\GetAllCoursesQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Courses$ +
.+ ,
Queries, 3
;3 4
public 
class 
GetAllCoursesQuery 
:  !
IRequest" *
<* +
ApiResponse+ 6
<6 7
List7 ;
<; <
	CourseDto< E
>E F
>F G
>G H
{		 
}

 
public 
class %
GetAllCoursesQueryHandler &
:' (
IRequestHandler) 8
<8 9
GetAllCoursesQuery9 K
,K L
ApiResponseM X
<X Y
ListY ]
<] ^
	CourseDto^ g
>g h
>h i
>i j
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
%
GetAllCoursesQueryHandler $
($ %
IUnitOfWork% 0

unitOfWork1 ;
,; <
IMapper= D
mapperE K
)K L
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
	CourseDto' 0
>0 1
>1 2
>2 3
Handle4 :
(: ;
GetAllCoursesQuery; M
requestN U
,U V
CancellationTokenW h
cancellationTokeni z
)z {
{ 
var 
courses 
= 
await 
_unitOfWork '
.' (
Courses( /
./ 0
GetAllAsync0 ;
(; <
)< =
;= >
var 

coursesDto 
= 
_mapper  
.  !
Map! $
<$ %
List% )
<) *
	CourseDto* 3
>3 4
>4 5
(5 6
courses6 =
)= >
;> ?
return 
ApiResponse 
< 
List 
<  
	CourseDto  )
>) *
>* +
.+ ,
SuccessResult, 9
(9 :

coursesDto: D
)D E
;E F
} 
} úH
\D:\BootcampProject\src\04.Application\Feature\Courses\Queries\GetAllCoursesPaginatedQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Courses$ +
.+ ,
Queries, 3
;3 4
public 
class '
GetAllCoursesPaginatedQuery (
:) *
IRequest+ 3
<3 4
ApiResponse4 ?
<? @
PaginatedResponse@ Q
<Q R
IEnumerableR ]
<] ^
	CourseDto^ g
>g h
>h i
>i j
>j k
{		 
public

 

required

 !
CourseQueryParameters

 )

Parameters

* 4
;

4 5
} 
public 
class .
"GetAllCoursesPaginatedQueryHandler /
:0 1
IRequestHandler2 A
<A B'
GetAllCoursesPaginatedQueryB ]
,] ^
ApiResponse_ j
<j k
PaginatedResponsek |
<| }
IEnumerable	} à
<
à â
	CourseDto
â í
>
í ì
>
ì î
>
î ï
>
ï ñ
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
.
"GetAllCoursesPaginatedQueryHandler -
(- .
IUnitOfWork. 9

unitOfWork: D
,D E
IMapperF M
mapperN T
)T U
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
PaginatedResponse" 3
<3 4
IEnumerable4 ?
<? @
	CourseDto@ I
>I J
>J K
>K L
>L M
HandleN T
(T U'
GetAllCoursesPaginatedQueryU p
requestq x
,x y
CancellationToken	z ã
cancellationToken
å ù
)
ù û
{ 
var 
query 
= 
await 
_unitOfWork %
.% &
Courses& -
.- .
GetAllAsync. 9
(9 :
): ;
;; <
if 

( 
! 
string 
. 
IsNullOrEmpty !
(! "
request" )
.) *

Parameters* 4
.4 5
Search5 ;
); <
)< =
{ 	
query!! 
=!! 
query!! 
.!! 
Where!! 
(!!  
p!!  !
=>!!" $
p!!% &
.!!& '
Name!!' +
.!!+ ,
Contains!!, 4
(!!4 5
request!!5 <
.!!< =

Parameters!!= G
.!!G H
Search!!H N
)!!N O
||!!P R
p""# $
.""$ %
Description""% 0
.""0 1
Contains""1 9
(""9 :
request"": A
.""A B

Parameters""B L
.""L M
Search""M S
)""S T
)""T U
;""U V
}## 	
if&& 

(&& 
request&& 
.&& 

Parameters&& 
.&& 

CategoryId&& )
.&&) *
HasValue&&* 2
)&&2 3
{'' 	
query)) 
=)) 
query)) 
.)) 
Where)) 
())  
p))  !
=>))" $
p))% &
.))& '

CategoryId))' 1
==))2 4
request))5 <
.))< =

Parameters))= G
.))G H

CategoryId))H R
.))R S
Value))S X
)))X Y
;))Y Z
}** 	
if-- 

(-- 
request-- 
.-- 

Parameters-- 
.-- 
MinPrice-- '
.--' (
HasValue--( 0
)--0 1
{.. 	
query00 
=00 
query00 
.00 
Where00 
(00  
p00  !
=>00" $
p00% &
.00& '
Price00' ,
>=00- /
request000 7
.007 8

Parameters008 B
.00B C
MinPrice00C K
.00K L
Value00L Q
)00Q R
;00R S
}11 	
if44 

(44 
request44 
.44 

Parameters44 
.44 
MaxPrice44 '
.44' (
HasValue44( 0
)440 1
{55 	
query77 
=77 
query77 
.77 
Where77 
(77  
p77  !
=>77" $
p77% &
.77& '
Price77' ,
<=77- /
request770 7
.777 8

Parameters778 B
.77B C
MaxPrice77C K
.77K L
Value77L Q
)77Q R
;77R S
}88 	
query>> 
=>> 
request>> 
.>> 

Parameters>> "
.>>" #
SortBy>># )
.>>) *
ToLower>>* 1
(>>1 2
)>>2 3
switch>>4 :
{?? 	
$strAA 
=>AA 
requestAA 
.AA 

ParametersAA )
.AA) *
SortDirectionAA* 7
.AA7 8
ToLowerAA8 ?
(AA? @
)AA@ A
==AAB D
$strAAE K
?BB 
queryBB 
.BB 
OrderByDescendingBB )
(BB) *
pBB* +
=>BB, .
pBB/ 0
.BB0 1
PriceBB1 6
)BB6 7
:CC 
queryCC 
.CC 
OrderByCC 
(CC  
pCC  !
=>CC" $
pCC% &
.CC& '
PriceCC' ,
)CC, -
,CC- .
$strFF 
=>FF 
requestFF "
.FF" #

ParametersFF# -
.FF- .
SortDirectionFF. ;
.FF; <
ToLowerFF< C
(FFC D
)FFD E
==FFF H
$strFFI O
?GG 
queryGG 
.GG 
OrderByDescendingGG )
(GG) *
pGG* +
=>GG, .
pGG/ 0
.GG0 1
	CreatedAtGG1 :
)GG: ;
:HH 
queryHH 
.HH 
OrderByHH 
(HH  
pHH  !
=>HH" $
pHH% &
.HH& '
	CreatedAtHH' 0
)HH0 1
,HH1 2
_KK 
=>KK 
requestKK 
.KK 

ParametersKK #
.KK# $
SortDirectionKK$ 1
.KK1 2
ToLowerKK2 9
(KK9 :
)KK: ;
==KK< >
$strKK? E
?LL 
queryLL 
.LL 
OrderByDescendingLL )
(LL) *
pLL* +
=>LL, .
pLL/ 0
.LL0 1
NameLL1 5
)LL5 6
:MM 
queryMM 
.MM 
OrderByMM 
(MM  
pMM  !
=>MM" $
pMM% &
.MM& '
NameMM' +
)MM+ ,
}NN 	
;NN	 

varSS 
totalRecordsSS 
=SS 
querySS  
.SS  !
CountSS! &
(SS& '
)SS' (
;SS( )
varVV 
courseVV 
=VV 
queryVV 
.WW 
SkipWW 
(WW 
(WW 
requestWW 
.WW 

ParametersWW %
.WW% &

PageNumberWW& 0
-WW1 2
$numWW3 4
)WW4 5
*WW6 7
requestWW8 ?
.WW? @

ParametersWW@ J
.WWJ K
PageSizeWWK S
)WWS T
.XX 
TakeXX 
(XX 
requestXX 
.XX 

ParametersXX $
.XX$ %
PageSizeXX% -
)XX- .
.YY 
ToListYY 
(YY 
)YY 
;YY 
var__ 

coursesDto__ 
=__ 
_mapper__  
.__  !
Map__! $
<__$ %
IEnumerable__% 0
<__0 1
	CourseDto__1 :
>__: ;
>__; <
(__< =
course__= C
)__C D
;__D E
vardd 
paginatedCoursesDtodd 
=dd  !
PaginatedResponsedd" 3
<dd3 4
IEnumerabledd4 ?
<dd? @
	CourseDtodd@ I
>ddI J
>ddJ K
.ddK L
CreateddL R
(ddR S

coursesDtoee 
,ee 
requestff 
.ff 

Parametersff 
.ff 

PageNumberff )
,ff) *
requestgg 
.gg 

Parametersgg 
.gg 
PageSizegg '
,gg' (
totalRecordshh 
)hh 
;hh 
returnjj 
ApiResponsejj 
<jj 
PaginatedResponsejj ,
<jj, -
IEnumerablejj- 8
<jj8 9
	CourseDtojj9 B
>jjB C
>jjC D
>jjD E
.jjE F
SuccessResultjjF S
(jjS T
paginatedCoursesDtojjT g
)jjg h
;jjh i
}kk 
}ll Ì!
UD:\BootcampProject\src\04.Application\Feature\Courses\Commands\UpdateCourseCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Courses$ +
.+ ,
Commands, 4
;4 5
public

 
class

 
UpdateCourseCommand

  
:

! "
IRequest

# +
<

+ ,
ApiResponse

, 7
<

7 8
	CourseDto

8 A
>

A B
>

B C
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

required "
UpdateCourseRequestDto *
UpdateCourseDto+ :
{; <
get= @
;@ A
setB E
;E F
}G H
} 
public 
class &
UpdateCourseCommandHandler '
:( )
IRequestHandler* 9
<9 :
UpdateCourseCommand: M
,M N
ApiResponseO Z
<Z [
	CourseDto[ d
>d e
>e f
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< &
UpdateCourseCommandHandler 7
>7 8
_logger9 @
;@ A
public 
&
UpdateCourseCommandHandler %
(% &
IUnitOfWork& 1

unitOfWork2 <
,< =
IMapper> E
mapperF L
,L M
ILoggerN U
<U V&
UpdateCourseCommandHandlerV p
>p q
loggerr x
)x y
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
	CourseDto" +
>+ ,
>, -
Handle. 4
(4 5
UpdateCourseCommand5 H
requestI P
,P Q
CancellationTokenR c
cancellationTokend u
)u v
{ 
var 
course 
= 
await 
_unitOfWork &
.& '
Courses' .
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
course 
== 
null 
) 
{ 	
throw   
new   
NotFoundException   '
(  ' (
$str  ( 6
,  6 7
request  8 ?
.  ? @
RefId  @ E
)  E F
;  F G
}!! 	
_mapper## 
.## 
Map## 
(## 
request## 
.## 
UpdateCourseDto## +
,##+ ,
course##- 3
)##3 4
;##4 5
var$$ 
updatedCourse$$ 
=$$ 
await$$ !
_unitOfWork$$" -
.$$- .
Courses$$. 5
.$$5 6
UpdateAsync$$6 A
($$A B
course$$B H
)$$H I
;$$I J
await%% 
_unitOfWork%% 
.%% 
SaveChangesAsync%% *
(%%* +
)%%+ ,
;%%, -
_logger'' 
.'' 
LogInformation'' 
('' 
$str'' >
,''> ?
request''@ G
.''G H
RefId''H M
)''M N
;''N O
var)) 
	courseDto)) 
=)) 
_mapper)) 
.))  
Map))  #
<))# $
	CourseDto))$ -
>))- .
()). /
updatedCourse))/ <
)))< =
;))= >
return++ 
ApiResponse++ 
<++ 
	CourseDto++ $
>++$ %
.++% &
SuccessResult++& 3
(++3 4
	courseDto++4 =
)++= >
;++> ?
},, 
}-- ◊
UD:\BootcampProject\src\04.Application\Feature\Courses\Commands\DeleteCourseCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Courses$ +
.+ ,
Commands, 4
;4 5
public

 
class

 
DeleteCourseCommand

  
:

! "
IRequest

# +
<

+ ,
ApiResponse

, 7
<

7 8
object

8 >
>

> ?
>

? @
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class &
DeleteCourseCommandHandler '
:( )
IRequestHandler* 9
<9 :
DeleteCourseCommand: M
,M N
ApiResponseO Z
<Z [
object[ a
>a b
>b c
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< &
DeleteCourseCommandHandler 7
>7 8
_logger9 @
;@ A
public 
&
DeleteCourseCommandHandler %
(% &
IUnitOfWork& 1

unitOfWork2 <
,< =
ILogger> E
<E F&
DeleteCourseCommandHandlerF `
>` a
loggerb h
)h i
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2
DeleteCourseCommand2 E
requestF M
,M N
CancellationTokenO `
cancellationTokena r
)r s
{ 
var 
course 
= 
await 
_unitOfWork &
.& '
Courses' .
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
course 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 6
,6 7
request8 ?
.? @
RefId@ E
)E F
;F G
} 	
await   
_unitOfWork   
.   
Courses   !
.  ! "
DeleteAsync  " -
(  - .
request  . 5
.  5 6
RefId  6 ;
)  ; <
;  < =
await!! 
_unitOfWork!! 
.!! 
SaveChangesAsync!! *
(!!* +
)!!+ ,
;!!, -
_logger## 
.## 
LogInformation## 
(## 
$str## >
,##> ?
request##@ G
.##G H
RefId##H M
)##M N
;##N O
return%% 
ApiResponse%% 
<%% 
object%% !
>%%! "
.%%" #
SuccessResult%%# 0
(%%0 1
)%%1 2
;%%2 3
}&& 
}'' “/
UD:\BootcampProject\src\04.Application\Feature\Courses\Commands\CreateCourseCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Courses$ +
.+ ,
Commands, 4
;4 5
public

 
class

 
CreateCourseCommand

  
:

! "
IRequest

# +
<

+ ,
ApiResponse

, 7
<

7 8
	CourseDto

8 A
>

A B
>

B C
{ 
public 

required "
CreateCourseRequestDto *
createCourseDto+ :
{; <
get= @
;@ A
setB E
;E F
}G H
} 
public 
class &
CreateCourseCommandHandler '
:( )
IRequestHandler* 9
<9 :
CreateCourseCommand: M
,M N
ApiResponseO Z
<Z [
	CourseDto[ d
>d e
>e f
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< &
CreateCourseCommandHandler 7
>7 8
_logger9 @
;@ A
public 
&
CreateCourseCommandHandler %
(% &
IUnitOfWork& 1

unitOfWork2 <
,< =
IMapper> E
mapperF L
,L M
ILoggerN U
<U V&
CreateCourseCommandHandlerV p
>p q
loggerr x
)x y
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
	CourseDto" +
>+ ,
>, -
Handle. 4
(4 5
CreateCourseCommand5 H
requestI P
,P Q
CancellationTokenR c
cancellationTokend u
)u v
{ 
var 
course 
= 
_mapper 
. 
Map  
<  !
Course! '
>' (
(( )
request) 0
.0 1
createCourseDto1 @
)@ A
;A B
var 
imageurl 
= 
request 
. 
createCourseDto .
.. /
ImageUrl/ 7
;7 8
if 

( 
! 
string 
. 
IsNullOrWhiteSpace &
(& '
imageurl' /
)/ 0
&&1 3
imageurl 
. 

StartsWith 
(  
$str  ,
), -
)- .
{   	
var"" 

base64Data"" 
="" 
imageurl"" %
.""% &
	Substring""& /
(""/ 0
imageurl""0 8
.""8 9
IndexOf""9 @
(""@ A
$str""A D
)""D E
+""F G
$num""H I
)""I J
;""J K
var## 
bytes## 
=## 
Convert## 
.##  
FromBase64String##  0
(##0 1

base64Data##1 ;
)##; <
;##< =
var%% 
uploadsFolder%% 
=%% 
Path%%  $
.%%$ %
Combine%%% ,
(%%, -
	Directory%%- 6
.%%6 7
GetCurrentDirectory%%7 J
(%%J K
)%%K L
,%%L M
$str%%N W
,%%W X
$str%%Y ^
)%%^ _
;%%_ `
if&& 
(&& 
!&& 
	Directory&& 
.&& 
Exists&& !
(&&! "
uploadsFolder&&" /
)&&/ 0
)&&0 1
	Directory'' 
.'' 
CreateDirectory'' )
('') *
uploadsFolder''* 7
)''7 8
;''8 9
var)) 
fileName)) 
=)) 
$")) 
{)) 
Guid)) "
.))" #
NewGuid))# *
())* +
)))+ ,
})), -
$str))- 1
"))1 2
;))2 3
var** 
filePath** 
=** 
Path** 
.**  
Combine**  '
(**' (
uploadsFolder**( 5
,**5 6
fileName**7 ?
)**? @
;**@ A
await++ 
File++ 
.++ 
WriteAllBytesAsync++ )
(++) *
filePath++* 2
,++2 3
bytes++4 9
)++9 :
;++: ;
course.. 
... 
ImageUrl.. 
=.. 
$"..  
$str..  %
{..% &
fileName..& .
}... /
"../ 0
;..0 1
}// 	
await11 
_unitOfWork11 
.11 
Courses11 !
.11! "
CreateAsync11" -
(11- .
course11. 4
)114 5
;115 6
await22 
_unitOfWork22 
.22 
SaveChangesAsync22 *
(22* +
)22+ ,
;22, -
_logger44 
.44 
LogInformation44 
(44 
$str44 W
,44W X
course55 
.55 
Name55 
,55 
course55 
.55  
RefId55  %
)55% &
;55& '
var77 
	courseDto77 
=77 
_mapper77 
.77  
Map77  #
<77# $
	CourseDto77$ -
>77- .
(77. /
course77/ 5
)775 6
;776 7
return99 
ApiResponse99 
<99 
	CourseDto99 $
>99$ %
.99% &
SuccessResult99& 3
(993 4
	courseDto994 =
)99= >
;99> ?
}:: 
};; ‹
[D:\BootcampProject\src\04.Application\Feature\Categories\Queries\GetCategoryByRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $

Categories$ .
.. /
Queries/ 6
;6 7
public		 
class		 #
GetCategoryByRefIdQuery		 $
:		% &
IRequest		' /
<		/ 0
ApiResponse		0 ;
<		; <
CategoryDto		< G
>		G H
>		H I
{

 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class *
GetCategoryByRefIdQueryHandler +
:, -
IRequestHandler. =
<= >#
GetCategoryByRefIdQuery> U
,U V
ApiResponseW b
<b c
CategoryDtoc n
>n o
>o p
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
*
GetCategoryByRefIdQueryHandler )
() *
IUnitOfWork* 5

unitOfWork6 @
,@ A
IMapperB I
mapperJ P
)P Q
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
CategoryDto" -
>- .
>. /
Handle0 6
(6 7#
GetCategoryByRefIdQuery7 N
requestO V
,V W
CancellationTokenX i
cancellationTokenj {
){ |
{ 
var 
category 
= 
await 
_unitOfWork (
.( )

Categories) 3
.3 4
GetByRefIdAsync4 C
(C D
requestD K
.K L
RefIdL Q
)Q R
;R S
if 

( 
category 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 8
,8 9
request: A
.A B
RefIdB G
)G H
;H I
} 	
var 
categoryDto 
= 
_mapper !
.! "
Map" %
<% &
CategoryDto& 1
>1 2
(2 3
category3 ;
); <
;< =
return   
ApiResponse   
<   
CategoryDto   &
>  & '
.  ' (
SuccessResult  ( 5
(  5 6
categoryDto  6 A
)  A B
;  B C
}!! 
}"" ´
YD:\BootcampProject\src\04.Application\Feature\Categories\Queries\GetAllCategoriesQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $

Categories$ .
.. /
Queries/ 6
;6 7
public 
class !
GetAllCategoriesQuery "
:# $
IRequest% -
<- .
ApiResponse. 9
<9 :
List: >
<> ?
CategoryDto? J
>J K
>K L
>L M
{		 
}

 
public 
class (
GetAllCategoriesQueryHandler )
:* +
IRequestHandler, ;
<; <!
GetAllCategoriesQuery< Q
,Q R
ApiResponseS ^
<^ _
List_ c
<c d
CategoryDtod o
>o p
>p q
>q r
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
(
GetAllCategoriesQueryHandler '
(' (
IUnitOfWork( 3

unitOfWork4 >
,> ?
IMapper@ G
mapperH N
)N O
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
CategoryDto' 2
>2 3
>3 4
>4 5
Handle6 <
(< =!
GetAllCategoriesQuery= R
requestS Z
,Z [
CancellationToken\ m
cancellationTokenn 
)	 Ä
{ 
var 

categories 
= 
await 
_unitOfWork *
.* +

Categories+ 5
.5 6
GetAllAsync6 A
(A B
)B C
;C D
var 
categoriesDto 
= 
_mapper #
.# $
Map$ '
<' (
List( ,
<, -
CategoryDto- 8
>8 9
>9 :
(: ;

categories; E
)E F
;F G
return 
ApiResponse 
< 
List 
<  
CategoryDto  +
>+ ,
>, -
.- .
SuccessResult. ;
(; <
categoriesDto< I
)I J
;J K
} 
} ©"
ZD:\BootcampProject\src\04.Application\Feature\Categories\Commands\UpdateCategoryCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $

Categories$ .
.. /
Commands/ 7
;7 8
public

 
class

 !
UpdateCategoryCommand

 "
:

# $
IRequest

% -
<

- .
ApiResponse

. 9
<

9 :
CategoryDto

: E
>

E F
>

F G
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
public 

required $
UpdateCategoryRequestDto ,
UpdateCategoryDto- >
{? @
getA D
;D E
setF I
;I J
}K L
} 
public 
class (
UpdateCategoryCommandHandler )
:* +
IRequestHandler, ;
<; <!
UpdateCategoryCommand< Q
,Q R
ApiResponseS ^
<^ _
CategoryDto_ j
>j k
>k l
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< (
UpdateCategoryCommandHandler 9
>9 :
_logger; B
;B C
public 
(
UpdateCategoryCommandHandler '
(' (
IUnitOfWork( 3

unitOfWork4 >
,> ?
IMapper@ G
mapperH N
,N O
ILoggerP W
<W X(
UpdateCategoryCommandHandlerX t
>t u
loggerv |
)| }
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
CategoryDto" -
>- .
>. /
Handle0 6
(6 7!
UpdateCategoryCommand7 L
requestM T
,T U
CancellationTokenV g
cancellationTokenh y
)y z
{ 
var 
category 
= 
await 
_unitOfWork (
.( )

Categories) 3
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
category 
== 
null 
) 
{ 	
throw   
new   
NotFoundException   '
(  ' (
$str  ( 8
,  8 9
request  : A
.  A B
RefId  B G
)  G H
;  H I
}!! 	
_mapper## 
.## 
Map## 
(## 
request## 
.## 
UpdateCategoryDto## -
,##- .
category##/ 7
)##7 8
;##8 9
var$$ 
updatedCategory$$ 
=$$ 
await$$ #
_unitOfWork$$$ /
.$$/ 0

Categories$$0 :
.$$: ;
UpdateAsync$$; F
($$F G
category$$G O
)$$O P
;$$P Q
await%% 
_unitOfWork%% 
.%% 
SaveChangesAsync%% *
(%%* +
)%%+ ,
;%%, -
_logger'' 
.'' 
LogInformation'' 
('' 
$str'' B
,''B C
request''D K
.''K L
RefId''L Q
)''Q R
;''R S
var)) 
categoryDto)) 
=)) 
_mapper)) !
.))! "
Map))" %
<))% &
CategoryDto))& 1
>))1 2
())2 3
updatedCategory))3 B
)))B C
;))C D
return++ 
ApiResponse++ 
<++ 
CategoryDto++ &
>++& '
.++' (
SuccessResult++( 5
(++5 6
categoryDto++6 A
)++A B
;++B C
},, 
}-- ø
ZD:\BootcampProject\src\04.Application\Feature\Categories\Commands\DeleteCategoryCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $

Categories$ .
.. /
Commands/ 7
;7 8
public

 
class

 !
DeleteCategoryCommand

 "
:

# $
IRequest

% -
<

- .
ApiResponse

. 9
<

9 :
object

: @
>

@ A
>

A B
{ 
public 

Guid 
RefId 
{ 
get 
; 
set  
;  !
}" #
} 
public 
class (
DeleteCategoryCommandHandler )
:* +
IRequestHandler, ;
<; <!
DeleteCategoryCommand< Q
,Q R
ApiResponseS ^
<^ _
object_ e
>e f
>f g
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< (
DeleteCategoryCommandHandler 9
>9 :
_logger; B
;B C
public 
(
DeleteCategoryCommandHandler '
(' (
IUnitOfWork( 3

unitOfWork4 >
,> ?
ILogger@ G
<G H(
DeleteCategoryCommandHandlerH d
>d e
loggerf l
)l m
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2!
DeleteCategoryCommand2 G
requestH O
,O P
CancellationTokenQ b
cancellationTokenc t
)t u
{ 
var 
category 
= 
await 
_unitOfWork (
.( )

Categories) 3
. 
GetByRefIdAsync 
( 
request $
.$ %
RefId% *
)* +
;+ ,
if 

( 
category 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 8
,8 9
request: A
.A B
RefIdB G
)G H
;H I
} 	
if!! 

(!! 
category!! 
.!! 
Courses!! 
.!! 
Any!!  
(!!  !
)!!! "
)!!" #
{"" 	
throw## 
new## 
ValidationException## )
(##) *
$str##* T
)##T U
;##U V
}$$ 	
await&& 
_unitOfWork&& 
.&& 

Categories&& $
.&&$ %
DeleteAsync&&% 0
(&&0 1
request&&1 8
.&&8 9
RefId&&9 >
)&&> ?
;&&? @
await'' 
_unitOfWork'' 
.'' 
SaveChangesAsync'' *
(''* +
)''+ ,
;'', -
_logger)) 
.)) 
LogInformation)) 
()) 
$str)) B
,))B C
request))D K
.))K L
RefId))L Q
)))Q R
;))R S
return++ 
ApiResponse++ 
<++ 
object++ !
>++! "
.++" #
SuccessResult++# 0
(++0 1
)++1 2
;++2 3
},, 
}-- è0
ZD:\BootcampProject\src\04.Application\Feature\Categories\Commands\CreateCategoryCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $

Categories$ .
.. /
Commands/ 7
;7 8
public

 
class

 !
CreateCategoryCommand

 "
:

# $
IRequest

% -
<

- .
ApiResponse

. 9
<

9 :
CategoryDto

: E
>

E F
>

F G
{ 
public 

required $
CreateCategoryRequestDto ,
CreateCategoryDto- >
{? @
getA D
;D E
setF I
;I J
}K L
} 
public 
class (
CreateCategoryCommandHandler )
:* +
IRequestHandler, ;
<; <!
CreateCategoryCommand< Q
,Q R
ApiResponseS ^
<^ _
CategoryDto_ j
>j k
>k l
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
private 
readonly 
ILogger 
< (
CreateCategoryCommandHandler 9
>9 :
_logger; B
;B C
public 
(
CreateCategoryCommandHandler '
(' (
IUnitOfWork( 3

unitOfWork4 >
,> ?
IMapper@ G
mapperH N
,N O
ILoggerP W
<W X(
CreateCategoryCommandHandlerX t
>t u
loggerv |
)| }
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
CategoryDto" -
>- .
>. /
Handle0 6
(6 7!
CreateCategoryCommand7 L
requestM T
,T U
CancellationTokenV g
cancellationTokenh y
)y z
{ 
var 
category 
= 
_mapper 
. 
Map "
<" #
Category# +
>+ ,
(, -
request- 4
.4 5
CreateCategoryDto5 F
)F G
;G H
var 
imageurl 
= 
request 
. 
CreateCategoryDto 0
.0 1
ImageUrl1 9
;9 :
if 

( 
! 
string 
. 
IsNullOrWhiteSpace &
(& '
imageurl' /
)/ 0
&&1 3
imageurl 
. 

StartsWith 
(  
$str  ,
), -
)- .
{   	
var"" 

base64Data"" 
="" 
imageurl"" %
.""% &
	Substring""& /
(""/ 0
imageurl""0 8
.""8 9
IndexOf""9 @
(""@ A
$str""A D
)""D E
+""F G
$num""H I
)""I J
;""J K
var## 
bytes## 
=## 
Convert## 
.##  
FromBase64String##  0
(##0 1

base64Data##1 ;
)##; <
;##< =
var%% 
uploadsFolder%% 
=%% 
Path%%  $
.%%$ %
Combine%%% ,
(%%, -
	Directory%%- 6
.%%6 7
GetCurrentDirectory%%7 J
(%%J K
)%%K L
,%%L M
$str%%N W
,%%W X
$str%%Y ^
)%%^ _
;%%_ `
if&& 
(&& 
!&& 
	Directory&& 
.&& 
Exists&& !
(&&! "
uploadsFolder&&" /
)&&/ 0
)&&0 1
	Directory'' 
.'' 
CreateDirectory'' )
('') *
uploadsFolder''* 7
)''7 8
;''8 9
var)) 
fileName)) 
=)) 
$")) 
{)) 
Guid)) "
.))" #
NewGuid))# *
())* +
)))+ ,
})), -
$str))- 1
"))1 2
;))2 3
var** 
filePath** 
=** 
Path** 
.**  
Combine**  '
(**' (
uploadsFolder**( 5
,**5 6
fileName**7 ?
)**? @
;**@ A
await++ 
File++ 
.++ 
WriteAllBytesAsync++ )
(++) *
filePath++* 2
,++2 3
bytes++4 9
)++9 :
;++: ;
category.. 
... 
ImageUrl.. 
=.. 
$"..  "
$str.." '
{..' (
fileName..( 0
}..0 1
"..1 2
;..2 3
}// 	
await11 
_unitOfWork11 
.11 

Categories11 $
.11$ %
CreateAsync11% 0
(110 1
category111 9
)119 :
;11: ;
await22 
_unitOfWork22 
.22 
SaveChangesAsync22 *
(22* +
)22+ ,
;22, -
_logger44 
.44 
LogInformation44 
(44 
$str44 ]
,44] ^
category55 
.55 
Name55 
,55 
category55 #
.55# $
RefId55$ )
)55) *
;55* +
var77 
categoryDto77 
=77 
_mapper77 !
.77! "
Map77" %
<77% &
CategoryDto77& 1
>771 2
(772 3
category773 ;
)77; <
;77< =
return99 
ApiResponse99 
<99 
CategoryDto99 &
>99& '
.99' (
SuccessResult99( 5
(995 6
categoryDto996 A
)99A B
;99B C
}:: 
};; „
WD:\BootcampProject\src\04.Application\Feature\CartItems\Queries\GetAllCartItemsQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	CartItems$ -
.- .
Queries. 5
;5 6
public 
class  
GetAllCartItemsQuery !
:" #
IRequest$ ,
<, -
ApiResponse- 8
<8 9
List9 =
<= >
CartItemResponseDto> Q
>Q R
>R S
>S T
{		 
public

 

Guid

 
	UserRefId

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
} 
public 
class '
GetAllCartItemsQueryHandler (
:) *
IRequestHandler+ :
<: ; 
GetAllCartItemsQuery; O
,O P
ApiResponseQ \
<\ ]
List] a
<a b
CartItemResponseDtob u
>u v
>v w
>w x
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
'
GetAllCartItemsQueryHandler &
(& '
IUnitOfWork' 2

unitOfWork3 =
,= >
IMapper? F
mapperG M
)M N
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
CartItemResponseDto' :
>: ;
>; <
>< =
Handle> D
(D E 
GetAllCartItemsQueryE Y
requestZ a
,a b
CancellationTokenc t
cancellationToken	u Ü
)
Ü á
{ 
var 
	cartItems 
= 
await 
_unitOfWork )
.) *
	CartItems* 3
.3 4
GetAllAsync4 ?
(? @
)@ A
;A B
var 
cartItemsDto 
= 
_mapper "
." #
Map# &
<& '
List' +
<+ ,
CartItemResponseDto, ?
>? @
>@ A
(A B
	cartItemsB K
)K L
;L M
return 
ApiResponse 
< 
List 
<  
CartItemResponseDto  3
>3 4
>4 5
.5 6
SuccessResult6 C
(C D
cartItemsDtoD P
)P Q
;Q R
} 
} ƒ
bD:\BootcampProject\src\04.Application\Feature\CartItems\Queries\GetAllCartItemsByUserRefIdQuery.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	CartItems$ -
.- .
Queries. 5
;5 6
public		 
class		 +
GetAllCartItemsByUserRefIdQuery		 ,
:		- .
IRequest		/ 7
<		7 8
ApiResponse		8 C
<		C D
List		D H
<		H I
CartItemResponseDto		I \
>		\ ]
>		] ^
>		^ _
{

 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class 2
&GetAllCartItemsByUserRefIdQueryHandler 3
:4 5
IRequestHandler6 E
<E F+
GetAllCartItemsByUserRefIdQueryF e
,e f
ApiResponseg r
<r s
Lists w
<w x 
CartItemResponseDto	x ã
>
ã å
>
å ç
>
ç é
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
2
&GetAllCartItemsByUserRefIdQueryHandler 1
(1 2
IUnitOfWork2 =

unitOfWork> H
,H I
IMapperJ Q
mapperR X
)X Y
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
List" &
<& '
CartItemResponseDto' :
>: ;
>; <
>< =
Handle> D
(D E+
GetAllCartItemsByUserRefIdQueryE d
requeste l
,l m
CancellationTokenn 
cancellationToken
Ä ë
)
ë í
{ 
var 
	cartItems 
= 
await 
_unitOfWork )
.) *
	CartItems* 3
.3 4"
GetAllByUserRefIdAsync4 J
(J K
requestK R
.R S
	UserRefIdS \
)\ ]
;] ^
if 

( 
	cartItems 
== 
null 
) 
{ 	
throw 
new 
NotFoundException '
(' (
$str( 4
,4 5
request6 =
.= >
	UserRefId> G
)G H
;H I
} 	
var 
cartItemsDto 
= 
_mapper "
." #
Map# &
<& '
List' +
<+ ,
CartItemResponseDto, ?
>? @
>@ A
(A B
	cartItemsB K
)K L
;L M
return   
ApiResponse   
<   
List   
<    
CartItemResponseDto    3
>  3 4
>  4 5
.  5 6
SuccessResult  6 C
(  C D
cartItemsDto  D P
)  P Q
;  Q R
}!! 
}"" ƒ"
_D:\BootcampProject\src\04.Application\Feature\CartItems\Commands\RemoveCourseFromCartCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
	CartItems$ -
.- .
Commands. 6
;6 7
public

 
class

 '
RemoveCourseFromCartCommand

 (
:

) *
IRequest

+ 3
<

3 4
ApiResponse

4 ?
<

? @
object

@ F
>

F G
>

G H
{ 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
public 

Guid 
CartItemRefId 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 
class .
"RemoveCourseFromCartCommandHandler /
:0 1
IRequestHandler2 A
<A B'
RemoveCourseFromCartCommandB ]
,] ^
ApiResponse_ j
<j k
objectk q
>q r
>r s
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
public 
.
"RemoveCourseFromCartCommandHandler -
(- .
IUnitOfWork. 9

unitOfWork: D
)D E
{ 
_unitOfWork 
= 

unitOfWork  
;  !
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2'
RemoveCourseFromCartCommand2 M
requestN U
,U V
CancellationTokenW h
cancellationTokeni z
)z {
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
	UserRefIdM V
)V W
;W X
if 

( 
user 
== 
null 
) 
{ 	
throw 
new 
ValidationException )
() *
$"* ,
$str, >
{> ?
request? F
.F G
	UserRefIdG P
}P Q
$strQ R
"R S
)S T
;T U
} 	
if 

( 
! 
user 
. 
EmailConfirmed  
)  !
{   	
throw!! 
new!! $
AccountInactiveException!! .
(!!. /
$str!!/ M
)!!M N
;!!N O
}"" 	
if## 

(## 
!## 
user## 
.## 
IsActive## 
)## 
{$$ 	
throw%% 
new%% $
AccountInactiveException%% .
(%%. /
$str%%/ i
)%%i j
;%%j k
}&& 	
var(( 
cartitem(( 
=(( 
await(( 
_unitOfWork(( (
.((( )
	CartItems(() 2
.)) 
GetByRefIdAsync)) 
()) 
request)) $
.))$ %
CartItemRefId))% 2
)))2 3
;))3 4
if** 

(** 
cartitem** 
==** 
null** 
)** 
{++ 	
throw,, 
new,, 
ValidationException,, )
(,,) *
$",,* ,
$str,,, :
{,,: ;
request,,; B
.,,B C
CartItemRefId,,C P
},,P Q
$str,,Q [
",,[ \
),,\ ]
;,,] ^
}-- 	
await// 
_unitOfWork// 
.// 
	CartItems// #
.//# $
DeleteAsync//$ /
(/// 0
request//0 7
.//7 8
CartItemRefId//8 E
)//E F
;//F G
await22 
_unitOfWork22 
.22 
SaveChangesAsync22 *
(22* +
)22+ ,
;22, -
return44 
ApiResponse44 
<44 
object44 !
>44! "
.44" #
SuccessResult44# 0
(440 1
)441 2
;442 3
}55 
}66 π[
\D:\BootcampProject\src\04.Application\Feature\CartItems\Commands\CheckoutCartItemsCommand.cs
	namespace

 	
MyApp


 
.

 
Application

 
.

 
Feature

 #
.

# $
	CartItems

$ -
.

- .
Commands

. 6
;

6 7
public 
class $
CheckoutCartItemsCommand %
:& '
IRequest( 0
<0 1
ApiResponse1 <
<< =
CheckoutResponseDto= P
>P Q
>Q R
{ 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
public 

required 
CheckoutRequestDto &
CheckoutDto' 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
} 
public 
class +
CheckoutCartItemsCommandHandler ,
:- .
IRequestHandler/ >
<> ?$
CheckoutCartItemsCommand? W
,W X
ApiResponseY d
<d e
CheckoutResponseDtoe x
>x y
>y z
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< +
CheckoutCartItemsCommandHandler <
>< =
_logger> E
;E F
public 
+
CheckoutCartItemsCommandHandler *
(* +
IUnitOfWork+ 6

unitOfWork7 A
,A B
ILoggerC J
<J K+
CheckoutCartItemsCommandHandlerK j
>j k
loggerl r
)r s
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
CheckoutResponseDto" 5
>5 6
>6 7
Handle8 >
(> ?$
CheckoutCartItemsCommand? W
requestX _
,_ `
CancellationTokena r
cancellationToken	s Ñ
)
Ñ Ö
{ 
_logger 
. 
LogInformation 
( 
$str <
,< =
request 
. 
CheckoutDto 
. 
ItemCartRefIds *
.* +
Count+ 0
,0 1
request 
. 
	UserRefId 
) 
; 
if"" 

("" 
request"" 
."" 
CheckoutDto"" 
.""  
ItemCartRefIds""  .
."". /
Count""/ 4
==""5 7
$num""8 9
)""9 :
{## 	
throw$$ 
new$$ 
ValidationException$$ )
($$) *
$str$$* M
)$$M N
;$$N O
}%% 	
var(( 
strategy(( 
=(( 
_unitOfWork(( "
.((" ##
CreateExecutionStrategy((# :
(((: ;
)((; <
;((< =
return)) 
await)) 
strategy)) 
.)) 
ExecuteAsync)) *
())* +
async))+ 0
())1 2
)))2 3
=>))4 6
{** 	
using,, 
var,, 
transaction,, !
=,," #
_unitOfWork,,$ /
.,,/ 0
BeginTransaction,,0 @
(,,@ A
),,A B
;,,B C
try-- 
{.. 
var00 
user00 
=00 
await00  
_unitOfWork00! ,
.00, -
UserManager00- 8
.11 
GetUserByRefIdAsync11 (
(11( )
request11) 0
.110 1
	UserRefId111 :
)11: ;
;11; <
if22 
(22 
user22 
==22 
null22  
)22  !
{33 
throw44 
new44 
ValidationException44 1
(441 2
$"442 4
$str444 F
{44F G
request44G N
.44N O
	UserRefId44O X
}44X Y
$str44Y Z
"44Z [
)44[ \
;44\ ]
}55 
if77 
(77 
!77 
user77 
.77 
EmailConfirmed77 (
)77( )
{88 
throw99 
new99 
PermissionException99 1
(991 2
$"992 4
$str994 ;
{99; <
user99< @
.99@ A
Id99A C
}99C D
$str99D O
"99O P
)99P Q
;99Q R
}:: 
var<< 
	cartItems<< 
=<< 
(<<  !
await<<! &
_unitOfWork<<' 2
.<<2 3
	CartItems<<3 <
.== 
GetAllByRefIdsAsync== (
(==( )
request==) 0
.==0 1
CheckoutDto==1 <
.==< =
ItemCartRefIds=== K
)==K L
)==L M
.>> 
ToList>> 
(>> 
)>> 
;>> 
if?? 
(?? 
	cartItems?? 
.?? 
Count?? #
!=??$ &
request??' .
.??. /
CheckoutDto??/ :
.??: ;
ItemCartRefIds??; I
.??I J
Count??J O
)??O P
{@@ 
varAA 
missingCartItemsAA (
=AA) *
	cartItemsAA+ 4
.AA4 5
SelectAA5 ;
(AA; <
eAA< =
=>AA> @
eAAA B
.AAB C
RefIdAAC H
)AAH I
.AAI J
ExceptAAJ P
(AAP Q
requestAAQ X
.AAX Y
CheckoutDtoAAY d
.AAd e
ItemCartRefIdsAAe s
)AAs t
;AAt u
throwBB 
newBB 
ValidationExceptionBB 1
(BB1 2
$"BB2 4
$strBB4 ;
{BB; <
stringBB< B
.BBB C
JoinBBC G
(BBG H
$strBBH L
,BBL M
missingCartItemsBBN ^
)BB^ _
}BB_ `
$strBB` j
"BBj k
)BBk l
;BBl m
}CC 
varEE 
paymentmethodEE !
=EE" #
awaitEE$ )
_unitOfWorkEE* 5
.EE5 6
PaymentMethodsEE6 D
.FF 
GetByRefIdAsyncFF $
(FF$ %
requestFF% ,
.FF, -
CheckoutDtoFF- 8
.FF8 9
PaymentMethodRefIdFF9 K
)FFK L
;FFL M
ifGG 
(GG 
paymentmethodGG !
==GG" $
nullGG% )
)GG) *
{HH 
throwII 
newII 
ValidationExceptionII 1
(II1 2
$"II2 4
$strII4 G
{IIG H
requestIIH O
.IIO P
CheckoutDtoIIP [
.II[ \
PaymentMethodRefIdII\ n
}IIn o
$strIIo y
"IIy z
)IIz {
;II{ |
}JJ 
awaitLL 
_unitOfWorkLL !
.LL! "
	CartItemsLL" +
.LL+ ,
DeleteEntitiesAsyncLL, ?
(LL? @
	cartItemsLL@ I
)LLI J
;LLJ K
varNN 
invoiceNN 
=NN 
newNN !
InvoiceNN" )
{OO 
RefCodePP 
=PP 
GenerateInvoiceIdPP /
(PP/ 0
)PP0 1
,PP1 2
	CreatedAtQQ 
=QQ 
DateTimeQQ  (
.QQ( )
UtcNowQQ) /
,QQ/ 0
UserIdRR 
=RR 
userRR !
.RR! "
IdRR" $
,RR$ %
PaymentMethodIdSS #
=SS$ %
paymentmethodSS& 3
.SS3 4
IdSS4 6
}TT 
;TT 
awaitUU 
_unitOfWorkUU !
.UU! "
InvoiceManagerUU" 0
.UU0 1
CreateAsyncUU1 <
(UU< =
invoiceUU= D
)UUD E
;UUE F
awaitVV 
_unitOfWorkVV !
.VV! "
SaveChangesAsyncVV" 2
(VV2 3
)VV3 4
;VV4 5
foreachWW 
(WW 
CartItemWW !
itemWW" &
inWW' )
	cartItemsWW* 3
)WW3 4
{XX 
awaitYY 
_unitOfWorkYY %
.YY% &
InvoiceManagerYY& 4
.YY4 5
CreateDetailAsyncYY5 F
(YYF G
newYYG J
InvoiceDetailYYK X
{ZZ 
	InvoiceId[[ !
=[[" #
invoice[[$ +
.[[+ ,
Id[[, .
,[[. /

CourseName\\ "
=\\# $
item\\% )
.\\) *
Schedule\\* 2
.\\2 3
Course\\3 9
.\\9 :
Name\\: >
,\\> ?
CategoryName]] $
=]]% &
item]]' +
.]]+ ,
Schedule]], 4
.]]4 5
Course]]5 ;
.]]; <
Category]]< D
.]]D E
Name]]E I
,]]I J
Price^^ 
=^^ 
item^^  $
.^^$ %
Schedule^^% -
.^^- .
Course^^. 4
.^^4 5
Price^^5 :
,^^: ;
ScheduleDate__ $
=__% &
item__' +
.__+ ,
Schedule__, 4
.__4 5
Date__5 9
}`` 
)`` 
;`` 
awaitaa 
_unitOfWorkaa %
.aa% &
	MyClassesaa& /
.aa/ 0
CreateAsyncaa0 ;
(aa; <
newaa< ?
MyClassaa@ G
{bb 
UserIdcc 
=cc  
usercc! %
.cc% &
Idcc& (
,cc( )

ScheduleIddd "
=dd# $
itemdd% )
.dd) *

ScheduleIddd* 4
}ee 
)ee 
;ee 
}ff 
_unitOfWorkii 
.ii 
CommitTransactionii -
(ii- .
transactionii. 9
)ii9 :
;ii: ;
_loggerkk 
.kk 
LogInformationkk &
(kk& '
$strll B
,llB C
invoicemm 
.mm 
Idmm 
)mm 
;mm  
returnpp 
ApiResponsepp "
<pp" #
CheckoutResponseDtopp# 6
>pp6 7
.pp7 8
SuccessResultpp8 E
(ppE F
newppF I
CheckoutResponseDtoppJ ]
{qq 
	InvoiceIdrr 
=rr 
invoicerr  '
.rr' (
Idrr( *
,rr* +
	CreatedAtss 
=ss 
invoicess  '
.ss' (
	CreatedAtss( 1
}tt 
)tt 
;tt 
}uu 
catchvv 
(vv 
	Exceptionvv 
)vv 
{ww 
_unitOfWorkzz 
.zz 
RollbackTransactionzz /
(zz/ 0
transactionzz0 ;
)zz; <
;zz< =
_logger{{ 
.{{ 
LogError{{  
({{  !
$str{{! K
){{K L
;{{L M
throw|| 
;|| 
}}} 
}~~ 	
)~~	 

;~~
 
} 
private
ÖÖ 
string
ÖÖ 
GenerateInvoiceId
ÖÖ $
(
ÖÖ$ %
)
ÖÖ% &
{
ÜÜ 
return
áá 
$"
áá 
$str
áá 
{
áá 
DateTime
áá 
.
áá 
UtcNow
áá $
:
áá$ %
$str
áá% 1
}
áá1 2
{
áá2 3
Random
áá3 9
.
áá9 :
Shared
áá: @
.
áá@ A
Next
ááA E
(
ááE F
$num
ááF G
,
ááG H
$num
ááI O
)
ááO P
:
ááP Q
$str
ááQ S
}
ááS T
"
ááT U
;
ááU V
}
àà 
}ââ È(
ZD:\BootcampProject\src\04.Application\Feature\CartItems\Commands\AddCourseToCartCommand.cs
	namespace		 	
MyApp		
 
.		 
Application		 
.		 
Feature		 #
.		# $
	CartItems		$ -
.		- .
Commands		. 6
;		6 7
public 
class "
AddCourseToCartCommand #
:$ %
IRequest& .
<. /
ApiResponse/ :
<: ;
CartItemResponseDto; N
>N O
>O P
{ 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
public 

Guid 
ScheduleRefId 
{ 
get  #
;# $
set% (
;( )
}* +
} 
public 
class )
AddCourseToCartCommandHandler *
:+ ,
IRequestHandler- <
<< ="
AddCourseToCartCommand= S
,S T
ApiResponseU `
<` a
CartItemResponseDtoa t
>t u
>u v
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
IMapper 
_mapper $
;$ %
public 
)
AddCourseToCartCommandHandler (
(( )
IUnitOfWork) 4

unitOfWork5 ?
,? @
IMapperA H
mapperI O
)O P
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
CartItemResponseDto" 5
>5 6
>6 7
Handle8 >
(> ?"
AddCourseToCartCommand? U
requestV ]
,] ^
CancellationToken_ p
cancellationToken	q Ç
)
Ç É
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
	UserRefIdM V
)V W
;W X
if 

( 
user 
== 
null 
) 
{ 	
throw 
new 
ValidationException )
() *
$"* ,
$str, >
{> ?
request? F
.F G
	UserRefIdG P
}P Q
$strQ R
"R S
)S T
;T U
}   	
if"" 

("" 
!"" 
user"" 
."" 
EmailConfirmed""  
)""  !
{## 	
throw$$ 
new$$ $
AccountInactiveException$$ .
($$. /
$str$$/ M
)$$M N
;$$N O
}%% 	
if&& 

(&& 
!&& 
user&& 
.&& 
IsActive&& 
)&& 
{'' 	
throw(( 
new(( $
AccountInactiveException(( .
(((. /
$str((/ i
)((i j
;((j k
})) 	
var++ 
schedule++ 
=++ 
await++ 
_unitOfWork++ (
.++( )
	Schedules++) 2
.++2 3
GetByRefIdAsync++3 B
(++B C
request++C J
.++J K
ScheduleRefId++K X
)++X Y
;++Y Z
if,, 

(,, 
schedule,, 
==,, 
null,, 
),, 
{-- 	
throw.. 
new.. 
ValidationException.. )
(..) *
$"..* ,
$str.., :
{..: ;
request..; B
...B C
ScheduleRefId..C P
}..P Q
$str..Q [
"..[ \
)..\ ]
;..] ^
}// 	
var11 
cartItem11 
=11 
new11 
CartItem11 #
{22 	
UserId33 
=33 
user33 
.33 
Id33 
,33 

ScheduleId44 
=44 
schedule44 !
.44! "
Id44" $
}55 	
;55	 

await66 
_unitOfWork66 
.66 
	CartItems66 #
.66# $
CreateAsync66$ /
(66/ 0
cartItem660 8
)668 9
;669 :
await99 
_unitOfWork99 
.99 
SaveChangesAsync99 *
(99* +
)99+ ,
;99, -
var;; 
cartItemDto;; 
=;; 
_mapper;; !
.;;! "
Map;;" %
<;;% &
CartItemResponseDto;;& 9
>;;9 :
(;;: ;
cartItem;;; C
);;C D
;;;D E
return== 
ApiResponse== 
<== 
CartItemResponseDto== .
>==. /
.==/ 0
SuccessResult==0 =
(=== >
cartItemDto==> I
)==I J
;==J K
}>> 
}?? ©0
^D:\BootcampProject\src\04.Application\Feature\Authentications\Commands\ResetPasswordCommand.cs
	namespace

 	
MyApp


 
.

 
Application

 
.

 
Feature

 #
.

# $
Authentications

$ 3
.

3 4
Commands

4 <
;

< =
public 
class  
ResetPasswordCommand !
:" #
IRequest$ ,
<, -
ApiResponse- 8
<8 9
object9 ?
>? @
>@ A
{ 
public 

required #
ResetPasswordRequestDto +
ResetPasswordDto, <
{= >
get? B
;B C
setD G
;G H
}I J
} 
public 
class '
ResetPasswordCommandHandler (
:) *
IRequestHandler+ :
<: ; 
ResetPasswordCommand; O
,O P
ApiResponseQ \
<\ ]
object] c
>c d
>d e
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< '
ResetPasswordCommandHandler 8
>8 9
_logger: A
;A B
private 
readonly 
IEmailService "
_emailService# 0
;0 1
private 
readonly 
IPasswordService %
_passwordService& 6
;6 7
public 
'
ResetPasswordCommandHandler &
(& '
IUnitOfWork 

unitOfWork 
, 
ILogger 
< '
ResetPasswordCommandHandler +
>+ ,
logger- 3
,3 4
IEmailService 
emailService "
," #
IPasswordService 
passwordService (
)( )
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
_emailService 
= 
emailService $
;$ %
_passwordService 
= 
passwordService *
;* +
}   
public!! 

async!! 
Task!! 
<!! 
ApiResponse!! !
<!!! "
object!!" (
>!!( )
>!!) *
Handle!!+ 1
(!!1 2 
ResetPasswordCommand!!2 F
request!!G N
,!!N O
CancellationToken!!P a
cancellationToken!!b s
)!!s t
{"" 
_logger## 
.## 
LogInformation## 
(## 
$str## J
,##J K
request##L S
.##S T
ResetPasswordDto##T d
.##d e
Email##e j
)##j k
;##k l
var%% 
user%% 
=%% 
await%% 
_unitOfWork%% $
.%%$ %
UserManager%%% 0
.%%0 1
GetUserByEmailAsync%%1 D
(%%D E
request%%E L
.%%L M
ResetPasswordDto%%M ]
.%%] ^
Email%%^ c
)%%c d
;%%d e
if&& 

(&& 
user&& 
==&& 
null&& 
)&& 
{'' 	
_logger(( 
.(( 

LogWarning(( 
((( 
$str(( Z
,((Z [
request((\ c
.((c d
ResetPasswordDto((d t
.((t u
Email((u z
)((z {
;(({ |
throw)) 
new)) 
ValidationException)) )
())) *
$str))* K
)))K L
;))L M
}** 	
if-- 

(-- 
user-- 
.-- 
PasswordResetToken-- #
!=--$ &
request--' .
.--. /
ResetPasswordDto--/ ?
.--? @
PasswordResetToken--@ R
||--S U
user.. 
... $
PasswordResetTokenExpiry.. )
<..* +
DateTime.., 4
...4 5
UtcNow..5 ;
)..; <
{// 	
_logger00 
.00 

LogWarning00 
(00 
$str00 E
,00E F
user00G K
.00K L
Email00L Q
)00Q R
;00R S
throw22 
new22 
ValidationException22 )
(22) *
$str22* K
)22K L
;22L M
}33 	
user66 
.66 
PasswordHash66 
=66 
_passwordService66 ,
.66, -
HashPassword66- 9
(669 :
request66: A
.66A B
ResetPasswordDto66B R
.66R S
NewPassword66S ^
)66^ _
;66_ `
user77 
.77 
	UpdatedAt77 
=77 
DateTime77 !
.77! "
UtcNow77" (
;77( )
user:: 
.:: 
PasswordResetToken:: 
=::  !
null::" &
;::& '
user;; 
.;; $
PasswordResetTokenExpiry;; %
=;;& '
DateTime;;( 0
.;;0 1
UtcNow;;1 7
;;;7 8
user<< 
.<< 
	UpdatedAt<< 
=<< 
DateTime<< !
.<<! "
UtcNow<<" (
;<<( )
await>> 
_unitOfWork>> 
.>> 
SaveChangesAsync>> *
(>>* +
)>>+ ,
;>>, -
awaitAA 
_emailServiceAA 
.AA 0
$SendPasswordChangedNotificationAsyncAA @
(AA@ A
userAAA E
.AAE F
EmailAAF K
,AAK L
userAAM Q
.AAQ R
NameAAR V
??AAW Y
$strAAZ `
)AA` a
;AAa b
_loggerCC 
.CC 
LogInformationCC 
(CC 
$strCC F
,CCF G
userCCH L
.CCL M
EmailCCM R
)CCR S
;CCS T
returnEE 
ApiResponseEE 
<EE 
objectEE !
>EE! "
.EE" #
SuccessResultEE# 0
(EE0 1
)EE1 2
;EE2 3
}FF 
}GG ©C
YD:\BootcampProject\src\04.Application\Feature\Authentications\Commands\RegisterCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Authentications$ 3
.3 4
Commands4 <
;< =
public 
class 
RegisterCommand 
: 
IRequest '
<' (
ApiResponse( 3
<3 4
object4 :
>: ;
>; <
{ 
public 

required 
RegisterRequestDto &
RegisterDto' 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
} 
public 
class "
RegisterCommandHandler #
:$ %
IRequestHandler& 5
<5 6
RegisterCommand6 E
,E F
ApiResponseG R
<R S
objectS Y
>Y Z
>Z [
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< "
RegisterCommandHandler 3
>3 4
_logger5 <
;< =
private 
readonly 
ITokenService "
_tokenService# 0
;0 1
private 
readonly 
IEmailService "
_emailService# 0
;0 1
private 
readonly 
IPasswordService %
_passwordService& 6
;6 7
public 
"
RegisterCommandHandler !
(! "
IUnitOfWork 

unitOfWork 
, 
ILogger 
< "
RegisterCommandHandler &
>& '
logger( .
,. /
ITokenService 
tokenService "
," #
IEmailService 
emailService "
," #
IPasswordService 
passwordService (
)( )
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger   
=   
logger   
;   
_tokenService!! 
=!! 
tokenService!! $
;!!$ %
_emailService"" 
="" 
emailService"" $
;""$ %
_passwordService## 
=## 
passwordService## *
;##* +
}$$ 
public%% 

async%% 
Task%% 
<%% 
ApiResponse%% !
<%%! "
object%%" (
>%%( )
>%%) *
Handle%%+ 1
(%%1 2
RegisterCommand%%2 A
request%%B I
,%%I J
CancellationToken%%K \
cancellationToken%%] n
)%%n o
{&& 
var(( 
existingUser(( 
=(( 
await((  
_unitOfWork((! ,
.((, -
UserManager((- 8
.((8 9
GetUserByEmailAsync((9 L
(((L M
request((M T
.((T U
RegisterDto((U `
.((` a
Email((a f
)((f g
;((g h
if)) 

()) 
existingUser)) 
!=)) 
null))  
)))  !
{** 	
throw++ 
new++ 
ValidationException++ )
(++) *
$str++* O
)++O P
;++P Q
},, 	
_logger.. 
... 
LogInformation.. 
(.. 
$str.. M
,..M N
request..O V
...V W
RegisterDto..W b
...b c
Email..c h
)..h i
;..i j
var// 
strategy// 
=// 
_unitOfWork// "
.//" ##
CreateExecutionStrategy//# :
(//: ;
)//; <
;//< =
return00 
await00 
strategy00 
.00 
ExecuteAsync00 *
(00* +
async00+ 0
(001 2
)002 3
=>004 6
{11 	
using33 
var33 
transaction33 !
=33" #
_unitOfWork33$ /
.33/ 0
BeginTransaction330 @
(33@ A
)33A B
;33B C
try44 
{55 
var77 
confirmationToken77 %
=77& '
await77( -
_tokenService77. ;
.77; </
#GenerateEmailConfirmationTokenAsync77< _
(77_ `
)77` a
;77a b
var:: 
user:: 
=:: 
new:: 
User:: #
{;; 
IsActive<< 
=<< 
true<< #
,<<# $
Name== 
=== 
request== "
.==" #
RegisterDto==# .
.==. /
Name==/ 3
,==3 4
Email>> 
=>> 
request>> #
.>># $
RegisterDto>>$ /
.>>/ 0
Email>>0 5
,>>5 6
PasswordHash??  
=??! "
_passwordService??# 3
.??3 4
HashPassword??4 @
(??@ A
request??A H
.??H I
RegisterDto??I T
.??T U
NewPassword??U `
)??` a
,??a b
EmailConfirmed@@ "
=@@# $
false@@% *
,@@* +"
EmailConfirmationTokenAA *
=AA+ ,
confirmationTokenAA- >
,AA> ?(
EmailConfirmationTokenExpiryBB 0
=BB1 2
DateTimeBB3 ;
.BB; <
UtcNowBB< B
.BBB C
AddHoursBBC K
(BBK L
$numBBL N
)BBN O
}CC 
;CC 
awaitEE 
_unitOfWorkEE !
.EE! "
UserManagerEE" -
.EE- .
CreateUserAsyncEE. =
(EE= >
userEE> B
)EEB C
;EEC D
awaitFF 
_unitOfWorkFF !
.FF! "
SaveChangesAsyncFF" 2
(FF2 3
)FF3 4
;FF4 5
varJJ 
userRoleJJ 
=JJ 
awaitJJ $
_unitOfWorkJJ% 0
.JJ0 1
UserManagerJJ1 <
.JJ< =
GetDefaultRoleAsyncJJ= P
(JJP Q
)JJQ R
;JJR S
ifKK 
(KK 
userRoleKK 
!=KK 
nullKK  $
)KK$ %
{LL 
awaitMM 
_unitOfWorkMM %
.MM% &
UserManagerMM& 1
.MM1 2
AddRoleToUserAsyncMM2 D
(MMD E
userMME I
,MMI J
userRoleMMK S
)MMS T
;MMT U
}NN 
awaitTT 
_unitOfWorkTT !
.TT! "
SaveChangesAsyncTT" 2
(TT2 3
)TT3 4
;TT4 5
varWW 
confirmationLinkWW $
=WW% &
$"WW' )
$strWW) T
{WWT U
UriWWU X
.WWX Y
EscapeDataStringWWY i
(WWi j
userWWj n
.WWn o
EmailWWo t
)WWt u
}WWu v
$strWWv }
{WW} ~
Uri	WW~ Å
.
WWÅ Ç
EscapeDataString
WWÇ í
(
WWí ì
confirmationToken
WWì §
)
WW§ •
}
WW• ¶
"
WW¶ ß
;
WWß ®
awaitXX 
_emailServiceXX #
.XX# $&
SendEmailConfirmationAsyncXX$ >
(XX> ?
userXX? C
.XXC D
EmailXXD I
,XXI J
userXXK O
.XXO P
NameXXP T
,XXT U
confirmationLinkXXV f
)XXf g
;XXg h
_loggerZZ 
.ZZ 
LogInformationZZ &
(ZZ& '
$strZZ' X
,ZZX Y
userZZZ ^
.ZZ^ _
EmailZZ_ d
)ZZd e
;ZZe f
_unitOfWork^^ 
.^^ 
CommitTransaction^^ -
(^^- .
transaction^^. 9
)^^9 :
;^^: ;
return`` 
ApiResponse`` "
<``" #
object``# )
>``) *
.``* +
SuccessResult``+ 8
(``8 9
)``9 :
;``: ;
}aa 
catchbb 
(bb 
	Exceptionbb 
)bb 
{cc 
_unitOfWorkff 
.ff 
RollbackTransactionff /
(ff/ 0
transactionff0 ;
)ff; <
;ff< =
_loggergg 
.gg 
LogErrorgg  
(gg  !
$strgg! h
,ggh i
requestggj q
.ggq r
RegisterDtoggr }
.gg} ~
Email	gg~ É
)
ggÉ Ñ
;
ggÑ Ö
throwhh 
;hh 
}ii 
}jj 	
)jj	 

;jj
 
}kk 
}ll û8
]D:\BootcampProject\src\04.Application\Feature\Authentications\Commands\RefreshTokenCommand.cs
	namespace 	
MyApp
 
. 
Application 
. 
Feature #
.# $
Authentications$ 3
.3 4
Commands4 <
;< =
public 
class 
RefreshTokenCommand  
:! "
IRequest# +
<+ ,
ApiResponse, 7
<7 8
AuthResponseDto8 G
>G H
>H I
{ 
public 

required "
RefreshTokenRequestDto *
RefreshTokenDto+ :
{; <
get= @
;@ A
setB E
;E F
}G H
} 
public 
class &
RefreshTokenCommandHandler '
:( )
IRequestHandler* 9
<9 :
RefreshTokenCommand: M
,M N
ApiResponseO Z
<Z [
AuthResponseDto[ j
>j k
>k l
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ITokenService "
_tokenService# 0
;0 1
private 
readonly 
JwtSettings  
_jwtSettings! -
;- .
public 
&
RefreshTokenCommandHandler %
(% &
IUnitOfWork 

unitOfWork 
, 
ITokenService 
tokenService "
," #
JwtSettings 
jwtSettings 
)  
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_tokenService 
= 
tokenService $
;$ %
_jwtSettings 
= 
jwtSettings "
;" #
} 
public 

async 
Task 
< 
ApiResponse !
<! "
AuthResponseDto" 1
>1 2
>2 3
Handle4 :
(: ;
RefreshTokenCommand; N
requestO V
,V W
CancellationTokenX i
cancellationTokenj {
){ |
{   
var"" 
	principal"" 
="" 
_tokenService"" %
.""% &(
GetPrincipalFromExpiredToken""& B
(""B C
request""C J
.""J K
RefreshTokenDto""K Z
.""Z [
AccessToken""[ f
)""f g
;""g h
if## 

(## 
	principal## 
==## 
null## 
)## 
{$$ 	
throw%% 
new%% 
ValidationException%% )
(%%) *
$str%%* @
)%%@ A
;%%A B
}&& 	
var(( 
claim(( 
=(( 
	principal(( 
.(( 
	FindFirst(( '
(((' (

ClaimTypes((( 2
.((2 3
NameIdentifier((3 A
)((A B
;((B C
if)) 

()) 
claim)) 
==)) 
null)) 
||)) 
!)) 
Guid)) "
.))" #
TryParse))# +
())+ ,
claim)), 1
.))1 2
Value))2 7
,))7 8
out))9 <
Guid))= A
	userRefId))B K
)))K L
)))L M
{** 	
throw++ 
new++ 
ValidationException++ )
(++) *
$str++* @
)++@ A
;++A B
},, 	
var// 
user// 
=// 
await// 
_unitOfWork// $
.//$ %
UserManager//% 0
.//0 1
GetUserByRefIdAsync//1 D
(//D E
	userRefId//E N
)//N O
;//O P
if00 

(00 
user00 
==00 
null00 
)00 
{11 	
throw22 
new22 
ValidationException22 )
(22) *
$str22* ;
)22; <
;22< =
}33 	
if44 

(44 
!44 
user44 
.44 
EmailConfirmed44  
)44  !
{55 	
throw66 
new66 $
AccountInactiveException66 .
(66. /
$str66/ M
)66M N
;66N O
}77 	
if88 

(88 
!88 
user88 
.88 
IsActive88 
)88 
{99 	
throw:: 
new:: $
AccountInactiveException:: .
(::. /
$str::/ i
)::i j
;::j k
};; 	
if<< 

(<< 
user<< 
.<< 
RefreshToken<< 
!=<<  
request<<! (
.<<( )
RefreshTokenDto<<) 8
.<<8 9
RefreshToken<<9 E
)<<E F
{== 	
throw>> 
new>> 
ValidationException>> )
(>>) *
$str>>* D
)>>D E
;>>E F
}?? 	
if@@ 

(@@ 
user@@ 
.@@ 
RefreshTokenExpiry@@ #
<=@@$ &
DateTime@@' /
.@@/ 0
UtcNow@@0 6
)@@6 7
{AA 	
throwBB 
newBB 
ValidationExceptionBB )
(BB) *
$strBB* E
)BBE F
;BBF G
}CC 	
varEE 
accessTokenEE 
=EE 
_tokenServiceEE '
.EE' (
GenerateAccessTokenEE( ;
(EE; <
userEE< @
)EE@ A
;EEA B
varFF 
refreshTokenFF 
=FF 
_tokenServiceFF (
.FF( ) 
GenerateRefreshTokenFF) =
(FF= >
)FF> ?
;FF? @
userII 
.II 
RefreshTokenII 
=II 
refreshTokenII (
;II( )
userJJ 
.JJ 
RefreshTokenExpiryJJ 
=JJ  !
DateTimeJJ" *
.JJ* +
UtcNowJJ+ 1
.JJ1 2
AddDaysJJ2 9
(JJ9 :
_jwtSettingsJJ: F
.JJF G&
RefreshTokenExpirationDaysJJG a
)JJa b
;JJb c
awaitKK 
_unitOfWorkKK 
.KK 
SaveChangesAsyncKK *
(KK* +
)KK+ ,
;KK, -
varMM 
authResponseDtoMM 
=MM 
newMM !
AuthResponseDtoMM" 1
{NN 	
MessageOO 
=OO 
$strOO 4
,OO4 5
AccessTokenPP 
=PP 
accessTokenPP %
,PP% &
RefreshTokenQQ 
=QQ 
refreshTokenQQ '
,QQ' (
AccessTokenExpiryRR 
=RR 
DateTimeRR  (
.RR( )
UtcNowRR) /
.RR/ 0

AddMinutesRR0 :
(RR: ;
_jwtSettingsRR; G
.RRG H(
AccessTokenExpirationMinutesRRH d
)RRd e
}SS 	
;SS	 

returnTT 
ApiResponseTT 
<TT 
AuthResponseDtoTT *
>TT* +
.TT+ ,
SuccessResultTT, 9
(TT9 :
authResponseDtoTT: I
)TTI J
;TTJ K
}UU 
}VV £
WD:\BootcampProject\src\04.Application\Feature\Authentications\Commands\LogoutCommand.cs
	namespace

 	
MyApp


 
.

 
Application

 
.

 
Feature

 #
.

# $
Authentications

$ 3
.

3 4
Commands

4 <
;

< =
public 
class 
LogoutCommand 
: 
IRequest %
<% &
ApiResponse& 1
<1 2
object2 8
>8 9
>9 :
{ 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 
class  
LogoutCommandHandler !
:" #
IRequestHandler$ 3
<3 4
LogoutCommand4 A
,A B
ApiResponseC N
<N O
objectO U
>U V
>V W
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
<  
LogoutCommandHandler 1
>1 2
_logger3 :
;: ;
public 
 
LogoutCommandHandler 
(  
IUnitOfWork 

unitOfWork 
, 
ILogger 
<  
LogoutCommandHandler $
>$ %
logger& ,
), -
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2
LogoutCommand2 ?
request@ G
,G H
CancellationTokenI Z
cancellationToken[ l
)l m
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByRefIdAsync1 D
(D E
requestE L
.L M
	UserRefIdM V
)V W
;W X
if 

( 
user 
== 
null 
) 
{ 	
throw   
new   
ValidationException   )
(  ) *
$str  * ;
)  ; <
;  < =
}!! 	
user## 
.## 
RefreshToken## 
=## 
null##  
;##  !
user$$ 
.$$ 
RefreshTokenExpiry$$ 
=$$  !
DateTime$$" *
.$$* +
UtcNow$$+ 1
;$$1 2
await%% 
_unitOfWork%% 
.%% 
SaveChangesAsync%% *
(%%* +
)%%+ ,
;%%, -
_logger'' 
.'' 
LogInformation'' 
('' 
$str'' =
,''= >
user''? C
.''C D
RefId''D I
)''I J
;''J K
return(( 
ApiResponse(( 
<(( 
object(( !
>((! "
.((" #
SuccessResult((# 0
(((0 1
)((1 2
;((2 3
})) 
}** ùM
VD:\BootcampProject\src\04.Application\Feature\Authentications\Commands\LoginCommand.cs
	namespace

 	
MyApp


 
.

 
Application

 
.

 
Feature

 #
.

# $
Authentications

$ 3
.

3 4
Commands

4 <
;

< =
public 
class 
LoginCommand 
: 
IRequest $
<$ %
ApiResponse% 0
<0 1
AuthResponseDto1 @
>@ A
>A B
{ 
public 

required 
LoginRequestDto #
LoginDto$ ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
} 
public 
class 
LoginCommandHandler  
:! "
IRequestHandler# 2
<2 3
LoginCommand3 ?
,? @
ApiResponseA L
<L M
AuthResponseDtoM \
>\ ]
>] ^
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< 
LoginCommandHandler 0
>0 1
_logger2 9
;9 :
private 
readonly 
ITokenService "
_tokenService# 0
;0 1
private 
readonly 
IPasswordService %
_passwordService& 6
;6 7
private 
readonly 
JwtSettings  
_jwtSettings! -
;- .
private 
const 
int 
MAX_FAILED_ATTEMPTS )
=* +
$num, -
;- .
private 
const 
int  
LOCKOUT_TIME_MINUTES *
=+ ,
$num- /
;/ 0
public 

LoginCommandHandler 
( 
IUnitOfWork 

unitOfWork 
, 
ILogger 
< 
LoginCommandHandler #
># $
logger% +
,+ ,
ITokenService 
tokenService "
," #
IPasswordService 
passwordService (
,( )
JwtSettings 
jwtSettings 
)  
{   
_unitOfWork!! 
=!! 

unitOfWork!!  
;!!  !
_logger"" 
="" 
logger"" 
;"" 
_tokenService## 
=## 
tokenService## $
;##$ %
_passwordService$$ 
=$$ 
passwordService$$ *
;$$* +
_jwtSettings%% 
=%% 
jwtSettings%% "
;%%" #
}&& 
public'' 

async'' 
Task'' 
<'' 
ApiResponse'' !
<''! "
AuthResponseDto''" 1
>''1 2
>''2 3
Handle''4 :
('': ;
LoginCommand''; G
request''H O
,''O P
CancellationToken''Q b
cancellationToken''c t
)''t u
{(( 
_logger)) 
.)) 
LogInformation)) 
()) 
$str)) A
,))A B
request))C J
.))J K
LoginDto))K S
.))S T
Email))T Y
)))Y Z
;))Z [
var,, 
user,, 
=,, 
await,, 
_unitOfWork,, $
.,,$ %
UserManager,,% 0
.,,0 1
GetUserByEmailAsync,,1 D
(,,D E
request,,E L
.,,L M
LoginDto,,M U
.,,U V
Email,,V [
),,[ \
;,,\ ]
if-- 

(-- 
user-- 
==-- 
null-- 
)-- 
{.. 	
_logger// 
.// 

LogWarning// 
(// 
$str// \
,//\ ]
request//^ e
.//e f
LoginDto//f n
.//n o
Email//o t
)//t u
;//u v
throw00 
new00 
ValidationException00 )
(00) *
$str00* F
)00F G
;00G H
}11 	
if22 

(22 
!22 
user22 
.22 
EmailConfirmed22  
)22  !
{33 	
throw44 
new44 
ValidationException44 )
(44) *
$str44* F
)44F G
;44G H
}55 	
if77 

(77 
!77 
user77 
.77 
IsActive77 
)77 
{88 	
throw99 
new99 $
AccountInactiveException99 .
(99. /
$str99/ i
)99i j
;99j k
}:: 	
if<< 

(<< 
user<< 
.<< 

LockoutEnd<< 
.<< 
HasValue<< $
&&<<% '
user<<( ,
.<<, -

LockoutEnd<<- 7
.<<7 8
Value<<8 =
><<> ?
DateTime<<@ H
.<<H I
UtcNow<<I O
)<<O P
{== 	
var>> 
remainingTime>> 
=>> 
(>>  !
user>>! %
.>>% &

LockoutEnd>>& 0
.>>0 1
Value>>1 6
->>7 8
DateTime>>9 A
.>>A B
UtcNow>>B H
)>>H I
.>>I J
TotalMinutes>>J V
;>>V W
throw?? 
new?? "
AccountLockedException?? ,
(??, -
$"??- /
$str??/ V
{??V W
Math??W [
.??[ \
Ceiling??\ c
(??c d
remainingTime??d q
)??q r
}??r s
$str??s |
"??| }
)??} ~
;??~ 
}@@ 	
ifCC 

(CC 
!CC 
_passwordServiceCC 
.CC 
VerifyPasswordCC ,
(CC, -
requestCC- 4
.CC4 5
LoginDtoCC5 =
.CC= >
PasswordCC> F
,CCF G
userCCH L
.CCL M
PasswordHashCCM Y
)CCY Z
)CCZ [
{DD 	
userFF 
.FF 
FailedLoginAttemptsFF $
++FF$ &
;FF& '
_loggerGG 
.GG 

LogWarningGG 
(GG 
$strGG Z
,GGZ [
userGG\ `
.GG` a
EmailGGa f
)GGf g
;GGg h
ifII 
(II 
userII 
.II 
FailedLoginAttemptsII (
>=II) +
MAX_FAILED_ATTEMPTSII, ?
)II? @
{JJ 
userKK 
.KK 

LockoutEndKK 
=KK  !
DateTimeKK" *
.KK* +
UtcNowKK+ 1
.KK1 2

AddMinutesKK2 <
(KK< = 
LOCKOUT_TIME_MINUTESKK= Q
)KKQ R
;KKR S
_loggerLL 
.LL 

LogWarningLL "
(LL" #
$strLL# E
,LLE F
userLLG K
.LLK L
EmailLLL Q
)LLQ R
;LLR S
}MM 
awaitOO 
_unitOfWorkOO 
.OO 
SaveChangesAsyncOO .
(OO. /
)OO/ 0
;OO0 1
throwQQ 
newQQ 
ValidationExceptionQQ )
(QQ) *
$strQQ* E
)QQE F
;QQF G
}RR 	
userUU 
.UU 
FailedLoginAttemptsUU  
=UU! "
$numUU# $
;UU$ %
userWW 
.WW 
LastLoginAtWW 
=WW 
DateTimeWW #
.WW# $
UtcNowWW$ *
;WW* +
varZZ 
accessTokenZZ 
=ZZ 
_tokenServiceZZ '
.ZZ' (
GenerateAccessTokenZZ( ;
(ZZ; <
userZZ< @
)ZZ@ A
;ZZA B
var[[ 
refreshToken[[ 
=[[ 
_tokenService[[ (
.[[( ) 
GenerateRefreshToken[[) =
([[= >
)[[> ?
;[[? @
user^^ 
.^^ 
RefreshToken^^ 
=^^ 
refreshToken^^ (
;^^( )
user__ 
.__ 
RefreshTokenExpiry__ 
=__  !
request__" )
.__) *
LoginDto__* 2
.__2 3

RememberMe__3 =
?`` 
DateTime`` 
.`` 
UtcNow`` 
.`` 
AddDays`` %
(``% &
_jwtSettings``& 2
.``2 30
$RefreshTokenRememberMeExpirationDays``3 W
)``W X
:aa 
DateTimeaa 
.aa 
UtcNowaa 
.aa 
AddDaysaa %
(aa% &
_jwtSettingsaa& 2
.aa2 3&
RefreshTokenExpirationDaysaa3 M
)aaM N
;aaN O
awaitbb 
_unitOfWorkbb 
.bb 
SaveChangesAsyncbb *
(bb* +
)bb+ ,
;bb, -
_loggerdd 
.dd 
LogInformationdd 
(dd 
$strdd D
,ddD E
userddF J
.ddJ K
EmailddK P
)ddP Q
;ddQ R
varff 
authResponseDtoff 
=ff 
newff !
AuthResponseDtoff" 1
{gg 	
Messagehh 
=hh 
$strhh (
,hh( )
AccessTokenii 
=ii 
accessTokenii %
,ii% &
RefreshTokenjj 
=jj 
refreshTokenjj '
,jj' (
AccessTokenExpirykk 
=kk 
DateTimekk  (
.kk( )
UtcNowkk) /
.kk/ 0

AddMinuteskk0 :
(kk: ;
_jwtSettingskk; G
.kkG H(
AccessTokenExpirationMinuteskkH d
)kkd e
}ll 	
;ll	 

returnmm 
ApiResponsemm 
<mm 
AuthResponseDtomm *
>mm* +
.mm+ ,
SuccessResultmm, 9
(mm9 :
authResponseDtomm: I
)mmI J
;mmJ K
}nn 
}oo ›,
_D:\BootcampProject\src\04.Application\Feature\Authentications\Commands\ForgotPasswordCommand.cs
	namespace		 	
MyApp		
 
.		 
Application		 
.		 
Feature		 #
.		# $
Authentications		$ 3
.		3 4
Commands		4 <
;		< =
public 
class !
ForgotPasswordCommand "
:# $
IRequest% -
<- .
ApiResponse. 9
<9 :
object: @
>@ A
>A B
{ 
public 

required $
ForgotPasswordRequestDto ,
ForgotPasswordDto- >
{? @
getA D
;D E
setF I
;I J
}K L
} 
public 
class (
ForgotPasswordCommandHandler )
:* +
IRequestHandler, ;
<; <!
ForgotPasswordCommand< Q
,Q R
ApiResponseS ^
<^ _
object_ e
>e f
>f g
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< (
ForgotPasswordCommandHandler 9
>9 :
_logger; B
;B C
private 
readonly 
ITokenService "
_tokenService# 0
;0 1
private 
readonly 
IEmailService "
_emailService# 0
;0 1
public 
(
ForgotPasswordCommandHandler '
(' (
IUnitOfWork 

unitOfWork 
, 
ILogger 
< (
ForgotPasswordCommandHandler ,
>, -
logger. 4
,4 5
ITokenService 
tokenService "
," #
IEmailService 
emailService "
)" #
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
_tokenService 
= 
tokenService $
;$ %
_emailService 
= 
emailService $
;$ %
} 
public   

async   
Task   
<   
ApiResponse   !
<  ! "
object  " (
>  ( )
>  ) *
Handle  + 1
(  1 2!
ForgotPasswordCommand  2 G
request  H O
,  O P
CancellationToken  Q b
cancellationToken  c t
)  t u
{!! 
_logger"" 
."" 
LogInformation"" 
("" 
$str"" M
,""M N
request""O V
.""V W
ForgotPasswordDto""W h
.""h i
Email""i n
)""n o
;""o p
var$$ 
user$$ 
=$$ 
await$$ 
_unitOfWork$$ $
.$$$ %
UserManager$$% 0
.$$0 1
GetUserByEmailAsync$$1 D
($$D E
request$$E L
.$$L M
ForgotPasswordDto$$M ^
.$$^ _
Email$$_ d
)$$d e
;$$e f
if'' 

('' 
user'' 
=='' 
null'' 
)'' 
{(( 	
_logger)) 
.)) 

LogWarning)) 
()) 
$str)) Z
,))Z [
request))\ c
.))c d
ForgotPasswordDto))d u
.))u v
Email))v {
))){ |
;))| }
return++ 
ApiResponse++ 
<++ 
object++ %
>++% &
.++& '
SuccessResult++' 4
(++4 5
)++5 6
;++6 7
},, 	
var// 
token// 
=// 
await// 
_tokenService// '
.//' (+
GeneratePasswordResetTokenAsync//( G
(//G H
)//H I
;//I J
user00 
.00 
PasswordResetToken00 
=00  !
token00" '
;00' (
user11 
.11 $
PasswordResetTokenExpiry11 %
=11& '
DateTime11( 0
.110 1
UtcNow111 7
.117 8
AddHours118 @
(11@ A
$num11A B
)11B C
;11C D
;11E F
await33 
_unitOfWork33 
.33 
SaveChangesAsync33 *
(33* +
)33+ ,
;33, -
var66 
	resetLink66 
=66 
$"66 
$str66 F
{66F G
Uri66G J
.66J K
EscapeDataString66K [
(66[ \
user66\ `
.66` a
Email66a f
)66f g
}66g h
$str66h o
{66o p
Uri66p s
.66s t
EscapeDataString	66t Ñ
(
66Ñ Ö
token
66Ö ä
)
66ä ã
}
66ã å
"
66å ç
;
66ç é
await99 
_emailService99 
.99 "
SendPasswordResetAsync99 2
(992 3
user993 7
.997 8
Email998 =
,99= >
user99? C
.99C D
Name99D H
??99I K
string99L R
.99R S
Empty99S X
,99X Y
	resetLink99Z c
)99c d
;99d e
_logger;; 
.;; 
LogInformation;; 
(;; 
$str;; E
,;;E F
user;;G K
.;;K L
Email;;L Q
);;Q R
;;;R S
return== 
ApiResponse== 
<== 
object== !
>==! "
.==" #
SuccessResult==# 0
(==0 1
)==1 2
;==2 3
}>> 
}?? ê#
]D:\BootcampProject\src\04.Application\Feature\Authentications\Commands\ConfirmEmailCommand.cs
	namespace		 	
MyApp		
 
.		 
Application		 
.		 
Feature		 #
.		# $
Authentications		$ 3
.		3 4
Commands		4 <
;		< =
public 
class 
ConfirmEmailCommand  
:! "
IRequest# +
<+ ,
ApiResponse, 7
<7 8
object8 >
>> ?
>? @
{ 
public 

required "
ConfirmEmailRequestDto *
ConfirmEmailDto+ :
{; <
get= @
;@ A
setB E
;E F
}G H
} 
public 
class &
ConfirmEmailCommandHandler '
:( )
IRequestHandler* 9
<9 :
ConfirmEmailCommand: M
,M N
ApiResponseO Z
<Z [
object[ a
>a b
>b c
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< &
ConfirmEmailCommandHandler 7
>7 8
_logger9 @
;@ A
public 
&
ConfirmEmailCommandHandler %
(% &
IUnitOfWork 

unitOfWork 
, 
ILogger 
< &
ConfirmEmailCommandHandler *
>* +
logger, 2
)2 3
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2
ConfirmEmailCommand2 E
requestF M
,M N
CancellationTokenO `
cancellationTokena r
)r s
{ 
var 
user 
= 
await 
_unitOfWork $
.$ %
UserManager% 0
.0 1
GetUserByEmailAsync1 D
(D E
requestE L
.L M
ConfirmEmailDtoM \
.\ ]
Email] b
)b c
;c d
if 

( 
user 
== 
null 
) 
{ 	
_logger 
. 

LogWarning 
( 
$str d
,d e
requestf m
.m n
ConfirmEmailDton }
.} ~
Email	~ É
)
É Ñ
;
Ñ Ö
throw   
new   
ValidationException   )
(  ) *
$str  * 9
)  9 :
;  : ;
}!! 	
if## 

(## 
user## 
.## "
EmailConfirmationToken## '
!=##( *
request##+ 2
.##2 3
ConfirmEmailDto##3 B
.##B C"
EmailConfirmationToken##C Y
||##Z \
user##] a
.##a b(
EmailConfirmationTokenExpiry##b ~
<	## Ä
DateTime
##Å â
.
##â ä
UtcNow
##ä ê
)
##ê ë
{$$ 	
throw%% 
new%% 
ValidationException%% )
(%%) *
$str%%* Q
)%%Q R
;%%R S
}&& 	
user(( 
.(( 
EmailConfirmed(( 
=(( 
true(( "
;((" #
user)) 
.)) "
EmailConfirmationToken)) #
=))$ %
null))& *
;))* +
user** 
.** (
EmailConfirmationTokenExpiry** )
=*** +
DateTime**, 4
.**4 5
UtcNow**5 ;
;**; <
await,, 
_unitOfWork,, 
.,, 
SaveChangesAsync,, *
(,,* +
),,+ ,
;,,, -
_logger.. 
... 
LogInformation.. 
(.. 
$str.. C
,..C D
request..E L
...L M
ConfirmEmailDto..M \
...\ ]
Email..] b
)..b c
;..c d
return// 
ApiResponse// 
<// 
object// !
>//! "
.//" #
SuccessResult//# 0
(//0 1
)//1 2
;//2 3
}00 
}11 Æ$
_D:\BootcampProject\src\04.Application\Feature\Authentications\Commands\ChangePasswordCommand.cs
	namespace

 	
MyApp


 
.

 
Application

 
.

 
Feature

 #
.

# $
Authentications

$ 3
.

3 4
Commands

4 <
;

< =
public 
class !
ChangePasswordCommand "
:# $
IRequest% -
<- .
ApiResponse. 9
<9 :
object: @
>@ A
>A B
{ 
public 

Guid 
	UserRefId 
{ 
get 
;  
set! $
;$ %
}& '
public 

required $
ChangePasswordRequestDto ,
ChangePasswordDto- >
{? @
getA D
;D E
setF I
;I J
}K L
} 
public 
class (
ChangePasswordCommandHandler )
:* +
IRequestHandler, ;
<; <!
ChangePasswordCommand< Q
,Q R
ApiResponseS ^
<^ _
object_ e
>e f
>f g
{ 
private 
readonly 
IUnitOfWork  
_unitOfWork! ,
;, -
private 
readonly 
ILogger 
< (
ChangePasswordCommandHandler 9
>9 :
_logger; B
;B C
private 
readonly 
IPasswordService %
_passwordService& 6
;6 7
public 
(
ChangePasswordCommandHandler '
(' (
IUnitOfWork 

unitOfWork 
, 
ILogger 
< (
ChangePasswordCommandHandler ,
>, -
logger. 4
,4 5
IPasswordService 
passwordService (
)( )
{ 
_unitOfWork 
= 

unitOfWork  
;  !
_logger 
= 
logger 
; 
_passwordService 
= 
passwordService *
;* +
} 
public 

async 
Task 
< 
ApiResponse !
<! "
object" (
>( )
>) *
Handle+ 1
(1 2!
ChangePasswordCommand2 G
requestH O
,O P
CancellationTokenQ b
cancellationTokenc t
)t u
{   
var!! 
user!! 
=!! 
await!! 
_unitOfWork!! $
.!!$ %
UserManager!!% 0
.!!0 1
GetUserByRefIdAsync!!1 D
(!!D E
request!!E L
.!!L M
	UserRefId!!M V
)!!V W
;!!W X
if"" 

("" 
user"" 
=="" 
null"" 
)"" 
{## 	
throw$$ 
new$$ 
ValidationException$$ )
($$) *
$str$$* ;
)$$; <
;$$< =
}%% 	
if(( 

((( 
!(( 
_passwordService(( 
.(( 
VerifyPassword(( ,
(((, -
request((- 4
.((4 5
ChangePasswordDto((5 F
.((F G
Password((G O
,((O P
user((Q U
.((U V
PasswordHash((V b
)((b c
)((c d
{)) 	
_logger** 
.** 

LogWarning** 
(** 
$str** M
,**M N
user**O S
.**S T
RefId**T Y
)**Y Z
;**Z [
throw++ 
new++ 
ValidationException++ )
(++) *
$str++* =
)++= >
;++> ?
},, 	
user// 
.// 
PasswordHash// 
=// 
_passwordService// ,
.//, -
HashPassword//- 9
(//9 :
request//: A
.//A B
ChangePasswordDto//B S
.//S T
NewPassword//T _
)//_ `
;//` a
user00 
.00 
	UpdatedAt00 
=00 
DateTime00 !
.00! "
UtcNow00" (
;00( )
_logger22 
.22 
LogInformation22 
(22 
$str22 Q
,22Q R
user22S W
.22W X
RefId22X ]
)22] ^
;22^ _
return33 
ApiResponse33 
<33 
object33 !
>33! "
.33" #
SuccessResult33# 0
(330 1
)331 2
;332 3
}44 
}55 ™
BD:\BootcampProject\src\04.Application\Configuration\JwtSettings.cs
	namespace 	
MyApp
 
. 
Application 
. 
Configuration )
{ 
public 

class 
JwtSettings 
{ 
public		 
string		 
	SecretKey		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
=		. /
string		0 6
.		6 7
Empty		7 <
;		< =
public

 
string

 
Issuer

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
=

+ ,
string

- 3
.

3 4
Empty

4 9
;

9 :
public 
string 
Audience 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
int (
AccessTokenExpirationMinutes /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
int &
RefreshTokenExpirationDays -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public 
int 0
$RefreshTokenRememberMeExpirationDays 7
{8 9
get: =
;= >
set? B
;B C
}D E
public 
bool 
ValidateIssuer "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
true3 7
;7 8
public 
bool 
ValidateAudience $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
true5 9
;9 :
public 
bool 
ValidateLifetime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
true5 9
;9 :
public 
bool $
ValidateIssuerSigningKey ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
=; <
true= A
;A B
public 
int 
	ClockSkew 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
$num- .
;. /
} 
} ß
LD:\BootcampProject\src\04.Application\Configuration\AuthorizationPolicies.cs
	namespace 	
MyApp
 
. 
Application 
. 
Configuration )
{ 
public 

static 
class !
AuthorizationPolicies -
{ 
public 
const 
string 
RequireAdminRole ,
=- .
$str/ A
;A B
public 
const 
string 
RequireUserRole +
=, -
$str. ?
;? @
public 
const 
string (
RequireManageUsersPermission 8
=9 :
$str; Y
;Y Z
public 
static 
void 
ConfigurePolicies ,
(, - 
AuthorizationOptions- A
optionsB I
)I J
{ 	
options 
. 
	AddPolicy 
( 
RequireAdminRole .
,. /
policy0 6
=>7 9
policy 
. 
RequireRole "
(" #
$str# *
,* +
$str, 8
)8 9
)9 :
;: ;
options"" 
."" 
	AddPolicy"" 
("" 
RequireUserRole"" -
,""- .
policy""/ 5
=>""6 8
policy## 
.## 
RequireRole## "
(##" #
$str### )
,##) *
$str##+ 2
,##2 3
$str##4 @
)##@ A
)##A B
;##B C
options(( 
.(( 
	AddPolicy(( 
((( (
RequireManageUsersPermission(( :
,((: ;
policy((< B
=>((C E
policy)) 
.)) 
RequireAssertion)) '
())' (
context))( /
=>))0 2
context** 
.** 
User**  
.**  !
IsInRole**! )
(**) *
$str*** 1
)**1 2
||**3 5
context++ 
.++ 
User++  
.++  !
IsInRole++! )
(++) *
$str++* 6
)++6 7
||++8 :
context,, 
.,, 
User,,  
.,,  !
HasClaim,,! )
(,,) *
$str,,* 6
,,,6 7
$str,,8 J
),,J K
),,K L
),,L M
;,,M N
}.. 	
}// 
}00 